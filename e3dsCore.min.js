(()=>{var e;function t(t){clearTimeout(e),e=setTimeout((function(){F()}),500)}var n=void 0;function o(){n.style.width=2+n.value.length+"ch",console.log("onchangehiddenInputText : "+n.style.width)}function i(e){return e>=112&&e<=123||9===e}new Map,setInterval((function(){n&&console.log("1111  hiddenInput.style.display : "+n.style.display)}),1e3);const r={BackSpace:8,Shift:16,Control:17,Alt:18,RightShift:253,RightControl:254,RightAlt:255};function a(e){return e.keyCode===r.Shift&&"ShiftRight"===e.code?r.RightShift:e.keyCode===r.Control&&"ControlRight"===e.code?r.RightControl:e.keyCode===r.Alt&&"AltRight"===e.code?r.RightAlt:e.keyCode}function s(){var e=document.getElementById("streamingVideo");if(e){var t=document.getElementById("AudioBtnImg");t&&(t.src=e.muted?"https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/mute.svg":"https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/unmute.svg",console.log(t.src))}}function l(e){console.log("setVolume val: "+e);var t=document.getElementById("streamingVideo");t.volume=e,console.log("streamingVideo.volume: "+t.volume),hn||(hn=document.getElementById("Audio")),hn.volume=e,console.log("audioElem.volume: "+hn.volume)}function c(){hn?ho():Ze("audioElem not found: "),console.log("11111111111111 streamingVideo.muted ="+streamingVideo?.muted),s()}function d(){if(Sn){var e=document.getElementById("streamingVideo");e&&e.muted&&(Sn=!1,function(e){var t=document.getElementById("streamingVideo");if(console.warn("1 ahsan hack . streamingVideo.paused:  "+t.paused),Ut(t,e),console.warn("2 ahsan hack . streamingVideo.paused:  "+t.paused),console.trace(),t.muted!=e&&(console.warn("3 ahsan hack . most probbaly a vuideo pasue just happeend "),t.play(),console.warn("4 ahsan hack . streamingVideo.paused:  "+t.paused)),console.log("streamingVideo.muted: "+t.muted),hn||(hn=document.getElementById("Audio")),hn&&(Ut(hn,e),console.log("audioElem2.muted: "+hn.muted)),!e&&(hn||(hn=document.createElement("Audio")),hn)){hn.autoplay=!0,null!=wn&&(hn.srcObject=wn);var n=hn.play();void 0!==n&&n.then((()=>{console.log("switchAudioTo() Created new audio element to play seperate audio stream.")})).catch((e=>{console.warn("Autoplay  audio was prevented.deleting audioElem "),delete hn}))}console.log("11111111111111 streamingVideo.muted ="+t?.muted),s()}(!document.getElementById("streamingVideo").muted))}}let u;function g(){u=setInterval((()=>{const e=["W","S","D"],t=e[Math.floor(Math.random()*e.length)],n=new KeyboardEvent("keydown",{key:t,keyCode:t.charCodeAt(0),which:t.charCodeAt(0),code:`Key${t.toUpperCase()}`});document.dispatchEvent(n),setTimeout((()=>{const e=new KeyboardEvent("keypress",{key:t,keyCode:t.charCodeAt(0),charCode:t.charCodeAt(0),which:t.charCodeAt(0),code:`Key${t.toUpperCase()}`});document.dispatchEvent(e)}),2e3),setTimeout((()=>{const e=new KeyboardEvent("keyup",{key:t,keyCode:t.charCodeAt(0),charCode:t.charCodeAt(0),which:t.charCodeAt(0),code:`Key${t.toUpperCase()}`});document.dispatchEvent(e)}),100)}),200)}function m(e){window.top.postMessage(e,"*")}function p(e){if(console.log(" handleUnrealResponse(descriptor) : "+e),"function"==typeof onResponseFromUnreal?onResponseFromUnreal(e):console.log("not found onResponseFromUnreal"),e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onResponseFromUnreal&&e3ds_controller.callbacks.onResponseFromUnreal(e),window.top.postMessage(e,"*"),"getCmdLineArgs"===e){let e={};e.cmdLineArgs=$n,console.log("33333333333333 sendDataToUE4App emitUIInteraction: "+JSON.stringify(e)),b(e)}else{let t;try{t=JSON.parse(e),console.log("5555555555555 handleUnrealResponse JSON.stringify(JSON.parse(descriptor)) : "+JSON.stringify(t))}catch(e){console.log("5555555555555 handleUnrealResponse JSON.parse fails")}!function(e){if(console.log("5555555555555 ahsanHandleResponseFunction(obj) :"+JSON.stringify(e)),null!=e)switch(console.log("5555555555555 ahsanHandleResponseFunction obj.cmd :"+e.cmd),e.cmd){case"misctasks":"function"==window?.pixelStreaming?._webRtcController?.videoPlayer?.resizePlayerStyle?window.pixelStreaming._webRtcController.videoPlayer.resizePlayerStyle():F();break;case"takeFocusedWidgetText_old":f&&(f=!1,o(),e.value);break;case"takeFocusedWidgetText":f&&(f=!1,(n=document.getElementById("hiddenInput")).value=e.value,n.style.display="block",o(),n.focus());break;case"getCmdLineArgs":{let e={};e.cmdLineArgs=$n,console.log("33333333333333 sendDataToUE4App emitUIInteraction: "+JSON.stringify(e)),"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(e):b(e)}break;case"getIpaddress":{let e={Ipaddress:"contactAhsanASAP"};console.log("33333333333333 sendDataToUE4App emitUIInteraction: "+JSON.stringify(e)),"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(e):b(e)}break;case"redirectTo":window.location.href=e.value;break;case"launchKeyBoard":case"lunchKeyBoard":break;case"sendLocalFileToUE4":!function(e){console.log("Browsing");const t=document.createElement("input");t.setAttribute("type","file"),t.style.display="none",document.getElementsByTagName("body")[0].appendChild(t),t.addEventListener("change",(()=>{const n=t.files[0];Li=n,console.log("file",n),function(e,t,n,o,i){var r={type:"getUploadUrl",content_type:e,owner:n,appName:t,file_name:o,pathToSaveFile:i};console.log(JSON.stringify(r)),xn.send(JSON.stringify(r))}(n.type,Zt,Fe,n.name,e)})),t.click()}(e.pathToSaveFile);break;case"ToggleBrowserMouse":ln=!ln,"function"==typeof window?.pixelStreaming?._webRtcController?.videoPlayer?.resizePlayerStyleToFillParentElement?window.pixelStreaming._webRtcController.videoPlayer.resizePlayerStyleToFillParentElement():Tn();break;case"showBrowserMouse":ln=!0,"function"==typeof window?.pixelStreaming?._webRtcController?.videoPlayer?.resizePlayerStyleToFillParentElement?window.pixelStreaming._webRtcController.videoPlayer.resizePlayerStyleToFillParentElement():Tn();break;case"hideBrowserMouse":ln=!1,"function"==typeof window?.pixelStreaming?._webRtcController?.videoPlayer?.resizePlayerStyleToFillParentElement?window.pixelStreaming._webRtcController.videoPlayer.resizePlayerStyleToFillParentElement():Tn();break;case"lunchCallApp":console.log(e.value),window.open("tel:"+e.value,"_self");break;case"lunchMailApp":var t="mailto:"+e.value+"?subject="+e.value+"&body="+e.value;window.open(t,"_blank");break;case"sendDeviceInfo":let a={type:"takeUserDeviceInfo",userDeviceInfo:_n,clientInfo:dn};"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(a):b(a);break;case"sendUserInfoInPlainJson":let s={};s=dn,"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(s):b(s);break;case"sendUserInfo":let c={clientInfo:dn};"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(c):b(c);break;case"generateDownloadableCSV":console.log(JSON.stringify(e.value)),function(e,t){for(var n=function(e){for(var t="",n=0;n<e.length;n++){var o=null===e[n]?"":e[n].toString();e[n]instanceof Date&&(o=e[n].toLocaleString());var i=o.replace(/"/g,'""');i.search(/("|,|\n)/g)>=0&&(i='"'+i+'"'),n>0&&(t+=","),t+=i}return t+"\n"},o="",i=0;i<t.length;i++)o+=n(t[i]);console.log("5555555555555 csvFile content :"+o),console.log("5555555555555 csvFile filename :"+e);var r=new Blob([o],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(r,e);else{var a=document.createElement("a");if(void 0!==a.download){var s=URL.createObjectURL(r);a.setAttribute("href",s),a.setAttribute("download",e),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}}(e.filename,e.csvRows);break;case"captureScreenShot":Wo();break;case"toggleFullscreen":Uo();break;case"enterFullscreen":No();break;case"exitFullscreen":Fo();break;case"ForeceEndTab":try{if(!window.close)throw new Error("window.close is not supported");if(window.close(),!window.closed)throw new Error("Failed to close the window")}catch(e){console.error("Error:",e),Nt("Denied. Scripts may close only the windows that were opened by them.",{color:"red",timeout:5e3})}break;case"ForeceEndSession":console.log("ForeceEndSession diderrorhappend:",kt),kt?console.log(" no error"):window.location="/assets/pages/SessionEnded.htm";break;case"setVolume":console.log(e.value),l(e.value);break;case"askChatGpt":!async function(e){var t={type:"askChatGpt",question:e};console.log(JSON.stringify(t)),null!=window?.pixelStreaming?.webSocketController?.webSocket&&window?.pixelStreaming?.webSocketController?.webSocket?.readyState==WebSocket.OPEN?window.pixelStreaming.webSocketController.webSocket.send(JSON.stringify(t)):xn.send(JSON.stringify(t))}(e.value);break;case"doInAppPurchase":!function(e){var t="https://"+Ne.domain+":"+Ne.httpsPort+"/inAppPurchaseResult/";const n=Gt.ue4AppExe,o=n.match(/([^\\]+)\.exe$/)[1],i=n.replace(/[^\\]+\.exe$/,""),r=n.match(/\\(\d+)\\/)[1];console.log("Exe Name:",o),console.log("Path:",i),console.log("Number 13:",r);var a={owner:Fe,currency:"USD",amount:e.value,reportingUrl:t,href_emulated:Ue,exe:o,v:r,timeOfInitiation:Date.now()},s=JSON.stringify(a);console.log("doenecrytion fsfsf: "+s),x(s)}(e);break;case"sendClipBoardData":!async function(){const e=await navigator.permissions.query({name:"clipboard-read"});if("granted"!==e.state&&"prompt"!==e.state)return console.log("Clipboard Permission denied by user "),void Nt("Clipboard Permission in browser for this domain denied by user",{color:"red",timeout:5e3});if(document.hasFocus()){if(!navigator.clipboard||!navigator.clipboard.readText)return void console.log("clipboard API not supported in browser");window.navigator.clipboard.readText().then((e=>{console.log("sendClipBoardData: "+e);var t={type:"setclipboardDataOnStreamerMachine",textToSetclipboardData:e};t=JSON.stringify(t),console.log("setclipboardDataOnStreamerMachine ws.send(): "+t),xn&&xn.readyState===Mn?xn.send(t):null!=window?.pixelStreaming?.webSocketController?.webSocket&&window.pixelStreaming.webSocketController.webSocket.readyState==WebSocket.OPEN&&window.pixelStreaming.webSocketController.webSocket.send(t);let n={ClipBoardData:e};"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(n):b(n)})).catch((e=>{console.error("Failed to read clipboard data: ",e)}))}else console.log("sendClipBoardData: Page is not in focus")}();break;case"copytoclipboard":!async function(e){const t=await navigator.permissions.query({name:"clipboard-read"});if("granted"!==t.state&&"prompt"!==t.state)return console.log("Clipboard Permission denied by user "),void Nt("Clipboard Permission in browser for this domain denied by user",{color:"red",timeout:5e3});navigator.clipboard.writeText(e).then((()=>{console.log("Text successfully copied to clipboard")})).catch((e=>{console.error("Unable to copy text to clipboard",e),Nt("Unable to copy text to clipboard",{color:"red",timeout:5e3})}))}(e.value);break;case"setBrowserSideMouseCursorTo":""!=e.value&&null!=e.value&&(cn=e.value),"function"==typeof window?.pixelStreaming?._webRtcController?.videoPlayer?.resizePlayerStyleToFillParentElement?window.pixelStreaming._webRtcController.videoPlayer.resizePlayerStyleToFillParentElement():Tn();break;case"getInGameCustomizationData":var i={type:"getInGameCustomizationData",slotId:e.slotId};null!=window?.pixelStreaming?.webSocketController?.webSocket&&window?.pixelStreaming?.webSocketController?.webSocket?.readyState==WebSocket.OPEN?window.pixelStreaming.webSocketController.webSocket.send(JSON.stringify(i)):xn.send(JSON.stringify(i));break;case"launchUrl":case"lunchUrl":console.log(e.value),window.open(e.value,"_blank");break;case"editorModeId":!function(e){document.getElementById("videoContainer").style.display="none",document.getElementById("imageContainer").style.display="none",console.log(e),document.getElementById("GameDataSlots").value=e.slotId,document.getElementById("idsInSlot").value=e.assetId;var t=JSON.stringify({type:"sendAllVideoAssetsUrls",owner:Fe});null==eo&&(xn.send(t),console.log(" ws.send(): "+t)),t=JSON.stringify({type:"sendAll2dAssetsUrls",owner:Fe}),null==to&&(xn.send(t),console.log(" ws.send(): "+t)),"video"===e.assetType?(document.getElementById("assetType").value="video",null!=e.value?(He=e.value,document.getElementById("videoAssets").value=He):(He=void 0,document.getElementById("videoAssets").value=""),document.getElementById("videoContainer").style.display="block"):"image"===e.assetType&&(document.getElementById("assetType").value="image",null!=e.value?(He=e.value,document.getElementById("imageAssets").value=He):(He=void 0,document.getElementById("imageAssets").value=""),document.getElementById("imageContainer").style.display="block"),t=JSON.stringify({type:"sendAllGameCustomizationData",owner:Fe}),null==oo&&(xn.send(t),console.log(" ws.send(): "+t));const n=document.getElementById("editor-sidebar");document.getElementById("sidebarTitle").innerText="Asset Editor",n.style.width="400px"}(e);break;case"freezeResolutionAt":E(e.x,e.y);break;case"getDownloadUrlOfLocalFile":var r=JSON.stringify({type:"forwardToEL",objFromUE4:e});xn?(console.log(" ws.send(): "+JSON.stringify(r)),xn.send(r)):null!=window?.pixelStreaming?.webSocketController?.webSocket&&window?.pixelStreaming?.webSocketController?.webSocket.readyState===WebSocket.OPEN&&window.pixelStreaming.webSocketController.webSocket.send(r);break;case"downloadLocalFileOnUserDevice":r=JSON.stringify({type:"forwardToEL",objFromUE4:e}),xn?(console.log(" ws.send(): "+JSON.stringify(r)),xn.send(r)):null!=window?.pixelStreaming?.webSocketController?.webSocket&&window?.pixelStreaming?.webSocketController?.webSocket.readyState===WebSocket.OPEN&&window.pixelStreaming.webSocketController.webSocket.send(r)}}(t)}}document.addEventListener("keypress",(function(e){d();const t=e.which||e.code;let n=e.key;n||(n=String.fromCharCode(t))})),m({type:"stage3_slotOccupied"});var f=!1;function y(){P(new Uint8Array([w.RequestQualityControl]).buffer)}function v(e,t){var n={"Resolution.Width":e,"Resolution.Height":t};1==Le&&console.log(n),ze=n,I(n),"function"==typeof window?.pixelStreaming?.emitCommand&&window.pixelStreaming.emitCommand(n)}function h(e){null!==e.PrioritiseQuality&&b({Console:"Streamer.PrioritiseQuality "+e.PrioritiseQuality}),null!==e.LowBitrate&&b({Console:"Streamer.LowBitrate "+e.LowBitrate}),null!==e.HighBitrate&&b({Console:"Streamer.HighBitrate "+e.HighBitrate}),null!==e.MinFPS&&b({Console:"Streamer.MinFPS "+e.MinFPS})}const w={IFrameRequest:0,RequestQualityControl:1,MaxFpsRequest:2,AverageBitrateRequest:3,StartStreaming:4,StopStreaming:5,LatencyTest:6,RequestInitialSettings:7,UIInteraction:50,Command:51,KeyDown:60,KeyUp:61,KeyPress:62,MouseEnter:70,MouseLeave:71,MouseDown:72,MouseUp:73,MouseMove:74,MouseWheel:75,TouchStart:80,TouchEnd:81,TouchMove:82,GamepadButtonPressed:90,GamepadButtonReleased:91,GamepadAnalog:92};function S(e,t){let n=JSON.stringify(t);1==Le&&console.log("33333333333333 descriptorAsString: "+n);let o=new DataView(new ArrayBuffer(3+2*n.length)),i=0;o.setUint8(i,e),i++,o.setUint16(i,n.length,!0),i+=2;for(let e=0;e<n.length;e++)o.setUint16(i,n.charCodeAt(e),!0),i+=2;P(o.buffer)}function b(e){S(w.UIInteraction,e)}function I(e){S(w.Command,e)}function E(e,t){It.resolutionType_ue4="Custom",v(e,t)}function k(e){console.log("receiveCommand: "+JSON.stringify(e));try{const n=JSON.parse(e.data);if(null!=n.Type)console.log("Command received, parsed and accepted: %s",e.data),"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(n):b(n);else if("EmulatePlayButtonPressed"==n.cmd)ci();else if("freezeResolutionAt"==n.cmd)E(n.x,n.y);else if("sendToUe4"==n.cmd)"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(n.value):b(n.value);else if("iframe-tester"==n.cmd)Se=!0;else if("ssitest"==n.cmd){var t={requestId:n.requestId,jsonObjecived:JSON.stringify(n)};"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(t):b(t)}else console.log("Command received and parsed, but not accepted: %s",e.data)}catch(t){console.log("error receiveCommand(): Command received, but could not parse: "+JSON.stringify(e.data))}}var C=0,T=void 0;function B(e){}function x(e){C++,console.log("--\x3e collectLocationInfoAttempt: "+C);var t="https://fb-server.eagle3dstreaming.com/api/v1/miscellaneous/encrypt-string?decryptedString="+e,n=new XMLHttpRequest;n.isDOne=!1,n.onreadystatechange=function(){if(console.log("doenecrytion() xmlHttp.responseText: "+n.responseText),429==n.status)return null!=T&&clearTimeout(T),void(T=setTimeout(x,2e3));if(422!=n.status)if(""!=n.responseText&&null!=n.responseText&&200==n.status){if(n.isDOne)return;n.isDOne=!0,clearTimeout(T);try{var e="https://payment.eaglepixelstreaming.com/v1/?key="+JSON.parse(n.responseText).data;console.log("doenecrytion: "+e),window.open(e,"_blank")}catch(e){console.log("Error parsing JSON response: ",e)}}else null!=T&&clearTimeout(T)},n.open("GET",t,!0);try{n.send(null)}catch(e){console.log("Error in doenecrytion try-catch: ",e)}}function P(e){const t=function(e){const t=Object.entries(w);for(const[n,o]of t)if(o===e)return n;return null}(new DataView(e).getUint8(0));var n;n={eventType:t},Qn()?m(n):e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onReceivingDataFromE3DSStreamingUI&&e3ds_controller.callbacks.onReceivingDataFromE3DSStreamingUI(n),(jo.controlScheme!==Go.LockedMouse||ni)&&(Ct||tn||Pn&&(Q(e),Pn.send(e)))}const A={QualityControlOwnership:0,Response:1,Command:2,FreezeFrame:3,UnfreezeFrame:4,VideoEncoderAvgQP:5,LatencyTest:6,InitialSettings:7};var O,M,D,R,L="N/A";function U(e){vo(e),To()}function N(e){F()}function F(e){null!=It.ForceLandScapeMode&&0!=It.ForceLandScapeMode&&(Ln=document.getElementById("rotateOverlay"))&&(window.innerHeight>window.innerWidth?Ln.style.display="block":Ln.style.display="none");var t=document.getElementById("player");t&&(rt&&(J(),function(){let e=It?.qualityPreset;const t=document.getElementById("qualityIcon");if(e){switch(e){case"low":Vo(51),t&&(t.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityLow.svg");break;case"medium":Vo(34),t&&(t.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityMedium.svg");break;case"high":Vo(17),t&&(t.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityHigh.svg");break;case"ultra":Vo(1),t&&(t.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityUltra.svg")}const n=document.querySelectorAll("#qualityList li");for(let e of n)e.classList.contains("selectedQuality")&&e.classList.remove("selectedQuality");document.getElementById(e)?.classList.add("selectedQuality")}}()),t.classList.contains("fixed-size")||(function(e){let t=e.getElementsByTagName("VIDEO"),n=window.innerHeight/window.innerWidth,o=e.clientHeight/e.clientWidth,i=t.videoHeight/t.videoWidth;var r;isNaN(i)?(O=window.innerWidth,M=window.innerHeight,r="top: "+(D=0)+"px; left: "+(R=0)+"px; width: "+O+"px; height: "+M+"px; "+mn):n<o?(O=Math.floor(window.innerHeight/i),M=window.innerHeight,D=0,R=Math.floor(.5*(window.innerWidth-O)),r="top: "+D+"px; left: "+R+"px; width: "+O+"px; height: "+M+"px; cursor: "+styleCursor+"; "+mn):(O=window.innerWidth,M=Math.floor(window.innerWidth*i),r="top: "+(D=Math.floor(.5*(window.innerHeight-M)))+"px; left: "+(R=0)+"px; width: "+O+"px; height: "+M+"px; cursor: "+styleCursor+"; "+mn),function(e,t){if(!(_t.length>0)||rt)if(2==Mo||null==Xt){e.style=t+";background-image: 'none';",document.getElementsByClassName("loader"),document.getElementById("videoPlayOverlay");var n="#FFFFFFFF"}else if(null!=Xt){e.style=t+";background-image: url("+Xt+");";const i=document.querySelectorAll(".loader");for(let e=0;e<i?.length;e++)i[e].style.setProperty("--darkBG",`url("${Xt}")`,"important");n="#FFFFFF00";var o=document.getElementById("loaderStep1");o.style.background=n,(o=document.getElementById("loaderStep3")).style.background=n}}(e,r)}(t),jn=t.getBoundingClientRect(),_i(),V()))}var _=!0;function $(){if(_){var e=document.getElementById("player");e&&"Dynamic"==It.resolutionType_ue4&&v(e.clientWidth,e.clientHeight)}}function J(){if(null==Jn)return $(),void(Jn=(new Date).getTime());(new Date).getTime()-Jn>wt?($(),Jn=(new Date).getTime()):(console.log("Resizing too often - skipping"),clearTimeout(Rn),Rn=setTimeout(J,wt))}var q={receiving:!1,size:0,jpeg:void 0,height:0,width:0,valid:!1};function W(){q.valid&&(Wn.style.display="block")}function V(){if(0!==q.width&&0!==q.height){let e=0,t=0,n=0,o=0;{let i=window.innerWidth/window.innerHeight,r=q.width/q.height;i<r?(e=window.innerWidth,t=Math.floor(window.innerWidth/r),n=Math.floor(.5*(window.innerHeight-t)),o=0):(e=Math.floor(window.innerHeight*r),t=window.innerHeight,n=0,o=Math.floor(.5*(window.innerWidth-e)))}Wn.style.width=e+"px",Wn.style.height=t+"px",Wn.style.left=o+"px",Wn.style.top=n+"px"}}var G={enabled:!1,warnTimeout:void 0,closeTimeout:void 0,active:!1,overlay:void 0,warnTimer:void 0,countdown:0,countdownTimer:void 0,runningCountdown:!1,isAfkUiUp:!1};function j(){if(!G.overlay)return;const e=document.getElementById("afk-second-text");e&&G&&(e.innerText=G.countdown),G.overlay.style.display="block"}function H(){G.runningCountdown=!1,clearInterval(G.countdownTimer),z(),Ct=!1}function z(){"0"!=It.isAfkEnabled?(G.warnTimeout=60*It.afkWarnTimeout,G.closeTimeout=60*It.afkCloseTimeout,G.active=!0,G.enabled=!0,Q()):console.log("AFK is disabled")}function Q(e){e&&1===e.byteLength||G.active&&(clearTimeout(G.warnTimer),G.overlay&&(G.overlay.style.display="none",G.isAfkUiUp=!1),G.warnTimer=setTimeout((function(){console.log("Showing afk overlay"),function(){if(G.enabled)if(!isNaN(G.countdown)&&G.warnTimeout>0&&G.warnTimeout<1e3){if(G.countdown=G.closeTimeout,G.isAfkUiUp=!0,Ct=!0,jo.controlScheme==Go.LockedMouse)try{"function"==typeof document.exitPointerLock&&document.exitPointerLock()}catch(e){}if(clearInterval(G.countdownTimer),G.countdownTimer=setInterval((function(){G.countdown--,0==G.countdown?(pn=!0,xn&&xn.close(4e3,"afk disconnected"),console.log("You have been disconnected for not being active,please refresh the page "),Qn()?Hi("You have been disconnected for not being active,please refresh the page "):Hi("You have been disconnected for not being active,to start a new session please visit: "+location.href)):j()}),1e3),G.overlay)return j(),void(G.runningCountdown=!0);G.active=!1,G.overlay=document.getElementById("afkOverlay"),function(e,t,n){const o=document.getElementById("player");t&&o.appendChild(t),G.overlay&&n&&G.overlay.addEventListener("click",n),o.classList.add("clickableState")}(0,G.overlay,(e=>{H()}))}else console.log("AFK ",G.countdown,G.warnTimeout);else console.log("Not showing overlay because afk disabled.")}()}),1e3*G.warnTimeout))}function X(e){const t=Math.floor(e/1e3%60),n=Math.floor(e/6e4%60),o=Math.floor(e/36e5);let i="";return o>0&&(i+=`${o}h `),(n>0||o>0)&&(i+=`${n}m `),t>0&&(i+=`${t}s`),i.trim()}function K(){kn<0||(clearTimeout(Bn),Bn=setTimeout((function(){if(window.isAppPreparationprocessGoingOn||Fi)return K(),void console.log("startExpireOnCountDown--\x3e window.isAppPreparationprocessGoingOn: "+window.isAppPreparationprocessGoingOn);Jt=!1,qt=!1,ws4queue_shouldTryToReconnect=!1,me&&me.close(4e3,"Timeout_ExpireOnCountDown"),xn&&xn.close(4e3,"Timeout_ExpireOnCountDown"),"function"==typeof onSessionExpired?onSessionExpired():e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onSessionExpired?e3ds_controller.callbacks.onSessionExpired():Qn()?Hi("Session lasted for "+X(kn)+"Session expired, please refresh the page "):Hi("Session lasted for "+X(kn)+". Session expired, to start a new session please visit: "+location.href),Qn()?Hi("Session lasted for "+X(kn)+". Session expired, please refresh the page "):Hi("Session lasted for "+X(kn)+". Session expired, to start a new session please visit: "+location.href)}),kn))}function Y(){if(console.log("111111111111  onFirstHumanInteraction()"),hn)if("success"==hn.ahsanHack)window.removeEventListener("touchend",Y),window.removeEventListener("mouseup",Y);else{var e=document.getElementById("streamingVideo");e&&(e.muted=!1),c()}}function Z(){if(ee){if(fn)document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),fn=!1;else{let e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),screen.orientation.lock("landscape"),fn=!0}clearInterval(Nn),clearTimeout(Fn),ee=!1}}Date.now();var ee=!1;function te(e){return e.length>123&&(e=e.substring(0,123)),e}function ne(e,t,n=!0,o=void 0,i=void 0){if(console.trace(),console.log("ForceReloadPageWithproperInfo diderrorhappend:"+kt),yn&&(yn.domainName,yn.topLevelDomainName),window.location.href,JSON.stringify(dn),JSON.stringify(Gt),JSON.stringify(_n),n&&ot(e),i&&xn&&xn.readyState===Mn){const t=function(){const e=new Date;return`${e.getUTCFullYear()}-${String(e.getUTCMonth()+1).padStart(2,"0")}-${String(e.getUTCDate()).padStart(2,"0")}T${String(e.getUTCHours()).padStart(2,"0")}:${String(e.getUTCMinutes()).padStart(2,"0")}:${String(e.getUTCSeconds()).padStart(2,"0")}.000Z`}();var r={href:window.location.href,type:i,msg:e,date:t,cirrusServer:Ne,appName:Zt,owner:Fe,clientInfo:dn,ue4ExeInfo:Gt,userDeviceInfo:_n};xn.send(JSON.stringify({type:"DoFBEntreyofSystemIssue",obj:r})),setTimeout((function(){Jt=!1,xn&&xn.close(4e3,te("ForceReloadPageWithproperInfo() : "+e))}),1e3)}else Jt=!1,xn&&xn.close(4e3,te("ForceReloadPageWithproperInfo() : "+e));Nt(e,{color:"Red"}),setTimeout((function(){location.reload()}),t)}function oe(e){if(null==pe.appLoadingStageStartedAt&&ge("appLoadingStageStartedAt",fe()),!(_t.length>0)){Gn+=e,console.log("LunchingProgressAmount:"+Gn),e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onReceivingAppStartingProgress&&e3ds_controller.callbacks.onReceivingAppStartingProgress(Gn);var t=document.getElementById("LunchingProgress"),n=document.getElementById("Title_LunchingProgress"),o=document.getElementById("videoPlayOverlay");o&&(o.style.display="none"),window.isAppPreparationprocessGoingOn||n&&(n.style.display="block"),null!==t&&(window.isAppPreparationprocessGoingOn||t&&(t.style.display="block"),t.value=Gn),Gn>=100&&null==pe.appLoadingStageFinishedAt&&ge("appLoadingStageFinishedAt",fe())}}function ie(e,t){if(e.iceServers.length!==t.iceServers.length)return!1;const n=sortIceServers(e.iceServers),o=sortIceServers(t.iceServers);for(let e=0;e<n.length;e++)if(!re(n[e],o[e]))return!1;return!0}function ie(e,t){if(e.iceServers.length!==t.iceServers.length)return!1;for(let n=0;n<e.iceServers.length;n++)if(!re(e.iceServers[n],t.iceServers[n]))return!1;return!0}function re(e,t){if(e.username!==t.username||e.credential!==t.credential)return!1;const n=ae(e.urls),o=ae(t.urls);return JSON.stringify(n)===JSON.stringify(o)}function ae(e){return e&&Array.isArray(e)?e.slice().sort():[]}function se(e){ge("onConfigCalledAt",fe()),_e=e,console.log("onConfig() config.peerConnectionOptions1: \n"+JSON.stringify(e.peerConnectionOptions,null,2));var t=e.peerConnectionOptions;null!=De&&(mergedIceServers=De.iceServers.concat(e.peerConnectionOptions.iceServers),t.iceServers=mergedIceServers,console.log("merged ice_serversObj: "+JSON.stringify(t,null,2)));var n=[{urls:["stun:stun.l.google.com:19302"]}].concat(t.iceServers);fsfsf1111=[{username:"PixelStreamingUser",credential:"AnotherTURNintheroad",urls:["stun:stun.l.google.com:19302","turn:172.7.191.70:443"]}],t.iceServers=n,e.peerConnectionOptions=t,console.log(" final peerConnectionOptions: \n"+JSON.stringify(e.peerConnectionOptions,null,2));let o=document.getElementById("player");Pn||(Pn=new Po({peerConnectionOptions:t}),hn||(hn=document.createElement("Audio"))),console.log(" webRtcPlayerObj.cfg:",Pn.cfg),console.log("webRtcPlayerObj.cfg.iceServers:",Pn.cfg.iceServers),console.log("ice_serversObj:",t),console.log("ice_serversObj.iceServers:",t.iceServers),t.iceServers==Pn.cfg.iceServers&&console.log("same");const i=ie(t,Pn.cfg);console.log("Are the configurations equal?",i),Pn.cfg=t,o.appendChild(Pn.video),function(e){e&&(function(e){e.onmouseenter=function(t){if(!tn){On&&console.log("mouse enter:"+e.id);var n=new DataView(new ArrayBuffer(1));n.setUint8(0,w.MouseEnter),P(n.buffer),e.pressMouseButtons(t)}},e.onmouseleave=function(t){if(!tn){On&&console.log("mouse leave: "+e.id);var n=new DataView(new ArrayBuffer(1));n.setUint8(0,w.MouseLeave),P(n.buffer),e.releaseMouseButtons(t)}}}(e),ai(e))}(yt),0!=Oe&&(Ke=[],Pn?(console.log("Creating offer"),si("Starting connection to server, please wait"),oe(5),Pn.createOffer(),clearTimeout(ii)):(console.log("WebRTC player not setup, cannot create offer"),gi("Unable to setup video")));let r=yt;switch(F(),jo.controlScheme){case Go.HoveringMouse:!function(e){e.onmousemove=function(e){Ho(e.offsetX,e.offsetY,e.movementX,e.movementY),e.preventDefault()},e.onmousedown=function(e){d(),Qo(e.button,e.offsetX,e.offsetY),e.preventDefault()},e.onmouseup=function(e){d(),Xo(e.button,e.offsetX,e.offsetY),e.preventDefault()},e.oncontextmenu=function(e){Xo(e.button,e.offsetX,e.offsetY),e.preventDefault()},"onmousewheel"in e?e.onmousewheel=function(e){Ko(e.wheelDelta,e.offsetX,e.offsetY),e.preventDefault()}:e.addEventListener("DOMMouseScroll",(function(e){Ko(-120*e.detail,e.offsetX,e.offsetY),e.preventDefault()}),!1),e.pressMouseButtons=function(e){ti(e.buttons,e.offsetX,e.offsetY)},e.releaseMouseButtons=function(e){ei(e.buttons,e.offsetX,e.offsetY)}}(r);break;case Go.LockedMouse:oi(r);break;default:console.log(`ERROR: Unknown control scheme ${jo.controlScheme}`),oi(r)}}function le(e){"use strict";if(ft(),"whiteTheme"===It.StreamingUiTheme){var t=document.getElementById("queueNumberText");t&&(t.style.display="none");var o=document.getElementById("InQueue_Text");o&&(o.style.display="none");var s=document.getElementById("videoPlayOverlay");s&&(s.style.display="none")}if(console.log(" connectss cirrusServer:  "+JSON.stringify(e)),console.log("111111111111  load()"),(Wn=document.createElement("img")).id="freezeFrameOverlay",Wn.style.display="none",Wn.style.pointerEvents="none",Wn.style.position="absolute",Wn.style.zIndex="30",document.onkeydown=function(e){if(13==e.keyCode&&(G.isAfkUiUp||G.runningCountdown))return H(),void document.getElementById("afkOverlay").focus();9===e.keyCode&&(e.preventDefault(),e.stopPropagation()),d(),n&&n.value,On&&console.log(`key down ${e.keyCode}, repeat = ${e.repeat}`),229==e.keyCode?he=!1:(he=!0,P(new Uint8Array([w.KeyDown,a(e),e.repeat]).buffer)),e.keyCode===r.BackSpace&&document.onkeypress({charCode:r.BackSpace}),e.ctrlKey&&e.altKey&&"e"===e.key&&(console.log("111111111111111111111111 keyCode: "+e.keyCode),Wo()),jo.suppressBrowserKeys&&i(e.keyCode)&&e.preventDefault()},document.onkeyup=function(e){G.isAfkUiUp||(d(),On&&console.log(`************ key up ${e.keyCode}`),P(new Uint8Array([w.KeyUp,a(e)]).buffer),jo.suppressBrowserKeys&&i(e.keyCode)&&e.preventDefault())},document.onkeypress=function(e){if(G.isAfkUiUp)return;d(),On&&console.log(`key press ${e.charCode}`);let t=new DataView(new ArrayBuffer(3));t.setUint8(0,w.KeyPress),t.setUint16(1,e.charCode,!0),P(t.buffer)},c=p,qn.set("responseHandler01",c),!pn)if(window.WebSocket=window.WebSocket||window.MozWebSocket,window.WebSocket){var l="wss://"+e.domain+"/ws/"+e.httpsPort+"/";console.log(" connectss url:  "+l),ge("ss_WebSocketConnectionCalledAt",fe()),(xn=new WebSocket(l)).onopen=function(t){if(ge("ss_WebSocketConnectionEstablishedAt",fe()),console.log("11111111111111111111 ws.onopen  "),"VrApp"==It.platform){var n={type:"vrApp",serverPublicIp:e.elInfo.serverPublicIp,port:3389};console.log("6666666666666 JSON.stringify(josnObj): "+JSON.stringify(n));var o=function(e){var t=JSON.stringify(e);console.log("encryptJosn JSON.stringify(josnObj): "+t);var n=btoa(t);return console.log("encryptJosn btoa: "+n),console.log("encryptJosn atob: "+atob(n)),n}(n),i="e3dsrdp://"+o;console.log("opening Vr connector:"+i),e3ds_alert("opening Vr connector:"+i,{color:"blue"}),window.open(i,"_blank")}JSON.stringify({type:"xirsysResponse",responseText:JSON.stringify({})})},xn.onmessage=function(e){var t;console.log(`<- SS: ${e.data}`);try{t=JSON.parse(e.data),console.log("SS--\x3e ws (msg.type: "+t.type),de(t)}catch(t){console.error("Failed to parse JSON data:",t),console.error("event.data:"),console.error(e.data)}},xn.reconnectAttempt=0,xn.onerror=function(e){console.error(`WS error: ${JSON.stringify(e)}`),console.error("redirecting to: "+window.location.href),u(e,"Connection lost. Redirecting you in 3 sec to re-establish connection. ")},xn.onclose=function(e){console.error(`WS closed: ${JSON.stringify(e.code)} - ${e.reason}`),console.error("WS closed:"+JSON.stringify(e)),u(e,"Connection lost. Redirecting you in 3 sec to re-establish connection. ")},xn.onclose111=function(e){console.warn(`WS closed: ${JSON.stringify(e.code)} - ${e.reason}`+window.location.href),xn=void 0;let t=document.getElementById("player");Pn&&(t.removeChild(Pn.video),Pn.close(),Pn=void 0),gi(`Disconnected: ${e.reason}`),setTimeout(start,4e3)}}else alert("Your browser doesn't support WebSocket");var c;function u(e,t){if(Jt){xn&&(xn.reconnectAttempt++,console.error("ssReconnec() reconnectAttempt:"+xn.reconnectAttempt)),xn=void 0;var n="";if(null!=e.code){var o=function(e){if(e>=0&&e<=999)return"(Unused)";if(e>=1016){if(e<=1999)return"(For WebSocket standard)";if(e<=2999)return"(For WebSocket extensions)";if(e<=3999)return"(For libraries and frameworks)";if(e<=4999)return"(For applications)"}return void 0!==jt[e]?jt[e]:"(Unknown)"}(e.code);n=t+JSON.stringify(e.code)+" : "+e.reason+" : "+o}else n=t+" Could not connect to Web-socket.";var i=!1;1e3!=e.code&&1001!=e.code&&1006!=e.code||(i=!0),console.error(`WS closed: ${JSON.stringify(e.code)} - ${e.reason}`),ne(n,5e3,i,-972634118)}}}function ce(e){const t=e.split("/");return t[t.length-1]}function de(e){if("config"===e.type)null==Gt&&null!=e.ue4ExeInfo&&(Gt=e.ue4ExeInfo,vt=new Date,ge("time_ue4ExeInfoArrivedAt",fe())),se(e);else if("playerCount"===e.type)B=e.count-1,(x=document.getElementById("kick-other-players-button"))&&(x.value=`Kick (${B})`);else if("muteUser"===e.type){const t=document.getElementById("button-microphone");t&&t.src.includes("voipmicOn")&&e.id==window.playerId&&t.click()}else if("offer"===e.type)ge("playerReceivedOfferOfAppAt",fe()),console.log(" <- SS arvind offer --\x3e  msg.sdp: %o",e.sdp),U(e);else if("answer"===e.type)ge("playerReceivedAnswerOfAppAt",fe()),console.log(" answer : "+JSON.stringify(e)),Pn.receiveAnswer(e),To(),oe(5);else if("gettings"===e.type)console.log("message type:gettings:  "+JSON.stringify(e)),console.log("message type:gettings msg.data:  "+JSON.stringify(e.data));else if("addInExistingGuestList"===e.type)(n=document.getElementById("Guest-filter"))&&e.guestList.forEach((function(e){var t=document.createElement("option");t.text=t.value=e,n.add(t,n.length-1)}));else if("GuestJoined"===e.type){if(0==sn){const t=document.getElementById("meetingGuestList");if(t){let n=document.createElement("li");n.id=`guestRow-${e.guestPlayerId}`,n.className="list-group-item",n.innerHTML=`<span>${e.guestPlayerId}</span> \n\t\t\t\t<div>\n\t\t\t\t<button id="toggleControlForGuest-${e.guestPlayerId}"> <img src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/UIimages/controllOff.svg"/> </button> <button id="kickGuest-${e.guestPlayerId}"> <img src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/UIimages/kick.svg"/> </button> \n\t\t\t\t</div>`,t.appendChild(n);const o=document.getElementById(`toggleControlForGuest-${e.guestPlayerId}`);o&&(o.onclick=function(){const t=o.getElementsByTagName("img")[0];let n="";t.src.includes("controllOff")?(n="on",t.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/UIimages/controllOn.svg"):(n="off",t.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/UIimages/controllOff.svg"),window.dispatchToggleControl(n,e.guestPlayerId)});const i=document.getElementById(`kickGuest-${e.guestPlayerId}`);i&&(i.onclick=function(){xn.send(JSON.stringify({type:"KickSelctedGuest",playerIDToKick:e.guestPlayerId}))})}}if(n=document.getElementById("Guest-filter")){var t=document.createElement("option");t.text=t.value=e.guestPlayerId,n.add(t,n.length-1)}}else if("GuestLeft"===e.type){const t=document.getElementById(`guestRow-${e.guestPlayerId}`);var n;if(t&&t.remove(),n=document.getElementById("Guest-filter"))for(var o=0;o<n.length;o++)n.options[o].value==e.guestPlayerId&&n.remove(o)}else if("updateGuestName"==e.type){const t=document.getElementById(`guestRow-${e.guestPlayerId}`);t&&(t.getElementsByTagName("span")[0].innerText=e.guestName)}else if("takeChatGptAnswer"===e.type)b({ChatGptQuestion:e.ChatGptQuestion,ChatGptAnswer:e.ChatGptAnswer});else if("takeGameCustomizationData"===e.type)b(e);else if("takeUploadUrl"===e.type)!function(e,t,n,o){console.log("putFile() selectedFileName"+n);var i=Li;let r=new XMLHttpRequest;r.open("PUT",e,!0),r.setRequestHeader("Content-type",t),r.onload=function(){let t=r.responseText;if(4==r.readyState&&"200"==r.status){console.log("Successfully uploaded",t),console.log("file:",i),console.log("DIRECT URL",e.split("?")[0]);var a=e.split("?")[0],s=o+n,l=JSON.stringify({type:"askElToDownloadFileTO",url:a,downloadPath:s});xn&&(console.log(" ws.send(): "+JSON.stringify(l)),xn.send(l))}else console.error(t);Li=void 0},r.onprogress=function(e){console.log("Progress",e)},r.send(i)}(e.uploadURL,e.input.content_type,e.input.file_name,e.input.pathToSaveFile);else if("sendplayerType"===e.type){null!=e.playerId&&(we=e.playerId,window.playerId=e.playerId,Yt&&0==sn&&document.getElementById("popupForVoipUsername"))&&(document.getElementById("joinBtn").innerText="Join Meeting",document.getElementById("popupForVoipUsername").style.display="flex",document.getElementById("voipUserName").select(),document.getElementById("popupForVoipUsernameForm").onsubmit=function(e){e.preventDefault();const t=document.getElementById("voipUserName").value;xn&&xn.send(JSON.stringify({type:"updateGuestName",guestPlayerId:we,guestName:t})),document.getElementById("popupForVoipUsername").style.display="none"});var i=void 0;ye&&(i=ye.get("appVersion")),null==i&&(i=-1),null==dn&&(dn="undefined"),It.clientSideInfo={},It.clientSideInfo.url=window.location.href,It.clientSideInfo.userAgent=navigator.userAgent,It.clientSideInfo.clientInfo=dn,It.clientSideInfo.userDeviceInfo=_n;let t={type:"takePlayerType",isSpectator:tn,hostMeetingId:Kt,appDownloadInfo:lt,GuestMeetingId:Yt,version:i,uInfo:$e,userDeviceInfo:_n,configName:en,urlVersion:Ot,appName:rn("appName"),navigationType:window.location.href,url:window.location.href,href_emulated:Ue,userAgent:navigator.userAgent,clientInfo:dn,serverOwner:Fe,forceMeetingMode:nn,accessedTopLevelDomainName:Lt,url_searchParams:String(ye),configuration:It};if(null!=Je){const e=Je?.email;T=e,["@eagle3dstreaming.com","@eaglepixelstreaming.com"].some((e=>T.endsWith(e)))&&(t.e3ds_employee=!0)}var r=JSON.stringify(t);console.log(" ws.send(): "+JSON.stringify(r)),xn.send(r)}else if("handleshuttingDownVM"===e.type)kt=!0,ne(a="shutting down this VM .So redirecting you in 3 sec to re-establish connection",5e3);else if("handleElDisconnected"===e.type){kt=!0;var a="EL crashed: "+e.errormsg;if(Pn&&Pn.pcClient){const e=Pn.pcClient.iceConnectionState;if("connected"===e){var s="handleElDisconnected() EL crashed but Video stream is streaming. so returning";return console.log(s),void Ze(s)}"failed"!==e&&"disconnected"!==e&&"closed"!==e||(a=a+" ice connectionState: "+e)}a+=" .So redirecting you in 3 sec to re-establish connection",console.log(a),ne(a,5e3,!0,-972942690,"handleElDisconnected")}else if("handleStreamerDisconnected"===e.type){let e=function(e,t){const n=(new Date(e)-new Date(t))/1e3;return Math.ceil(n)}(fe(),pe.datachannelconnectedAt);if(1==It.injectStreamFromEditor){let t=`Remote Editor stream lasted for ${e} seconds`;return console.log(`postToTelegram: ${t}`),ot(t),void ne("Streamer Disconnected",3e3,!1)}kt=!0,ne(a=`Stream duration: ${e||"undefined"} seconds. Streamer Disconnected.So redirecting you in 3 sec to re-establish connection`,5e3,!0,e?-0xe95c7c2279:-828953428,"StreamerDisconnected")}else if("ping"===e.type)xn.send(JSON.stringify({type:"pong"}));else if("reload"===e.type)location.reload();else if("ConfigUpdateOnClientSide"===e.type)window.location.href=window.location.href;else if("redirectTo"===e.type)console.log("222222 <- SS: msg.data.url: "+e.url),window.location.replace(e.url);else if("jsonMessageForUE4"===e.type)console.log("jsonMessageForUE4: "+JSON.stringify(e.jsonObj)),b(e.jsonObj);else if("ShowThisHtmlPage"===e.type)pn=!0,xn&&xn.close(),self.location=e.htmlPage;else if("setGuestId"===e.type)document.getElementById("GuestTitle")&&(document.getElementById("GuestTitle").innerHTML=e.guestId);else if("sendtoUnrealinAppPurchaseResult"===e.type)console.log("222222 <- SS: sendtoUnrealinAppPurchaseResult msg.data.info: "+e.data.purchasResult),b({purchasResult:e.data.purchasResult});else if("ShowE3ds_alert"===e.type){console.log("222222 <- SS: ShowE3ds_alert msg.data.info: "+e.data.info);var l={};null!=e.data.color&&(l.color=e.data.color),null!=e.data.timeout&&(l.timeout=e.data.timeout),Nt(e.data.info,l)}else if("includeInTimeRecords"===e.type){var c=e.timeRecords_ssSide;for(const e in c)if(pe.hasOwnProperty(e)){var d=!0;if(Object.keys(pe).forEach((t=>{t.startsWith(e)&&(console.log(t),pe[t]===c[e])&&(d=!1)})),d){let t=1,n=e+t;for(;pe.hasOwnProperty(n);)t++,n=e+t;pe[n]=c[e]}}else pe[e]=c[e];console.log(pe)}else if("UE5Editorlunched"===e.type){console.log(JSON.stringify(e));var u="http://"+e.url+":"+e.port;console.log("UE5Editorlunched url "+u),location.assign(u)}else if("UE4LogFromEL"===e.type)console.info(e.data.logLine);else if("showPageWIthMsg"===e.type)Hi(e.data.info);else if("ShowInfoToInjectStreamFromEditor"===e.type){var g="ws://"+Ne.domain+":"+Ne.ue4StreamerToSS;console.log("injectStreamFromEditorInfo: "+g),obj=document.getElementById("loaderStep1"),obj&&(obj.style.display="none"),document.getElementById("Info4injectStreamFromEditor").value=g;var p=document.getElementById("popupForinjectStreamFromEditorInfo");p&&(p.style.display="flex")}else if("ShowInfo"===e.type){if(console.log("222222 <- SS: msg.data.info: "+e.data.info),l={},null!=e.data.color&&(l.color=e.data.color),null!=e.data.timeout&&(l.timeout=e.data.timeout),e.data.info.startsWith("showPageWIthMsg:"))return void Hi(e.data.info.replace("showPageWIthMsg:",""));if(e.data.info.startsWith("EL Error:")){let t=e.data.info.replace("EL Error:","");console.error(JSON.stringify(e.data)),console.error(t),t.startsWith("Upload system having critical Isssue.")&&ot(t),t.startsWith("No exe found in any subdirectories")&&Hi("Invalid App. No exe found in any subdirectories "),Nt(t,l)}try{var f=JSON.parse(e.data.info);console.log("33333 <- SS: msg.data.info: "+JSON.stringify(f));var y=document.getElementById("Title_AcquiringProgresss"),v=document.getElementById("AcquiringProgress"),h=document.getElementById("Title_PreparingProgress"),w=document.getElementById("PreparingProgress"),S=document.getElementById("LunchingProgress"),I=document.getElementById("Title_LunchingProgress");if("AppAcquiringData"==f.datatype){null==pe.AppAcquiringStartedAt&&(ue=!0,ge("AppAcquiringStartedAt",fe()),ot(`App acquiring started at ${fe()}\n`)),console.log("5555 <- AppAcquiringData AcquiringProgress: "+f.data.percent);var E=document.getElementById("videoPlayOverlay");if(E&&(E.style.display="none"),e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onReceivingAppAcquiringProgress&&e3ds_controller.callbacks.onReceivingAppAcquiringProgress(f.data.percent),y.style.display="block",window.isAppPreparationprocessGoingOn=!0,null!==v){v.value=100*f.data.percent;var k={type:"stage3_1_AppAcquiringProgress",percent:f.data.percent};m(k),S.style.display="none",I.style.display="none",v.style.display="block",v.value>=100&&(null==pe.AppAcquiringFinishedAt&&ge("AppAcquiringFinishedAt",fe()),h.style.display="block",null!==w&&(w.value=0,w.style.display="block"))}}else"AppPreparationData"==f.datatype&&(null==pe.AppPreparationStartedAt&&ge("AppPreparationStartedAt",fe()),window.isAppPreparationprocessGoingOn=!0,e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onReceivingAppPreparationProgress&&e3ds_controller.callbacks.onReceivingAppPreparationProgress(f.data.percent),k={type:"stage3_2_AppPreparationProgress",percent:f.data.percent},m(k),f.data.percent>=100&&(null==pe.AppPreparationFinishedAt&&ge("AppPreparationFinishedAt",fe()),window.isAppPreparationprocessGoingOn=!1,ft(),K(),z()),null!==w&&(w.value=f.data.percent,w.style.display="block",h.style.display="block",S.style.display="none",I.style.display="none",w.value>=100&&(I.style.display="block",null!==S&&(S.value=0,S.style.display="block"))))}catch(e){}}else if("TakeuserDeviceInfo"===e.type)"Oculus Browser"==(_n=e.userDeviceInfo).client.name&&(_n.device.type="hmd"),console.log(`userDeviceInfo : ${JSON.stringify(_n)}`),console.log(`elInfo : ${JSON.stringify(e.elInfo)}`),console.log(" 1111111111111 useExtendedTyping > "+an);else if("OnLocalFileUploadingFinished"===e.type){var C=e.data.objFromUE4;if(null!=C)switch(C.cmd){case"downloadLocalFileOnUserDevice":window.open(e.data.Location,"_blank");break;case"getDownloadUrlOfLocalFile":b({type:"takeDownloadUrlOfLocalFile",downloadURL:e.data.Location,localFile:C.fileToDownload})}}else if("OnFinishingOfClientFileDownladOnEL"===e.type){let t={cmd:"onUploadedFileAvailable",filename:e.data.filename};b(t),console.log(t)}else"ue4Version"===e.type?(Vt=e.currentAppsUE4Version,Se&&m({type:"ueVersion",value:Vt?.versionString})):"PsPluginPixelStreamingDireExist"===e.type?(console.log("****PsPluginPixelStreamingDireExist : "+e.PsPluginPixelStreamingDireExist),Ve=e.PsPluginPixelStreamingDireExist):"PsPluginEntryInManifestFile"===e.type?(console.log("****PsPluginEntryInManifestFile : "+e.PsPluginEntryInManifestFile),Ge=e.PsPluginEntryInManifestFile):"ue4ExeInfoMsg"===e.type?(Gt=e.ue4ExeInfo,Vt=Gt.versionString,vt=new Date,console.log("ue4AppExe path:"+Gt.ue4AppExe),oe(2)):"iceCandidate"===e.type?(Pn&&Pn.handleCandidateFromServer(e.candidate),oe(5)):"DisableControlFromOthers"===e.type?tn=!0:"AllAssetsUrls"===e.type||"AllVideoAssetsUrls"===e.type?function(e){e.apps.data.blobs.length<=0||e.apps.data.blobs[0].files.length<=0?no=[]:(e.apps.data.blobs[0].files.forEach((e=>{no.includes(e.url)||no.push(e.url)})),console.log(no))}(e):"All2dAssetsUrls"===e.type?function(e){if(e.apps.data.blobs.length<=0||e.apps.data.blobs[0].files.length<=0)to=[];else{var t=to=e.apps.data.blobs[0].files;if(!(t<=0)){var n=document.getElementById("imageAssets");if(n){if(void 0===He){var o=document.createElement("option");o.text=o.value="",He===o.value&&(o.selected=!0),n.appendChild(o)}for(var i=0;i<t.length;i++){var r=t[i].url,a=document.createElement("option");a.text=ce(r),a.value=r,He===a.value&&(a.selected=!0),n.appendChild(a)}}}}}(e):"GiveControlToThisGuest"===e.type?tn=!1:console.warn(`invalid SS message type: ${e.type}`);var T,B,x}Number.prototype.clamp=function(e,t){return Math.min(Math.max(this,e),t)},document.getElementById("Title_AcquiringProgresss"),document.getElementById("AcquiringProgress"),document.getElementById("Title_PreparingProgress"),document.getElementById("PreparingProgress"),document.getElementById("LunchingProgress"),document.getElementById("Title_LunchingProgress"),"undefined"==typeof e3ds_controller&&(e3ds_controller={}),void 0===e3ds_controller.callbacks&&(e3ds_controller.callbacks={});var ue=!1;if(void 0===ge)var ge=function(e,t){pe&&(pe[e]=t,performance.mark(e)),null!=me&&me?.readyState===WebSocket.OPEN&&me.send(JSON.stringify({type:"timeRecords",timeRecords:pe}))};if(void 0===me)var me=void 0;if(void 0===pe)var pe={};if(void 0===fe)var fe=function(){return new Date(Date.now()).toISOString()};const ye=new URLSearchParams(window.location.search),ve=performance.getEntriesByType("navigation")[0];ve&&"number"==typeof ve.fetchStart&&ve.fetchStart>=0?performance.mark("request-initiated",{startTime:ve.fetchStart}):ve&&"number"==typeof ve.startTime&&ve.startTime>=0&&performance.mark("request-initiated",{startTime:ve.startTime});let he=!0;var we=void 0,Se=!1,be={},Ie=void 0,Ee=[];let ke=!1,Ce=0;var Te=void 0,Be=console,xe=console.log,Pe=console.warn;zt(0);var Ae=void 0,Oe=!0,Me=[];window.onSuccessfulGoogleLogin=function(e){console.log("user: \n "+JSON.stringify(e,null,2)),b({type:"onSuccessfulGoogleLogin",data:e})};var De=void 0;let Re="https://global.xirsys.net/_turn/prod-global-2-22-2023";Re="https://global.xirsys.net/_turn/prod-7-8-2024",function e(){let t=new XMLHttpRequest;t.onreadystatechange=function(e){4==t.readyState&&(0==t.status?JSON.stringify({}):200==t.status&&""!=t.responseText&&(JSON.parse(t.responseText).s,function(e){try{console.log("buildxirsysIceServersConfig() responseText:  "+e);var t=JSON.parse(e);if(console.log("buildxirsysIceServersConfig() obj:  "+JSON.stringify(t)),t.v.iceServers){var n={iceServers:[{username:t.v.iceServers.username,credential:t.v.iceServers.credential,urls:t.v.iceServers.urls}]};De=n}console.log("buildxirsysIceServersConfig() xirysGeoLocationBasedTurnSever:  "+JSON.stringify(De))}catch(e){console.error(`buildxirsysIceServersConfig(): Cannot parse   responseText: ${e}`)}}(t.responseText)))},t.onerror=function(){e3ds_alert("xirsys errror.trying again ",{color:"Blue"}),e()};try{t.open("PUT","https://global.xirsys.net/_turn/prod-7-8-2024",!0),t.setRequestHeader("Authorization","Basic "+btoa("eagle3dstreaming:c280e804-72d9-11eb-8e31-0242ac150006")),t.setRequestHeader("Content-Type","application/json"),t.send(JSON.stringify({format:"urls"}))}catch(e){e3ds_alert("xirsys errror: "+e,{color:"Blue"}),e3ds_alert("xirsys errror: "+e.message,{color:"Blue"})}}();var Le=0;let Ue;var Ne=void 0;let Fe,_e,$e,Je,qe=!1,We=!1,Ve=!1,Ge=!1,je=!1;var He=void 0,ze=void 0,Qe=void 0;let Xe,Ke,Ye=[];function Ze(e,t){e.includes("chrome-extension")||1==Le&&console.log("postToTelegram(): "+e)}function et(){if(!Ne||!Ne.elInfo)return;const e=function(e,t,n,o){const i=tt(n-e),r=tt(o-t),a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(tt(e))*Math.cos(tt(n))*Math.sin(r/2)*Math.sin(r/2);return 3958.8*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}(Ne.elInfo.clientInfo.latitude,Ne.elInfo.clientInfo.longitude,dn.fullInfo.latitude,dn.fullInfo.longitude);return console.log("Distance between the points:",e.toFixed(2),"miles"),Ne.elInfo.clientInfo.city+", "+Ne.elInfo.clientInfo.region+", "+Ne.elInfo.clientInfo.country_name+",  ->  "+dn.fullInfo.city+", "+dn.fullInfo.region+", "+dn.country_name+" -> distance: "+e+" miles"}function tt(e){return e*(Math.PI/180)}function nt(e){const t=Object.keys(e).sort(((t,n)=>e[t]-e[n])),n={};var o={};console.dir(t),t.forEach((function(t){if(e.hasOwnProperty(t)){const i=new Date(e[t]),r=`${String(i.getUTCHours()).padStart(2,"0")}:${String(i.getUTCMinutes()).padStart(2,"0")}:${String(i.getUTCSeconds()).padStart(2,"0")}:${String(i.getUTCMilliseconds()).padStart(3,"0")}`;n[t]=e[t],o[t]=r}}));const i=Object.entries(o).sort((([,e],[,t])=>{const n=e=>e.split(":").reduce(((e,t,n)=>{const o=[36e5,6e4,1e3,1][n];return e+parseInt(t,10)*o}),0);return n(e)-n(t)})),r=Object.fromEntries(i);return console.log(r),{humanReadableData:n,timeOnlyData:o=r}}function ot(e,t){if(!e.includes("chrome-extension")){var n=Ue;if(Qn()&&(n=n+" : ----\x3eisInIframe: "+Qn()),Ne&&Ne.elInfo&&(n=n+" : ----\x3e"+Ne.elInfo.instanceId_exeLuncher+" : "+Ne.elInfo.computerName),dn){var o={ip_address:dn.fullInfo.ip_address,city:dn.fullInfo.city,country:dn.fullInfo.country,continent:dn.fullInfo.continent,longitude:dn.fullInfo.longitude,latitude:dn.fullInfo.latitude,security:dn.fullInfo.security,connection:dn.fullInfo.connection};n=n+" : ->"+JSON.stringify(o)}if(_n&&(n=n+" : ----\x3e"+JSON.stringify(_n)),n=n+" : ----\x3eappname: "+Zt+" , owner: "+Fe+" , "+JSON.stringify(Gt),null!=_e&&(n=n+" : ----\x3e config.peerConnectionOptions: "+JSON.stringify(_e.peerConnectionOptions)+" : ----\x3e"),n=e+" : "+n,pe){const e=nt(pe);n=n+" : ----\x3etimeRecords : "+JSON.stringify(e.timeOnlyData,null,2)}ze&&(n=n+" : ----\x3elastSetResCmdSend : "+ze),Qe&&(n=n+" : ----\x3elastIceConnectionState : "+Qe),gt&&(n=n+" : ----\x3ereTryAttemptForWebrtcReconnection : "+gt),n=(n=(n=(n=(n=null==Ke?n+" -> accessibleCanddaites: "+Ke:n+" -> accessibleCanddaites.length: "+Ke.length)+" ->  "+et())+" ->  ShouldAutoPlay: "+bn)+" : ----\x3eiceConnectionStateChanges : "+JSON.stringify(Ee,null,2))+" : ----\x3eturnServerInfo : "+JSON.stringify(be,null,2),ke&&(n=n+" : ----\x3eisIceRestart : "+ke),Ce>0&&(n=n+" : ----\x3ecountIceRestart : "+Ce),Ze(n=n+" : ----\x3euserAgent : "+navigator.userAgent)}}window.onerror=function(e,t,n,o,i){if(ot){var r="window.onerror(): "+e+": "+t+": "+n+": "+o+": "+i;if(null!=window.TelegramWebviewProxy)return r=r+":window.TelegramWebviewProxy: "+window.TelegramWebviewProxy,void console.log(r);ot(r)}},window.addEventListener("error",(function(e){if(ot){var t=`Uncaught Error: ${e.message}\nStack Trace: ${e.error?e.error.stack:"N/A"}`;if(null!=window.TelegramWebviewProxy)return void console.log(t);ot(t)}})),window.addEventListener("unhandledrejection",(function(e){var t=`111Unhandled Rejection: ${e.reason}`;null==window.TelegramWebviewProxy?ot(t):console.log(t)}));var it=40,rt=!1,at=void 0,st=void 0,lt=void 0,ct=void 0;let dt=-1;var ut=void 0,gt=0;function mt(){Jt=!1,bt&&clearInterval(bt),St&&clearInterval(St),xn.close()}function pt(){try{if(!window.close)throw new Error("window.close is not supported");if(window.close(),!window.closed)throw new Error("Failed to close the window")}catch(e){console.error("Error:",e),Nt("Scripts may close only the windows that were opened by them.",{color:"red",timeout:5e3})}}function ft(){1!=window.isAppPreparationprocessGoingOn?"1"!==It.injectStreamFromEditor&&(at=new Date,st=setInterval((function(){1==window.isAppPreparationprocessGoingOn&&clearInterval(st);var e=new Date-at;if(rt){Vo(30),clearTimeout(ut),clearInterval(st);var t=e/1e3;Ie=t,Se&&m({type:"loadTime",value:`${t} sec`}),performance?.measure("Video Start Took Time:","request-initiated","videoPlayingEventCalledAt");const i=function(e){const t=performance.getEntriesByType("mark").sort(((e,t)=>e.startTime-t.startTime)),n=t.length>0?t[0].startTime:0,o={};return t.forEach((e=>{const t=e.startTime-n,i=t>=1e3?`${(t/1e3).toFixed(2)}s`:`${t.toFixed(2)}ms`;o[i]=e.name})),o}(),r=performance.getEntriesByType("measure")[0];var n="video stream took:"+t+" sec.  Url: "+window.location.href;Ne&&Ne.elInfo&&(n=Ne.elInfo.computerName+" : "+n),dn&&(n=n+"\nIP Address: "+dn?.fullInfo?.ip_address),Gt&&Gt.ue4AppExe&&(n=n+" : "+JSON.stringify(Gt));const a=nt(pe);if(n=n+" : "+JSON.stringify(a.timeOnlyData,null,2),n+=`\nPerformance Marks: ${JSON.stringify(i,null,2)}`,n+=`\nPerformance Measures: ${JSON.stringify(r,null,2)}`,n=(n=(n=null==Ke?n+" : accessibleCanddaites: "+Ke:n+" : accessibleCanddaites.length: "+Ke.length)+" : reTryAttemptForWebrtcReconnection: "+gt)+" ->  ShouldAutoPlay: "+bn,null==It.reloadOnSuccessfulStreaming||0==It.reloadOnSuccessfulStreaming||1==It.reloadOnSuccessfulStreaming&&setTimeout((function(){mt(),Nt("reloadOnSuccessfulStreaming: "+It.reloadOnSuccessfulStreaming,{color:"Red"}),setTimeout((function(){appWindow22=window.open(Ue,"_blank"),setTimeout((function(){pt()}),2e3)}),2e3)}),3e3),xn&&xn.send(JSON.stringify({type:"DoFBEntreyofThisJsonObj",jsonObj:{video_start_time_taken_seconds:t}})),n=(n=(n=n+" ->  "+et())+" : ----\x3eiceConnectionStateChanges : "+JSON.stringify(Ee,null,2))+" : ----\x3eturnServerInfo : "+JSON.stringify(be,null,2),1==ke&&(n=n+" : ********** is Ice Restart : "+ke),Ce>0&&(n=n+" : ----\x3ecountIceRestart : "+Ce),n=n+" : ----\x3euserAgent : "+navigator.userAgent,null!=window.TelegramWebviewProxy&&(n=n+" : ----\x3ewindow.TelegramWebviewProxy : "+window.TelegramWebviewProxy),null==It.reloadOnSuccessfulStreaming||0==It.reloadOnSuccessfulStreaming){Ze(n);var o="video stream took:"+t+" sec.  Url: "+window.location.href;Gt&&Gt.ue4AppExe&&(o=o+"\nue4ExeInfo : "+JSON.stringify(Gt,null,2)),o+=`\nPerformance Marks: ${JSON.stringify(i,null,2)}`,Ze(o+=`\nPerformance Measures: ${JSON.stringify(r,null,2)}`)}}else if(e/1e3>300){var i="";if(0==bn&&1==je)i="/assets/pages/youDidNotPressPlayBtn.htm";else if(null==Ke||Ke.length<=0)if(ct.hasOwnProperty("successfulStream"))if(1==ct.successfulStream){var r="Turn server blocked for ip:  "+Xe;console.log(r),ot(r),i="/assets/pages/TurnServerBlocked.htm",ot(r+" .Video Stream failed to start after "+e/1e3+"seconds")}else 0==ct.successfulStream&&(0==ct.ue4ExeInfo.PsPluginPixelStreamingDireExist&&0==ct.ue4ExeInfo.PsPluginEntryInManifestFile?i="/assets/pages/PsPluginNotEnabled.htm":(i="/assets/pages/streamTestFailedToPass.htm",ot("streamTestFailedToPass:  .Video Stream failed to start after "+e/1e3+"seconds")));else r="PS plugin not enabled or Turn server blocked for "+Xe,console.log(r),ot(r),i="/assets/pages/TurnServerBlockedOrPsPluginNotEnabled.htm",ot(r+" .Video Stream failed to start after "+e/1e3+"seconds");else console.log("XXXX accessible Turn server accessibleCanddaites: "+Ke.length),i="/assets/pages/VideoStreamFailedToStart.htm",ot("Video Stream failed to start after "+e/1e3+"seconds");clearInterval(st),setTimeout((function(){window.location=i}),2e3)}else e/1e3>it&&(0==bn&&1==je?e3ds_alert("Stream is ready. Please press the play button to start ",{color:"Blue"}):ot("no video. time passed:"+e/1e3+" sec.  Url: "+window.location.href+"  : clientInfo:"+JSON.stringify(dn)),it+=30)}),300)):setTimeout((function(){ft()}),1e3)}"undefined"!=typeof e3ds_controller&&(e3ds_controller.terminate=function(){mt()}),"undefined"!=typeof e3ds_controller&&(e3ds_controller.sendToUnreal=function(e){xn?b(e):window.pixelStreaming.emitUIInteraction&&window.pixelStreaming.emitUIInteraction(e)});var yt=void 0,vt=void 0;let ht=null;var wt=50;let St,bt,It,Et,kt=!1,Ct=!1;var Tt="connector.eagle3dstreaming.com",Bt=void 0,xt=void 0;let Pt,At,Ot,Mt,Dt,Rt,Lt;function Ut(e,t){try{e.muted=t}catch(e){console.log("Error: "+e.message),ot("muteElement()"),ot(e.message),ot(console.trace())}}function Nt(e,t){0!=rn("enableRuntimeNotifications")&&e3ds_alert&&e3ds_alert(e,t)}function Ft(e,t,n=1e3){null!=t?1===t.readyState?t.send(e):setTimeout((function(){Ft(e,t,n)}),1e3):console.error("ahsanWsSend--\x3ews2WorkWIth undefined  ")}var _t=new Array,$t=!1,Jt=!0,qt=!0,Wt=void 0,Vt=void 0,Gt=void 0;let jt={1e3:"Normal Closure",1001:"Going Away",1002:"Protocol Error",1003:"Unsupported Data",1004:"(For future)",1005:"No Status Received",1006:"Abnormal Closure",1007:"Invalid frame payload data",1008:"Policy Violation",1009:"Message too big",1010:"Missing Extension",1011:"Internal Error",1012:"Service Restart",1013:"Try Again Later",1014:"Bad Gateway",1015:"TLS Handshake"};function Ht(e){Fe=e}function zt(e){0==e?(console=console||{},console.log=function(){},console.warn=function(){}):1==e&&(console=Be,console.log=xe,console.warn=Pe)}var Qt="assets/images/UE4_Logo.png",Xt="assets/images/background.jpg";Xt=void 0;var Kt=void 0,Yt=void 0,Zt=void 0,en=void 0,tn=!1,nn=0,on=void 0;function rn(e){if(null!=It){var t=It[e];if(""==t||"undefined"==t||null==t)return;return t}return ye.get(e)}var an=0,sn=!1,ln=1,cn="cursor:default",dn=void 0,un="assets/images/background.jpg";un=void 0;var gn=!0,mn="",pn=!1,fn=!1,yn=void 0,vn=!1,hn=document.createElement("Audio"),wn=void 0,Sn=!1,bn=1,In=0,En=0,kn=9e5,Cn=0;function Tn(){if(1==ln){console.log(" 1111111111111 showbrowserMouse === 1 > "),console.log(" 1111111111111 extractValueFromUrl(showbrowserMouse):"+rn("showbrowserMouse"));var e=rn("mouseCursorPointerStyle");""!=e&&null!=e&&(cn=e),mn=""==mn||mn.includes("cursor:")?cn:mn+" "+cn}else mn="cursor:none";console.log(" 1111111111111 styleAdditional > "+mn),F()}let Bn;var xn,Pn=null,An=!1,On=!1;const Mn=1;var Dn,Rn,Ln,Un,Nn,Fn,_n,$n,Jn=void 0,qn=new Map,Wn=null,Vn=!0;fn=!1,pn=!1,window.isAppPreparationprocessGoingOn=!1;let Gn=0;var jn=void 0,Hn=void 0,zn=void 0;function Qn(){return!(window.location===window.parent.location||window.self===window.top)}function Xn(){if(void 0===Dt&&(Dt=window.location.search),void 0===ye&&(ye=new URLSearchParams(window.location.search)),"undefined"!=typeof e3ds_controller&&null==It)if(Pt=.01,null!=e3ds_controller.core){null!=e3ds_controller.core.domain?Tt=e3ds_controller.core.domain:console.warn("e3ds_controller.core.domain absent so setting to default one: "+Tt),null!=e3ds_controller.core.userName?Ht(e3ds_controller.core.userName):console.error("e3ds_controller.core.userName missing"),null!=e3ds_controller.core.appName?Bt=e3ds_controller.core.appName:console.error("e3ds_controller.core.appName missing"),null!=e3ds_controller.core.configurationName?xt=e3ds_controller.core.configurationName:console.error("e3ds_controller.core.configurationName missing"),null==Fe&&console.error("userName missing"),null==Bt&&console.error("app missing"),null==xt&&console.error("configurationName missing");var e="/v5/"+Fe+"/"+Bt+"/"+xt;Mt=e,Ue="https://"+Tt+e,Ue+=Dt,console.log("href_emulated: "+Ue)}else console.error("e3ds_controller.core is missing ");for(var[t,n]of ye.entries()){console.log(t,n);var o=ye.get("app"),i=ye.get("owner"),r=ye.get("configuration");null!=o&&(Bt=o),null!=i&&Ht(i),null!=r&&(xt=r)}Mt=new URL(Ue).pathname,At=Mt.split("/"),Ot=At[1],Rt=window.location.hostname.split("."),Lt=Rt[1]+"."+Rt[2];for(const[e,t]of ye)"args"!==e&&"launcher"!==e||ye.set("exeLunchArgs",t),console.log(e,t);if("v5"==Ot)if("spectator"==At[2])tn=!0,nn=2,le({domain:"ms6.eaglepixelstreaming.com",httpsPort:8084});else{Ht(At[2]),Zt=At[3],en=At[4];var a=ye.get("appVersion");a&&(dt=a);for(const[e,t]of ye){if("hostMeetingId"==e){Kt=t,t&&(window.isHost=!0);break}if("GuestMeetingId"==e){Yt=t,en=At[3],Zt=void 0;break}}}else if("v4"==Ot)if(null==At[2])console.log("wrong url. missing parts of it");else{var s=At[2];console.log("/:configurationStr:"+s);var l=atob(s);console.log("/:configuration decryptedString:"+l);try{It=JSON.parse(l),It.systemVersion=4,Ht(It.owner),Zt=It.appName}catch(e){console.log("wrong url"),e instanceof SyntaxError?(console.error(e.name),console.log(e)):(console.error(e.message),console.log(e))}}else if("v6"==Ot)if(null==At[2])console.log("wrong url. missing parts of it");else{var c=At[2];1==Le&&console.log("/:jsonStr:"+c),l=atob(c),1==Le&&console.log("/:configuration decryptedString:"+l);try{decryptedJson=JSON.parse(l),It.systemVersion=6,Ht(decryptedJson.owner),Zt=decryptedJson.appName,null==decryptedJson.configName?null==decryptedJson.ConfigName?(console.warn("ConfigName: "+decryptedJson.ConfigName),Nt("Invlaid encryted Url ",{color:"Red"})):null!=decryptedJson.ConfigName&&(en=decryptedJson.ConfigName):en=decryptedJson.configName}catch(e){console.log("wrong url"),e instanceof SyntaxError?(console.error(e.name),console.log(e)):(console.error(e.message),console.log(e))}}else console.log("Invalid url");var d=document.getElementById("resoulbar");d&&(d.style.transform="scaleX(-1)"),yt=document.getElementById("streamingVideo"),"v5"!=Ot&&"v4"!=Ot&&"v6"!=Ot||tn||Yi(),qi()}var Kn=void 0,Yn=!1;function Zn(e=0,t,n){if(console.log("e3ds_session_token: "+t),console.log("clientUserName: "+n),null==t||""==t)return void console.info("invalid e3ds_session_token: "+t);if(null==n||""==n)return void console.info("invalid clientUserName");var o="https://token.eaglepixelstreaming.com/api/v1/token/verify?token="+t+"&client="+n;const i=new XMLHttpRequest;i.onreadystatechange=function(){if(422===i.status)return console.log("GetTokenInfo() received 422 status code. Returning default clientInfo object."),void or();if(429===i.status)return console.log("GetTokenInfo() received 429 status code. Retrying after 2000ms."),null!=Kn&&clearTimeout(Kn),void(Kn=setTimeout(Zn,2e3,e));if(""!==i.responseText&&void 0!==i.responseText){if(Yn)return;Yn=!0,console.log("GetTokenInfo() request successful. Clearing retry timer."),clearTimeout(Kn),console.log("GetTokenInfo() xmlHttp.responseText: "+i.responseText);var t=void 0;if(200===i.status){try{t=JSON.parse(i.responseText)}catch(e){console.info(" e3ds_session_token verification parse failed"),console.info(e)}console.log("GetTokenInfo() decryptedJsone_3ds_controller1: "+JSON.stringify(t,null,"\t")),e3ds_controller.core=t.core,e3ds_controller.configurationToOverride=t.configurationToOverride,Xn()}else if(401===i.status){try{t=JSON.parse(i.responseText)}catch(e){console.info(" e3ds_session_token verification parse failed"),console.info(e)}if(t.error)return console.warn("GetTokenInfo() error: "+t.error),void console.info(t.error)}}else e<20?(console.log("GetTokenInfo() retrying after 2000ms."),null!=Kn&&clearTimeout(Kn),Kn=setTimeout(Zn,2e3,e+1)):(console.log("GetTokenInfo() maximum retries exceeded."),or())},i.open("GET",o,!0),i.send(null)}"undefined"!=typeof e3ds_controller&&(e3ds_controller.main=function(e,t){if(null!=window.appconfigPassed2Ejs){if("string"==typeof window.appconfigPassed2Ejs)return void alert(window.appconfigPassed2Ejs);It=window.appconfigPassed2Ejs,$e=window.uInfo,Ue=window.location.href,Xn()}else Zn(0,e,t)});var eo=void 0,to=void 0,no=[],oo=void 0;function io(){const e=document.getElementById("editor-sidebar");document.getElementById("imageContainer")&&(document.getElementById("imageContainer").style.display="none"),document.getElementById("videoContainer")&&(document.getElementById("videoContainer").style.display="none"),e&&(e.style.width="0")}function ro(){var e={assetId:document.getElementById("idsInSlot")?.value,slotId:document.getElementById("GameDataSlots")?.value};"video"===document.getElementById("assetType")?.value?(e.assetType="video",e.value=document.getElementById("videoAssets")?.value):"image"===document.getElementById("assetType")?.value&&(e.assetType="image",e.value=document.getElementById("imageAssets")?.value),b({cmd:"editorUpdate",value:e})}function ao(){var e={};"video"===document.getElementById("assetType")?.value?(e.assetType="video",e.value=document.getElementById("videoAssets")?.value):"image"===document.getElementById("assetType")?.value&&(e.assetType="image",e.value=document.getElementById("imageAssets")?.value);var t=document.getElementById("idsInSlot")?.value,n={};n[t]=e;let o={type:"saveEditorUpdate",slotId:document.getElementById("GameDataSlots")?.value,data:n};console.log("save editor update: ",JSON.stringify(o)),xn.send(JSON.stringify(o))}var so=void 0;function lo(){return/Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function co(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)}function m(e){Qn()&&window.top.postMessage(e,"*")}var uo=!1,go=void 0,mo=void 0;let po,fo=[],yo=[];function vo(e){null!=Pn?(ge("receivedOfferAt",fe()),console.log("AHSAN. receiveOffer() recoived an unhandled offer :",e),e.sfu&&(this.sfu=!0,delete e.sfu),Pn.pcClient||(console.log("Creating a new PeerConnection in the browser."),Pn.pcClient=new RTCPeerConnection(Pn.cfg),setupPeerConnection(Pn.pcClient),Pn.dcClient=createDataChannel(Pn.pcClient,"cirrus",Pn.dataChannelOptions)),Pn.pcClient.setRemoteDescription(e).then((()=>{setupTransceiversAsync(Pn.pcClient).finally((function(){Pn.pcClient.createAnswer().then((e=>(mungeSDP(e),Pn.pcClient.setLocalDescription(e)))).then((()=>{if(xn&&xn.readyState===Mn){let e=JSON.stringify(Pn.pcClient.currentLocalDescription);console.log("->arvind SS: SendAnswer"),xn.send(e)}})).then((()=>{let e=Pn.pcClient.getReceivers();for(let t of e)t.playoutDelayHint=0})).catch((e=>console.error("createAnswer() failed:",e)))}))}))):setTimeout((function(){vo(e)}),1e3)}function ho(){ge("audioElemPlayCalledAt",fe()),hn.play().then((()=>{ge("audioElemPlayCallSuccededAt",fe()),hn.ahsanHack="success",hn.muted=!1,Ut(streamingVideo,!1),console.log("audioElem2.muted: "+hn.muted)})).catch((e=>{hn.ahsanHack="failed",console.warn("Autoplay  audio was prevented.waiting  for first interaction call "),console.log("handleOnAudioTrack() Error.message : "+e.message),console.log("handleOnAudioTrack() error.name : ",e.name),console.log("handleOnAudioTrack() error.stack : ",e.stack)}))}let wo=1/0,So=0,bo=0,Io=0,Eo=0;function ko(e,t){if("RoundTripTime"===e)return void 0===t||(t<wo&&(wo=t),t>bo&&(bo=t),Io+=t,Eo++,So=Io/Eo),{minRoundTripTime:Number(wo.toFixed(3)),maxRoundTripTime:Number(bo.toFixed(3)),avgRoundTripTime:Number(So.toFixed(3))}}var Co=[];function To(){if(null==Pn)return;let e=3e5,t=e;Pn.onAggregatedStats=n=>{let o={};o.time=fe(),null!=n.bitrate&&(o.bitrate=n.bitrate),o.packetsLost=function(e=0,t){return Math.abs(t-e)}(null==po?0:po.packetsLost,n.packetsLost),Co.push(o),po={...po,...n},po={...po,...ko("RoundTripTime",n.currentRoundTripTime)};let i=new Intl.NumberFormat(window.navigator.language,{maximumFractionDigits:0}),r=new Intl.NumberFormat(window.navigator.language,{maximumFractionDigits:0,minimumIntegerDigits:2}),a=(n.timestamp-n.timestampStart)/1e3,s=[],l=[60,60];for(let e=0;e<l.length;e++)s.push(a%l[e]),a/=l[e];s.push(a);let c=s[0],d=Math.floor(s[1]),u=Math.floor([s[2]]),g="B",m=n.hasOwnProperty("bytesReceived")?n.bytesReceived:0,p=["kB","MB","GB"];for(let e=0;e<p.length&&!(m<1e5);e++)m/=1e3,g=p[e];let f="kB",y=n.hasOwnProperty("audiobytesReceived")?n.audiobytesReceived:0,v=["MB","GB"];y/=1e3;for(let e=0;e<v.length&&!(y<1e5);e++)y/=1e3,f=v[e];var h="B",w=n.hasOwnProperty("databytesReceived")?n.databytesReceived:0;let S=["kB","MB","GB"];for(let e=0;e<S.length&&!(w<1e5);e++)w/=1e3,h=S[e];var b="B",I=n.hasOwnProperty("databytesSent")?n.databytesSent:0;let E=["kB","MB","GB"];for(let e=0;e<E.length&&!(I<1e5);e++)I/=1e3,b=E[e];let k=document.getElementById("qualityStatus"),C=document.getElementById("networkQualityStatus"),T=function(e){let t=e,n=1,o=setInterval((function(){n-=.1,k&&(k.style=`opacity: ${Math.abs(2*(n-.5))}`),C&&(C.style=`opacity: ${Math.abs(2*(n-.5))}`),n<=.1&&(0==--t?clearInterval(o):n=1)}),100/e)},B="",x="lime";L>35?(x="red",T(2),B+=`<div style="color: ${x}">Bad network connection</div>`):L>26&&(x="orange",T(1),B+=`<div style="color: ${x}">Spotty network connection</div>`,console.log("Spotty network connection")),k&&(k.className=`${x}Status`),C&&(C.className=`${x}Status`),B+=`<div>Duration: ${r.format(u)}:${r.format(d)}:${r.format(c)}</div>`,B+=`<div>Video Resolution: ${n.hasOwnProperty("frameWidth")&&n.frameWidth&&n.hasOwnProperty("frameHeight")&&n.frameHeight?n.frameWidth+"x"+n.frameHeight:"N/A"}</div>`,B+=`<div>Received (${g}): ${i.format(m)}</div>`,B+=`<div>Video_arvi Received (${g}): ${i.format(m)}</div>`,B+=`<div>Audio Received (${f}): ${i.format(y)}</div>`,B+=`<div>Data Received (${h}): ${i.format(w)}</div>`,B+=`<div>Data Sent (${b}): ${i.format(I)}</div>`,B+=`<div>Frames Decoded: ${n.hasOwnProperty("framesDecoded")?i.format(n.framesDecoded):"N/A"}</div>`,B+=`<div>Packets Lost: ${n.hasOwnProperty("packetsLost")?i.format(n.packetsLost):"N/A"}</div>`,B+=`<div style="color: ${x}">Bitrate (kbps): ${n.hasOwnProperty("bitrate")?i.format(n.bitrate):"N/A"}</div>`,B+=`<div>Framerate: ${n.hasOwnProperty("framerate")?i.format(n.framerate):"N/A"}</div>`,B+=`<div>Frames dropped: ${n.hasOwnProperty("framesDropped")?i.format(n.framesDropped):"N/A"}</div>`,B+=`<div>Latency (ms): ${n.hasOwnProperty("currentRoundTripTime")?i.format(1e3*n.currentRoundTripTime):"N/A"}</div>`,B+=`<div style="color: ${x}">Video Quantization Parameter: ${L}</div>`;let P=document.getElementById("stats");P&&(P.innerHTML=B);let A="";if(void 0!==Ri&&Ri.systemInfo&&Ri.systemInfo.graphics&&(Ri.systemInfo.cpu&&(cpu=Ri.systemInfo.cpu,A+=`<div id="cpu-stats" style="color: lime">CPU: ${cpu.manufacturer} ${cpu.brand??"Unknown"}</div>`),Ri.systemInfo.graphics.controllers&&Ri.systemInfo.graphics.controllers.length>0&&(gpu=Ri.systemInfo.graphics.controllers[0],A+=`<div id="gpu-stats" style="color: lime">GPU: ${gpu.model??"Unknown"}</div>`),Ri.systemInfo.memory&&(memory=Ri.systemInfo.memory,A+=`<div id="total-memory-stats" style="color: lime">Total Memory: ${O=memory.total??0,Math.ceil(O/1073741824)} GB</div>`),Ri.clientInfo)){let{city:e,region:t,country_name:n}=Ri.clientInfo;A+=`<div id="streamer-location" style="color: lime">Streamer Location: ${n}</div>`}var O;A+=B;let M=document.getElementById("statsInfoExtra");M&&(M.innerHTML=A),An&&(console.log(`-> SS: stats\n${JSON.stringify(n)}`),console.log("-> SS: stats"),n.timestampStart&&n.timestamp-n.timestampStart>t&&(xn&&xn.readyState===Mn&&(console.log("-> SS: stats"),xn.send(JSON.stringify({type:"stats",data:n}))),t+=e))},Pn.aggregateStats(1e3),Pn.latencyTestTimings.OnAllLatencyTimingsReady=function(e){if(!e.BrowserReceiptTimeMs)return;let t=e.BrowserReceiptTimeMs-e.TestStartTimeMs,n=0==e.UEPreEncodeTimeMs||0==e.UEPreCaptureTimeMs?"???":e.UEPostEncodeTimeMs-e.UEPreCaptureTimeMs,o=e.UEPostCaptureTimeMs-e.UEPreCaptureTimeMs,i=e.UEPostEncodeTimeMs-e.UEPreEncodeTimeMs,r=e.UETransmissionTimeMs-e.UEReceiptTimeMs,a=t-r,s=t-a-r,l=null,c=null;console.log("timings.FrameDisplayDeltaTimeMs: "+e.FrameDisplayDeltaTimeMs),console.log("timings.BrowserReceiptTimeMs: "+e.BrowserReceiptTimeMs),e.FrameDisplayDeltaTimeMs&&e.BrowserReceiptTimeMs&&(l=e.FrameDisplayDeltaTimeMs+t,c=l-a-r),console.log("endToEndLatency: "+l),console.log("browserSideLatency: "+c);let d="";d+=`<div>Net latency RTT (ms): ${a}</div>`,d+=`<div>UE Capture+Encode (ms): ${n}</div>`,d+=`<div>UE Capture (ms): ${o}</div>`,d+=`<div>UE Encode (ms): ${i}</div>`,d+=`<div>Total UE latency (ms): ${r}</div>`,d+=`<div>Browser send latency (ms): ${s}</div>`,d+=e.FrameDisplayDeltaTimeMs&&e.BrowserReceiptTimeMs?`<div>Browser receive latency (ms): ${e.FrameDisplayDeltaTimeMs}</div>`:"",d+=c?`<div>Total browser latency (ms): ${c}</div>`:"",d+=`<div>Total latency (excluding browser) (ms): ${t}</div>`,d+=l?`<div>Total latency (ms): ${l}</div>`:"",console.log(d),document.getElementById("LatencyStats").innerHTML=d}}function Bo(){let e=btoa(q.jpeg.reduce(((e,t)=>e+String.fromCharCode(t)),""));Wn.src="data:image/jpeg;base64,"+e,Wn.onload=function(){q.height=Wn.naturalHeight,q.width=Wn.naturalWidth,V(),Vn?(di(),F()):W()}}var xo=[];function Po(e){ge("webRtcPlayerConstructorCalledAt",fe()),e=e||{};var t=this;1==It.forceNoTurnServer&&(e.peerConnectionOptions=void 0),e.peerConnectionOptions?this.cfg=e.peerConnectionOptions:this.cfg={},this.cfg.sdpSemantics="unified-plan",this.cfg.offerExtmapAllowMixed=!1,this.pcClient=null,this.dcClient=null,this.tnClient=null,this.sdpConstraints={offerToReceiveAudio:1,offerToReceiveVideo:1},this.dataChannelOptions={ordered:!0},this.latencyTestTimings={TestStartTimeMs:null,UEReceiptTimeMs:null,UEPreCaptureTimeMs:null,UEPostCaptureTimeMs:null,UEPreEncodeTimeMs:null,UEPostEncodeTimeMs:null,UETransmissionTimeMs:null,BrowserReceiptTimeMs:null,FrameDisplayDeltaTimeMs:null,Reset:function(){this.TestStartTimeMs=null,this.UEReceiptTimeMs=null,this.UEPreCaptureTimeMs=null,this.UEPostCaptureTimeMs=null,this.UEPreEncodeTimeMs=null,this.UEPostEncodeTimeMs=null,this.UETransmissionTimeMs=null,this.BrowserReceiptTimeMs=null,this.FrameDisplayDeltaTimeMs=null},SetUETimings:function(e){this.UEReceiptTimeMs=e.ReceiptTimeMs,this.UEPreCaptureTimeMs=e.PreCaptureTimeMs,this.UEPostCaptureTimeMs=e.PostCaptureTimeMs,this.UEPreEncodeTimeMs=e.PreEncodeTimeMs,this.UEPostEncodeTimeMs=e.PostEncodeTimeMs,this.UETransmissionTimeMs=e.TransmissionTimeMs,this.BrowserReceiptTimeMs=Date.now(),this.OnAllLatencyTimingsReady(this)},SetFrameDisplayDeltaTime:function(e){null==this.FrameDisplayDeltaTimeMs&&(this.FrameDisplayDeltaTimeMs=Math.round(e),this.OnAllLatencyTimingsReady(this))},OnAllLatencyTimingsReady:function(e){}},createWebRtcVideo=function(){var e=yt;if(setInterval((function(){e.readyState}),1e3),1==bn&&(_t.length>0||(e.autoplay=!0,Ut(e,!0)),e.disablepictureinpicture=!0,s()),e.addEventListener("loadstart",(function(){ge("videoLoadStartEventCalledAt",fe())})),e.addEventListener("durationchange",(function(e){}),!0),e.addEventListener("loadeddata",(function(e){ge("videoLoadeddataEventCalledAt",fe()),console.log("loadeddata video() e.target.duration:",e.target.duration)}),!0),e.addEventListener("seeking",(e=>{console.log("Video is seeking a new position.")})),e.addEventListener("seeked",(e=>{console.log("Video found the playback position it was looking for.")})),e.addEventListener("playing",(e=>{if(ge("videoPlayingEventCalledAt",fe()),console.log("Video is no longer paused"),rt=!0,Oo(),null!=Ae&&ot("video streame started with isCceConnectionState: "+Ae),document.getElementById("e3ds_alert_container")&&(document.getElementById("e3ds_alert_container").innerHTML="",window.e3ds_alert_contents=[]),clearTimeout(ut),It&&1==It.injectStreamFromEditor){var t=document.getElementById("popupForinjectStreamFromEditorInfo");t&&(t.style.display="none")}})),e.addEventListener("waiting",(e=>{console.log("Video is waiting for more data.")})),e.addEventListener("ended",(e=>{console.log("Video stopped either because 1) it was over, or 2) no further data is available.")})),e.addEventListener("volumechange",(e=>{console.log("The volume changed.")})),e.addEventListener("emptied",(e=>{console.log("Uh oh. The media is empty. Did you call load()?")})),e.addEventListener("stalled",(e=>{console.log("Failed to fetch data, but trying.")})),e.addEventListener("progress",(function(e){}),!0),e.addEventListener("canplay",(function(e){}),!0),e.addEventListener("canplaythrough",(function(e){}),!0),e.addEventListener("loadedmetadata",(function(e){ge("videoLoadedMetaDataEventCalledAt",fe()),console.log("loadedmetadata video():",new Date);var t=new Date-go;Math.round(t/6e4),console.log("Time cost :",t/6e4),clearInterval(mo),xn&&xn.readyState===Mn&&(console.log("----------------- webRtcPlayerObj.onVideoInitialised()--\x3eWS_OPEN_STATE"),1==rn("isE3DSEngineApp")&&function(){if(1!=rn("isE3DSEngineApp"))return console.warn("Engine version below 4.26. so skipping settingsButton VideoEncoderQP -> : "+L),void Nt("Require Atleast E3DS-UE4-Engine 4.26 "+(Math.random()*(.12-.02)+.02).toFixed(4),{timeout:2e3,color:"blue"});var e=JSON.stringify({type:"settings",data:{quality:rn("quality"),minBitrate:rn("minBitrate"),maxBitrate:rn("maxBitrate"),resolution:rn("resolution"),rateCtrl:rn("rateCtrl")}});0==rn("qualityLevel")?e.minBitrate=0:1==rn("qualityLevel")&&(e.minBitrate=2e7),console.log("applyInitialeStreamSettings--\x3e "+e),xn.send(e)}(),Vn&&(di(),F()))}),!0),"requestVideoFrameCallback"in HTMLVideoElement.prototype){const n=(o,i)=>{if(i.receiveTime&&i.expectedDisplayTime){const e=i.presentationTime-i.receiveTime;t.aggregatedStats||(t.aggregatedStats={}),t.aggregatedStats.receiveToCompositeMs=e}e.requestVideoFrameCallback(n)};e.requestVideoFrameCallback(n)}return e},this.video=createWebRtcVideo(),onsignalingstatechange=function(e){console.log("signaling state change:",e)},oniceconnectionstatechange=function(e){console.log("XXXXXXX-> ice connection state change.evt.target.iceConnectionState:",e.target.iceConnectionState,"  -> ",new Date),console.log("webRtcPlayerObj.pcClient.iceConnectionState:",Pn.pcClient.iceConnectionState,"  -> ",new Date);let t={state:e.target.iceConnectionState,timestamp:new Date};switch(Ee.push(t),Qe=e.target.iceConnectionState,e.target.iceConnectionState){case"new":console.log("ICE connection state: New connection.");break;case"checking":console.log("ICE connection state: Checking connectivity.");break;case"connected":case"completed":console.log("ICE connection state: Connection established.");break;case"disconnected":console.log("ICE connection state: Disconnected from the remote peer."),console.log(" XXXXXXX-> restartICEWithoutTurn"),Pn.pcClient&&(console.log("Closing existing PeerConnection"),Pn.pcClient.close(),Pn.pcClient=null),ke=!0,Pn?(console.log("Creating offer"),Ce+=1,console.log("countIceRestart:"+Ce),Pn.createOffer()):console.log("WebRTC player not setup, cannot create offer");break;case"failed":console.log("ICE connection state: Connection failed."),Ae=0,ot(e.target.iceConnectionState);break;case"closed":console.log("ICE connection state: Connection closed.");break;default:console.log("Unknown ICE connection state.")}if("disconnected"==e.target.iceConnectionState)console.warn("ice server diconnected");else if("connected"==e.target.iceConnectionState){ge("iceConnectedAt",fe());var n=new Date-vt,o="iceConnectionState connected at : "+Math.round(n/6e4);console.log(o),o>10&&ot(o),mo=setInterval((function(){console.log("High load.Might take upto 3 min. dont close tab ")}),15e3)}"failed"===Pn.pcClient.iceConnectionState&&(Ae=1,ot(Pn.pcClient.iceConnectionState+" --\x3e failed"))},onicegatheringstatechange=function(e){console.log("ice gathering state change:",e),oe(5),"complete"===Pn.pcClient.iceGatheringState&&(null==Ke&&(Ke=[]),Ye.length>0&&Ye.forEach((e=>{if(console.log(Xe,e.address),Xe===e.address)return console.log("stun/turn server accessible from "+Xe),void Ke.push(e)})))},handleTrackRemoved=function(e){console.log("A remote track has been removed"),"video"===e.track.kind&&(ge("handleTrackRemovedVideoCalledAt",fe()),console.log(" video stream has stopped."))},handleOnTrack=function(e){if(console.log("handleOnTrack",e.streams),e.track&&console.log("Got track - "+e.track.kind+" id="+e.track.id+" readyState="+e.track.readyState),"audio"==e.track.kind)return ge("handleOnTrackAudioCalledAt",fe()),void(Wt=e.streams[0]);if("video"==e.track.kind&&(t.video.srcObject,e.streams[0]),ge("handleOnTrackVideoCalledAt",fe()),null!=ht&&ht!==e.track&&console.log("Video track has changed"),ht=e.track,ht.onended=function(){ge("currentVideoTrackEndedAt",fe()),console.log("XXXXXXXXXXXX Video has stopped.")},oe(5),_t.length>0){let n=document.getElementById("skip_video");console.log(bn),parseInt(bn)?t.video.srcObject=e.streams[0]:parseInt(bn)||(document.getElementById("skip_video").style.display="block",null!==n&&(n.onclick=function(n){document.getElementById("skip_video").style.display="none",t.video.srcObject=e.streams[0]})),null!=rn("LoadingScreenSkipButtonText")&&""!=rn("LoadingScreenSkipButtonText")&&(document.getElementById("skip_video").innerHTML=rn("LoadingScreenSkipButtonText"))}else t.video.srcObject=e.streams[0];return console.log("Set video source from video track ontrack."),xn&&xn.send(JSON.stringify({type:"DoFBEntreyofVideoStreamStartedAt",loggedInUserData:Je,configFromSS:_e})),St&&clearInterval(St),void(St=setInterval((function(){Oo(),console.log("latest aggregated stats: ",po),xn&&xn.send(JSON.stringify({type:"updateFBEntryofVideoStreamContinueHeartBeat",loadTime:Ie,ue4ExeInfo:Gt,acquiringPhase:ue,webRtcStatsData:po,webRtcTimedStatsArray:Co,turnServerInfo:be,timeRecords:pe,candidates_selected:Me,isIceRestart:ke,countIceRestart:Ce,iceConnectionStateChanges:Ee}))}),3e4))},this.handleOnAudioTrack=function(e){ge("handleOnAudioTrackCalledAt",fe()),console.log("handleOnAudioTrack()111:",new Date),t.video.srcObject!=e&&t.video.srcObject&&t.video.srcObject!==e&&(hn.autoplay=!0,hn.srcObject=e,wn=e,hn.addEventListener("loadedmetadata",(function(e){}),!0),hn.addEventListener("loadstart",(function(){})),hn.addEventListener("durationchange",(function(e){}),!0),hn.addEventListener("loadeddata",(function(e){}),!0),hn.addEventListener("progress",(function(e){}),!0),hn.addEventListener("canplay",(function(e){}),!0),hn.addEventListener("canplaythrough",(function(e){}),!0),ho())},createDataChannel=function(e,t,n){ge("createDataChannelCalledAt",fe());let o=e.createDataChannel(t,n);return console.log(`Created datachannel (${t})`),setupDataChannelCallbacks(o),o},setupDataChannelCallbacks=function(e){try{return e.binaryType="arraybuffer",e.addEventListener("open",(t=>{ge("datachannelconnectedAt",fe()),console.log(`Data channel connected: ${e.label}(${e.id})`),"function"==typeof onDataChannelOpen?onDataChannelOpen():console.log("not found onDataChannelOpen"),e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onDataChannelOpen&&e3ds_controller.callbacks.onDataChannelOpen(),xn&&xn.readyState===Mn&&(si("WebRTC connected, waiting for video"),oe(100),b("4K"),J(),Vo(30),(new Date).toUTCString(),xn&&xn.send(JSON.stringify({type:"DoFBEntreyofDataChannelConnectedAt",loggedInUserData:Je})),bt&&clearInterval(bt),bt=setInterval((function(){xn&&xn.send(JSON.stringify({type:"updateFBEntryofDataChannelHeartBeat"}))}),3e4)),clearTimeout(Un),function(){let e={};$n&&(e.cmdLineArgs=$n,console.log("33333333333333 sendDataToUE4App emitUIInteraction: "+JSON.stringify(e)),b(e))}(),null!=It.consoleCmdsToPassToUnrealApp&&""!=It.consoleCmdsToPassToUnrealApp&&It.consoleCmdsToPassToUnrealApp.split(";").forEach((e=>{var t=e.trim();console.log("Executing command:"+t);var n={ConsoleCommand:t};1==Le&&console.log(n),I(n),"function"==typeof window?.pixelStreaming?.emitCommand&&window.pixelStreaming.emitCommand(n)}))})),e.addEventListener("close",(t=>{ge("datachannelClosedAt",fe()),console.log(`Data channel disconnected: ${e.label}(${e.id}`,t),bt&&clearInterval(bt),"function"==typeof onDataChannelClose?onDataChannelClose():console.log("not found onDataChannelClose"),e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onDataChannelClose?e3ds_controller.callbacks.onDataChannelClose():console.log("not found e3ds_controller.callbacks.onDataChannelClose")})),e.addEventListener("message",(e=>{!function(e){var t=new Uint8Array(e);let n=new TextDecoder("utf-16").decode(e.slice(1));var o,i,r,a=n,s=void 0;try{s=JSON.parse(a),onProtocolMessage(s)}catch(e){}if(q.receiving){let e=new Uint8Array(q.jpeg.length+t.length);e.set(q.jpeg,0),e.set(t,q.jpeg.length),q.jpeg=e,q.jpeg.length===q.size?(q.receiving=!1,q.valid=!0,console.log(`received complete freeze frame ${q.size}`),Bo()):q.jpeg.length>q.size?(console.error(`received bigger freeze frame than advertised: ${q.jpeg.length}/${q.size}`),q.jpeg=void 0,q.receiving=!1):console.log(`received next chunk (${t.length} bytes) of freeze frame: ${q.jpeg.length}/${q.size}`)}else if(t[0]===A.fmp4){var l=e.slice(1);console.log("fmp4 size "+l.byteLength),putPacket(l)}else if(t[0]===A.QualityControlOwnership){let e=0!==t[1];null!=Dn&&null!=e&&(Dn.disabled=e,Dn.checked=e)}else if(t[0]===A.Response){if(tn)return;let t=new TextDecoder("utf-16").decode(e.slice(1));console.log("111111111 response: "+t);for(let e of qn.values())e(t)}else if(t[0]===A.Command){let t=new TextDecoder("utf-16").decode(e.slice(1));console.log("111111111 commandAsString: "+t);let n=JSON.parse(t);"onScreenKeyboard"===n.command&&1==n.showOnScreenKeyboard&&(o=n.contents,i=document.getElementById("popupForOnScreenKeyboard"),r=document.getElementById("UserInput"),i&&lo()&&(r&&(r.value=""),o&&(r.value=o),i.style.display="flex",i.idFromUnreal=obj.id))}else if(t[0]===A.FreezeFrame)q.size=new DataView(t.slice(1,5).buffer).getInt32(0,!0),q.jpeg=t.slice(5),q.jpeg.length<q.size?(console.log(`received first chunk of freeze frame: ${q.jpeg.length}/${q.size}`),q.receiving=!0):(console.log(`received complete freeze frame: ${q.jpeg.length}/${q.size}`),Bo());else if(t[0]===A.UnfreezeFrame)Wn.style.display="none",q.valid=!1;else if(t[0]===A.VideoEncoderAvgQP)L=new TextDecoder("utf-16").decode(e.slice(1));else if(t[0]==A.LatencyTest){let t=new TextDecoder("utf-16").decode(e.slice(1));console.log("Got latency timings from UE."),console.log(t);let n=JSON.parse(t);console.log("LatencyTest from ue:"+JSON.stringify(n,null,"\t")),Pn&&Pn.latencyTestTimings.SetUETimings(n)}else if(t[0]==A.InitialSettings){let t=new TextDecoder("utf-16").decode(e.slice(1)),n=JSON.parse(t);console.log("InitialSettings from ue:"+JSON.stringify(n,null,"\t")),Et=n;var c=document.getElementById("resoulbar");c&&(c.value=Et.Encoder.MaxQP)}else console.warn(`processResponseData data: unrecognised data received, packet ID ${t[0]}`+JSON.stringify(t[0])),console.log(n),console.log(e),console.log(t),console.log(JSON.stringify(t)),console.log()}(e.data)})),e.addEventListener("error",(t=>{console.error(`Data channel error: ${e.label}(${e.id}`,t)})),e}catch(e){return console.warn("Datachannel setup caused an exception: ",e),null}},onicecandidate=function(e){console.log("----- onicecandidate() ICE candidate: ",e);var t=e;if(t.candidate){if(fo.push(e.candidate),Ye.push(e.candidate),xo.push(e.candidate.candidate),t.candidate.candidate&&xn&&xn.readyState===Mn&&(console.log("-> SS: iceCandidate"),e.candidate)){console.log("candidate--\x3e: "+e.candidate.candidate),console.log(e.candidate);const n=e.candidate.url,o=e.candidate.address,i=e.candidate.port;if(console.log("ICE Candidate:",e.candidate),console.log("Candidate url:",n),console.log("Candidate Address:",o),console.log("Candidate Port:",i),n){if(n.includes("xirsys.com")){if(Ce<=1)return void console.log("xirsys candidate discarded:",e.candidate);console.log("xirsys candidate allowing . bcz countIceRestart:"+Ce,e.candidate)}n.includes("twilio.com")}xn.send(JSON.stringify({type:"iceCandidate",candidate:t.candidate}))}console.warn("onicecandidate()---\x3e e.candidate.type",t.candidate.type),t.candidate.type,"srflx"==t.candidate.type&&(console.warn("The STUN server is reachable!"),console.log(`   Your Public IP Address is: ${t.candidate.address}`)),"relay"==t.candidate.type&&console.warn("The TURN server is reachable !")}else console.warn("onicecandidate()---\x3e ICE candidate undefined",new Date)},handleCreateOffer=function(e){t.sdpConstraints.iceRestart=ke,e.createOffer(t.sdpConstraints).then((function(t){if(rn("audioType"),mungeSDP(t),console.log("------offer.sdp: "+t.sdp),console.warn("111 pc.setLocalDescription(offer)",new Date),e.setLocalDescription(t),console.warn("222 pc.setLocalDescription(offer)",new Date),console.log("------offer.sdp: "+t.sdp),xn&&xn.readyState===Mn){let e=JSON.stringify(t);console.log("-> SS: offer:"),xn.send(e)}}),(function(){console.warn("Couldn't create offer")}))},mungeSDP=function(e){let t=e.sdp.replace(/(a=fmtp:\d+ .*level-asymmetry-allowed=.*)\r\n/gm,"$1;x-google-start-bitrate=10000;x-google-max-bitrate=100000\r\n"),n="maxaveragebitrate=510000;";uo&&(n+="sprop-maxcapturerate=48000;"),n+="stereo=1;",n+="useinbandfec=1",t=t.replace("useinbandfec=1",n),e.sdp=t},handleCreateAnswer111=function(e){e.createAnswer().then((function(t){e.setLocalDescription(t).then((function(){if(console.log("answer %o",t.sdp),xn&&xn.readyState===Mn){let e=JSON.stringify(t);console.log("->arvind SS: SendAnswer"),xn.send(e)}}))}),(function(){console.warn("Couldn't create offer")}))},setupPeerConnection=function(e){e.SetBitrate&&console.log("Hurray! there's RTCPeerConnection.SetBitrate function"),e.onsignalingstatechange=onsignalingstatechange,e.oniceconnectionstatechange=oniceconnectionstatechange,e.onicegatheringstatechange=onicegatheringstatechange,e.ontrack=handleOnTrack,e.onremovetrack=handleTrackRemoved,e.onicecandidate=onicecandidate,e.onnegotiationneeded=function(){console.warn("Negotiation Needed")},e.onicecandidateerrorIsSendToTlegarm=!1,e.onicecandidateerror=function(t){console.warn("onicecandidateerror(): "+t.errorCode),t.errorCode>=300&&t.errorCode<=699||t.errorCode>=700&&t.errorCode<=799&&701==t.errorCode&&(console.warn("Error 701 indicates that none of the ICE candidates were able to successfully make contact with the STUN or TURN server. The 701 error is fired only once per server URL from the list of available STUN or TURN servers provided when creating the RTCPeerConnection "),e.onicecandidateerrorIsSendToTlegarm||(e.onicecandidateerrorIsSendToTlegarm=!0))}},generateAggregatedStatsFunction111=function(){return t.aggregatedStats||(t.aggregatedStats={}),function(e){let n={};e.forEach((e=>{"inbound-rtp"!=e.type||e.isRemote||"audio"!=e.mediaType&&!e.id.toLowerCase().includes("audio")?"data-channel"==e.mediaType||e.id.toLowerCase().includes("data")?(n.databytesReceived=e.bytesReceived,n.databytesSent=e.bytesSent):"inbound-rtp"!=e.type||e.isRemote||"video"!=e.mediaType&&!e.id.toLowerCase().includes("video")||(n.timestamp=e.timestamp,n.bytesReceived=e.bytesReceived,n.framesDecoded=e.framesDecoded,n.packetsLost=e.packetsLost,n.bytesReceivedStart=t.aggregatedStats&&t.aggregatedStats.bytesReceivedStart?t.aggregatedStats.bytesReceivedStart:e.bytesReceived,n.framesDecodedStart=t.aggregatedStats&&t.aggregatedStats.framesDecodedStart?t.aggregatedStats.framesDecodedStart:e.framesDecoded,n.timestampStart=t.aggregatedStats&&t.aggregatedStats.timestampStart?t.aggregatedStats.timestampStart:e.timestamp,t.aggregatedStats&&t.aggregatedStats.timestamp&&(t.aggregatedStats.bytesReceived&&(n.bitrate=8*(n.bytesReceived-t.aggregatedStats.bytesReceived)/(n.timestamp-t.aggregatedStats.timestamp),n.bitrate=Math.floor(n.bitrate),n.lowBitrate=t.aggregatedStats.lowBitrate&&t.aggregatedStats.lowBitrate<n.bitrate?t.aggregatedStats.lowBitrate:n.bitrate,n.highBitrate=t.aggregatedStats.highBitrate&&t.aggregatedStats.highBitrate>n.bitrate?t.aggregatedStats.highBitrate:n.bitrate),t.aggregatedStats.bytesReceivedStart&&(n.avgBitrate=8*(n.bytesReceived-t.aggregatedStats.bytesReceivedStart)/(n.timestamp-t.aggregatedStats.timestampStart),n.avgBitrate=Math.floor(n.avgBitrate)),t.aggregatedStats.framesDecoded&&(n.framerate=(n.framesDecoded-t.aggregatedStats.framesDecoded)/((n.timestamp-t.aggregatedStats.timestamp)/1e3),n.framerate=Math.floor(n.framerate),n.lowFramerate=t.aggregatedStats.lowFramerate&&t.aggregatedStats.lowFramerate<n.framerate?t.aggregatedStats.lowFramerate:n.framerate,n.highFramerate=t.aggregatedStats.highFramerate&&t.aggregatedStats.highFramerate>n.framerate?t.aggregatedStats.highFramerate:n.framerate),t.aggregatedStats.framesDecodedStart&&(n.avgframerate=(n.framesDecoded-t.aggregatedStats.framesDecodedStart)/((n.timestamp-t.aggregatedStats.timestampStart)/1e3),n.avgframerate=Math.floor(n.avgframerate)))):n.audiobytesReceived=e.bytesReceived,"track"!=e.type||"video_label"!=e.trackIdentifier&&"video"!=e.kind||(n.framesDropped=e.framesDropped,n.framesReceived=e.framesReceived,n.framesDroppedPercentage=e.framesDropped/e.framesReceived*100,n.frameHeight=e.frameHeight,n.frameWidth=e.frameWidth,n.frameHeightStart=t.aggregatedStats&&t.aggregatedStats.frameHeightStart?t.aggregatedStats.frameHeightStart:e.frameHeight,n.frameWidthStart=t.aggregatedStats&&t.aggregatedStats.frameWidthStart?t.aggregatedStats.frameWidthStart:e.frameWidth),"candidate-pair"==e.type&&e.hasOwnProperty("currentRoundTripTime")&&0!=e.currentRoundTripTime&&(n.currentRoundTripTime=e.currentRoundTripTime)})),n.bitrate,n.framerate,n.framesDropped,n.packetsLost,t.aggregatedStats=n,t.onAggregatedStats&&t.onAggregatedStats(n)}},generateAggregatedStatsFunction=function(){return t.aggregatedStats||(t.aggregatedStats={}),function(e){let n={};e.forEach((e=>{"inbound-rtp"!=e.type||e.isRemote||"video"!=e.mediaType&&!e.id.toLowerCase().includes("video")||(n.timestamp=e.timestamp,n.bytesReceived=e.bytesReceived,n.framesDecoded=e.framesDecoded,n.packetsLost=e.packetsLost,n.bytesReceivedStart=t.aggregatedStats&&t.aggregatedStats.bytesReceivedStart?t.aggregatedStats.bytesReceivedStart:e.bytesReceived,n.framesDecodedStart=t.aggregatedStats&&t.aggregatedStats.framesDecodedStart?t.aggregatedStats.framesDecodedStart:e.framesDecoded,n.timestampStart=t.aggregatedStats&&t.aggregatedStats.timestampStart?t.aggregatedStats.timestampStart:e.timestamp,t.aggregatedStats&&t.aggregatedStats.timestamp&&(t.aggregatedStats.bytesReceived&&(n.bitrate=8*(n.bytesReceived-t.aggregatedStats.bytesReceived)/(n.timestamp-t.aggregatedStats.timestamp),n.bitrate=Math.floor(n.bitrate),n.lowBitrate=t.aggregatedStats.lowBitrate&&t.aggregatedStats.lowBitrate<n.bitrate?t.aggregatedStats.lowBitrate:n.bitrate,n.highBitrate=t.aggregatedStats.highBitrate&&t.aggregatedStats.highBitrate>n.bitrate?t.aggregatedStats.highBitrate:n.bitrate),t.aggregatedStats.bytesReceivedStart&&(n.avgBitrate=8*(n.bytesReceived-t.aggregatedStats.bytesReceivedStart)/(n.timestamp-t.aggregatedStats.timestampStart),n.avgBitrate=Math.floor(n.avgBitrate)),t.aggregatedStats.framesDecoded&&(n.framerate=(n.framesDecoded-t.aggregatedStats.framesDecoded)/((n.timestamp-t.aggregatedStats.timestamp)/1e3),n.framerate=Math.floor(n.framerate),n.lowFramerate=t.aggregatedStats.lowFramerate&&t.aggregatedStats.lowFramerate<n.framerate?t.aggregatedStats.lowFramerate:n.framerate,n.highFramerate=t.aggregatedStats.highFramerate&&t.aggregatedStats.highFramerate>n.framerate?t.aggregatedStats.highFramerate:n.framerate),t.aggregatedStats.framesDecodedStart&&(n.avgframerate=(n.framesDecoded-t.aggregatedStats.framesDecodedStart)/((n.timestamp-t.aggregatedStats.timestampStart)/1e3),n.avgframerate=Math.floor(n.avgframerate)))),"track"!=e.type||"video_label"!=e.trackIdentifier&&"video"!=e.kind||(n.framesDropped=e.framesDropped,n.framesReceived=e.framesReceived,n.framesDroppedPercentage=e.framesDropped/e.framesReceived*100,n.frameHeight=e.frameHeight,n.frameWidth=e.frameWidth,n.frameHeightStart=t.aggregatedStats&&t.aggregatedStats.frameHeightStart?t.aggregatedStats.frameHeightStart:e.frameHeight,n.frameWidthStart=t.aggregatedStats&&t.aggregatedStats.frameWidthStart?t.aggregatedStats.frameWidthStart:e.frameWidth),"candidate-pair"==e.type&&e.hasOwnProperty("currentRoundTripTime")&&0!=e.currentRoundTripTime&&(n.currentRoundTripTime=e.currentRoundTripTime)})),t.aggregatedStats.receiveToCompositeMs&&(n.receiveToCompositeMs=t.aggregatedStats.receiveToCompositeMs,t.latencyTestTimings.SetFrameDisplayDeltaTime(t.aggregatedStats.receiveToCompositeMs)),t.aggregatedStats=n,t.onAggregatedStats&&t.onAggregatedStats(n)}},setupTransceiversAsyncX=async function(e){e.addTransceiver("video",{direction:"recvonly"}),uo||e.addTransceiver("audio",{direction:"recvonly"})},setupTracksToSendAsync=async function(e){if(e.addTransceiver("video",{direction:"recvonly"}),uo){let n=!!uo&&{autoGainControl:!1,channelCount:1,echoCancellation:!1,latency:0,noiseSuppression:!1,sampleRate:16e3,volume:1};var t=void 0;try{t=await navigator.mediaDevices.getUserMedia({video:!1,audio:n})}catch(e){console.error(e.message),Nt(e.message,{color:"red"}),Nt("More deatils: https://eagle3dstreaming.atlassian.net/wiki/spaces/docs/pages/172818439/Microphone+access+to+the+user+s+device",{color:"blue"}),"NotAllowedError"===e.name?(console.error("Microphone Permission denied: ",e.message),Nt("Microphone Permission denied",{color:"red"})):console.error("Error accessing media devices: ",e.message)}if(t)for(const n of t.getTracks())n.kind&&"audio"==n.kind&&e.addTransceiver(n,{direction:"sendrecv"});else e.addTransceiver("audio",{direction:"recvonly"})}else e.addTransceiver("audio",{direction:"recvonly"})},this.startLatencyTest=function(e){t.video&&(t.latencyTestTimings.Reset(),t.latencyTestTimings.TestStartTimeMs=Date.now(),e(t.latencyTestTimings.TestStartTimeMs))},this.handleCandidateFromServer=function(e){if(t.pcClient.remoteDescription){yo.push(e);let n=new RTCIceCandidate(e);t.pcClient.addIceCandidate(n).then((e=>{console.log("remote ICE candidate successfully added")})),t.pcClient.addIceCandidate(e).catch((e=>{console.error("Error adding remote candidate:",e)}))}else setTimeout((()=>{console.warn("remoteDescription not set. so  will try again in0.1 sec"),Pn.handleCandidateFromServer(e)}),100)},this.createOffer=function(){if(ge("createOfferCalledAt",fe()),t.pcClient&&(t.pcClient.close(),t.pcClient=null),console.log("window.RTCPeerConnection:"+window.RTCPeerConnection),null==window.RTCPeerConnection)return ot("window.RTCPeerConnection undefined"),void(navigator.userAgent.includes("Firefox")?window.location="/assets/pages/RTCPeerConnectionDisabled.htm":window.location="/assets/pages/webRtcBlocked.htm");ge("newRTCPeerConnectionCalledAt",fe()),t.pcClient=new RTCPeerConnection(t.cfg),ge("newRTCPeerConnectionCalledPassedAt",fe()),t.useMic=uo,setupTracksToSendAsync(t.pcClient).finally((function(){setupPeerConnection(t.pcClient),t.dcClient=createDataChannel(t.pcClient,"cirrus",t.dataChannelOptions),handleCreateOffer(t.pcClient)}))},setupTransceiversAsync=async function(e){let t=e.getTransceivers().length>0;if(e.addTransceiver("video",{direction:"recvonly"}),uo){let o=!!uo&&{autoGainControl:!1,channelCount:1,echoCancellation:!1,latency:0,noiseSuppression:!1,sampleRate:48e3,sampleSize:16,volume:1};var n=void 0;try{n=await navigator.mediaDevices.getUserMedia({video:!1,audio:o})}catch(e){console.error("Error: "+e.message),e3ds_alert("Please grant permission to access the microphone.",{color:"Blue"}),e3ds_alert(e.message,{color:"Red"}),e3ds_alert("Read more here:",{color:"Blue"}),e3ds_alert("https://eagle3dstreaming.atlassian.net/wiki/spaces/docs/pages/172818439/Microphone+access+to+the+user+s+device",{color:"Blue"})}if(n)if(t){for(let t of e.getTransceivers())if(t&&t.receiver&&t.receiver.track&&"audio"===t.receiver.track.kind)for(const e of n.getTracks())e.kind&&"audio"==e.kind&&(t.sender.replaceTrack(e),t.direction="sendrecv")}else for(const t of n.getTracks())t.kind&&"audio"==t.kind&&e.addTransceiver(t,{direction:"sendrecv"});else e.addTransceiver("audio",{direction:"recvonly"})}else e.addTransceiver("audio",{direction:"recvonly"})},this.receiveOffer111=function(e){ge("receivedOfferAt",fe()),console.error("AHSAN. receiveOffer() recoived an unhandled offer :",e),e.sfu&&(this.sfu=!0,delete e.sfu),t.pcClient||(console.log("Creating a new PeerConnection in the browser."),t.pcClient=new RTCPeerConnection(t.cfg),setupPeerConnection(t.pcClient)),t.pcClient.setRemoteDescription(e).then((()=>{setupTransceiversAsync(t.pcClient).finally((function(){t.pcClient.createAnswer().then((e=>(mungeSDP(e),t.pcClient.setLocalDescription(e)))).then((()=>{if(xn&&xn.readyState===Mn){let e=JSON.stringify(t.pcClient.currentLocalDescription);console.log("->arvind SS: SendAnswer"),xn.send(e)}})).then((()=>{let e=t.pcClient.getReceivers();for(let t of e)t.playoutDelayHint=0})).catch((e=>console.error("createAnswer() failed:",e)))}))}))},this.receiveAnswer=function(e){ge("playerReceivedAnswerAt",fe());var n=new RTCSessionDescription(e);!async function(e,t){ge("setRemoteDescriptionCalledAt",fe()),await e.pcClient.setRemoteDescription(t).then((function(){setTimeout((function(){}),5e3)})).catch((function(e){e?Ze("setRemoteDescription:"+e):(Nt("setRemoteDescription: reloading to test",{color:"Red"}),setTimeout((function(){location.reload()}),5e3))}))}(t,n)},this.close=function(){t.pcClient&&(t.pcClient.close(),t.pcClient=null),t.aggregateStatsIntervalId&&clearInterval(t.aggregateStatsIntervalId)},this.send=function(e){if(t.dcClient&&"open"==t.dcClient.readyState)try{t.dcClient.send(e)}catch(e){console.error(e.message),Nt(e.message,{color:"red"}),Nt("More deatils: https://eagle3dstreaming.atlassian.net/wiki/x/CICPIQ",{color:"blue"}),TypeError}},this.getStats=function(e){t.pcClient&&e&&t.pcClient.getStats(null).then((t=>{e(t)}))},this.aggregateStats=function(e){let n=generateAggregatedStatsFunction();t.aggregateStatsIntervalId=setInterval((()=>{t.getStats(n)}),e)}}async function Ao(e,t){try{const n=await e.getStats();let o=null;return n.forEach((e=>{"transport"===e.type&&e.id===t.id&&e.selectedCandidatePairId?o=n.get(e.selectedCandidatePairId):"candidate-pair"===e.type&&"succeeded"===e.state&&e.transportId===t.id&&(o=e)})),o}catch(e){return console.error("Error retrieving selected candidate pair:",e),null}}async function Oo(){var e=Pn.pcClient;const t=[];if(e)for(const n of e.getSenders())if(n.track){const o=n.track.kind;if(n.transport&&n.transport.iceTransport){let i;const r=n.transport.iceTransport;i="function"==typeof r.getSelectedCandidatePair?r.getSelectedCandidatePair():await Ao(e,n.transport),i&&t.push({type:"sending",media:o,localCandidate:i.local,remoteCandidate:i.remote})}}if(e)for(const n of e.getReceivers())if(n.track){const o=n.track.kind;if(n.transport&&n.transport.iceTransport){let i;const r=n.transport.iceTransport;i="function"==typeof r.getSelectedCandidatePair?r.getSelectedCandidatePair():await Ao(e,n.transport),i&&t.push({type:"receiving",media:o,localCandidate:i.local,remoteCandidate:i.remote})}}var n="";const o={usingTurnServer:!1};t.forEach(((e,t)=>{console.log(`Candidate Pair ${t+1} (${e.media} - ${e.type}):`),console.log("Local Candidate:",e.localCandidate),console.log("Remote Candidate:",e.remoteCandidate),console.log("-----------------------------------");const i=e.localCandidate,r=e.remoteCandidate;var a;a="xirsys.com",i.url&&i.url.includes(a)&&(n+=`${a} used in FE: ${i.url} for ${e.media} ${e.type}. `),r.url&&r.url.includes(a)&&(n+=`, ${a} used in Streamer: ${r.url} for media: ${e.media} ${e.type}. `),"relay"===i.type&&(o.usingTurnServer=!0,o.browserTurnServerUrl=i.url),"relay"===r.type&&(o.usingTurnServer=!0,o.streamerTurnServerUrl=r.url)})),be=o,""!==n&&ot(n)}var Mo=1;function Do(e){capBpsCmd="Encoder.MaxBitrate "+e;let t={Console:capBpsCmd};b(t),console.log(t)}function Ro(e){capFpsCmd="t.maxFPS "+e;let t={Console:capFpsCmd};b(t),console.log(t)}function Lo(e){var t=document.getElementById("player")||document.getElementById("videoElementParent");vn=document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement&&null!==document.msFullscreenElement||document.fullscreenElement&&null!==document.fullscreenElement||t&&t.classList.contains("fullscreen");let n=document.getElementById("fullscreen-img");n&&(n.src=vn?"assets/images/MinimiseToFullscreen.png":"assets/images/MaximiseToFullscreen.png",n.alt=vn?"Shrink to normal size":"Maximise to Fullscreen")}function Uo(){vn?Fo():No()}function No(){/iPad|iPhone|iPod/.test(navigator.userAgent)&&window.MSStream;var e=document.getElementById("player")||document.getElementById("videoElementParent"),t=document.getElementsByClassName("text"),n=document.getElementById("header-tbl"),o=e.requestFullscreen;if(o||["mozRequestFullScreen","msRequestFullscreen","webkitRequestFullScreen"].forEach((function(t){o=o||e[t]})),o)o.call(e).catch((function(e){Nt("Switching to Full Screen rejected due to no first interact from user"),console.error("Fullscreen request failed:",e)}));else{if(e&&(e.classList.add("fullscreen"),e.classList.remove("fixed-size")),t)for(let e=0;e<t.length;e++)t[e].style.display="none";n&&(n.style.display="none"),Lo(),_o()}}function Fo(){var e=document.getElementById("player")||document.getElementById("videoElementParent"),t=document.getElementsByClassName("text"),n=document.getElementById("header-tbl"),o=document.exitFullscreen;if(o||["mozCancelFullScreen","msExitFullscreen","webkitExitFullscreen"].forEach((function(e){o=o||document[e]})),o)o.call(document);else{if(e&&(e.classList.remove("fullscreen"),e.classList.add("fixed-size"),e.style.left=""),t)for(let e=0;e<t.length;e++)t[e].style.display="block";n&&(n.style.display="table"),Lo(),_o()}}function _o(){var e=document.getElementById("player")||document.getElementById("videoElementParent");let t=e.getElementsByTagName("VIDEO");if(document.documentElement.style.position=vn?"fixed":"",document.body.style.position=vn?"fixed":"",vn){let n=window.innerHeight/window.innerWidth,o=e.clientHeight/e.clientWidth,i=t.videoHeight/t.videoWidth;isNaN(i)?(O=window.innerWidth,M=window.innerHeight,D=0,R=Math.floor(.5*(window.innerWidth-O)),e.style.width=O+"px",e.style.height=M+"px"):n<o?(O=Math.floor(window.innerHeight/i),M=window.innerHeight,D=0,R=Math.floor(.5*(window.innerWidth-O)),e.style.width=O+"px",e.style.height=M+"px"):(O=window.innerWidth,M=Math.floor(window.innerWidth*i),D=Math.floor(.5*(window.innerHeight-M)),R=0,e.style.width=O+"px",e.style.height=M+"px")}else e.style.height="",e.style.width=""}function $o(e){try{const t=new URL(e);return`${t.protocol}//${t.hostname}`}catch(e){return console.error("Invalid URL:",e),null}}function Jo(e){try{return new URL(e).pathname.split("/")[2]}catch(e){return console.error("Invalid URL:",e),null}}function qo(e,t,n){var o=document.getElementById(e);o&&(o.onclick=function(o){console.log("-> "+e),v(t,n)})}function Wo(){console.log("*****captureScreenShot method invoked*****");var e=window.innerWidth,t=window.innerHeight,n=(new Date).getTime(),o=document.getElementById("canvas"),i=o.getContext("2d");o.width=e,o.height=t;var r=document.getElementById("streamingVideo");i.drawImage(r,0,0,e,t);var a=o.toDataURL("image/png").replace("image/png","image/octet-stream"),s=document.createElement("a");s.setAttribute("download",n+"_screenshot.png"),s.setAttribute("href",a),s.click()}function Vo(e){console.log("setQP val: "+e),I({ConsoleCommand:"PixelStreaming.Encoder.MinQP 0"}),I({ConsoleCommand:"PixelStreaming.Encoder.MaxQP "+e}),window?.pixelStreaming?.emitConsoleCommand(`PixelStreaming.Encoder.MinQP ${e}`),window?.pixelStreaming?.emitConsoleCommand(`PixelStreaming.Encoder.MaxQP ${e}`)}window.dispatchKickEvent=function(e,t){const n=$o(Ue),o=Jo(e);null!=o&&fetch(`${n}/API/${Fe}/${o}/KickPlayersForCS?csPlayerId=${t}`).then((e=>e.json())).then((e=>{console.log(e)}))},window.dispatchMicMuteEvent=function(e,t){const n=$o(Ue),o=Jo(e);null!=o&&fetch(`${n}:${o}/API/${Fe}/mutePlayer?csPlayerId=${t}`).then((e=>e.text())).then((e=>{console.log(e)}))},window.dispatchToggleControl=function(e,t){null!=xn&&("on"===e?xn.send(JSON.stringify({type:"GiveControlToThisGuest",GiveControlToThisGuestID:t})):xn.send(JSON.stringify({type:"DisableControlForThisGuest",guestId:t}))),"function"==typeof window?.pixelStreaming?.webSocketController?.webSocket?.send&&("on"===e?pixelStreaming.webSocketController.webSocket.send(JSON.stringify({type:"GiveControlToThisGuest",GiveControlToThisGuestID:t})):pixelStreaming.webSocketController.webSocket.send(JSON.stringify({type:"DisableControlForThisGuest",guestId:t})))};const Go={LockedMouse:0,HoveringMouse:1};var jo={controlScheme:Go.HoveringMouse,suppressBrowserKeys:!0,fakeMouseWithTouches:!1};function Ho(e,t,n,o){if(tn)return;On&&(console.log(`x: ${e}, y:${t}, dX: ${n}, dY: ${o}`),document.getElementById("skip_video").style.display="block",document.getElementById("skip_video").innerHTML=`x: ${e}, y:${t}, dX: ${n}, dY: ${o}`);let i=Hn(e,t),r=zn(n,o);var a=new DataView(new ArrayBuffer(9));a.setUint8(0,w.MouseMove),a.setUint16(1,i.x,!0),a.setUint16(3,i.y,!0),a.setInt16(5,r.x,!0),a.setInt16(7,r.y,!0),P(a.buffer)}var zo=!1;function Qo(e,t,n){On&&console.log(`mouse button ${e} down at (${t}, ${n})`);let o=Hn(t,n),i=new DataView(new ArrayBuffer(6));i.setUint8(0,w.MouseDown),i.setUint8(1,e),i.setUint16(2,o.x,!0),i.setUint16(4,o.y,!0),P(i.buffer)}function Xo(e,t,n){if(tn)return;if(On&&console.log(`mouse button ${e} up at (${t}, ${n})`),("Mac"!=_n.os.name||2!=e||zo)&&"Mac"==_n.os.name&&2==e&&zo)return;let o=Hn(t,n);var i=new DataView(new ArrayBuffer(6));i.setUint8(0,w.MouseUp),i.setUint8(1,e),i.setUint16(2,o.x,!0),i.setUint16(4,o.y,!0),P(i.buffer)}function Ko(e,t,n){if(tn)return;On&&console.log(`mouse wheel with delta ${e} at (${t}, ${n})`);let o=Hn(t,n);var i=new DataView(new ArrayBuffer(7));i.setUint8(0,w.MouseWheel),i.setInt16(1,e,!0),i.setUint16(3,o.x,!0),i.setUint16(5,o.y,!0),P(i.buffer)}const Yo={MainButton:0,AuxiliaryButton:1,SecondaryButton:2,FourthButton:3,FifthButton:4},Zo={PrimaryButton:1,SecondaryButton:2,AuxiliaryButton:4,FourthButton:8,FifthButton:16};function ei(e,t,n){e&Zo.PrimaryButton&&Xo(Yo.MainButton,t,n),e&Zo.SecondaryButton&&Xo(Yo.SecondaryButton,t,n),e&Zo.AuxiliaryButton&&Xo(Yo.AuxiliaryButton,t,n),e&Zo.FourthButton&&Xo(Yo.FourthButton,t,n),e&Zo.FifthButton&&Xo(Yo.FifthButton,t,n)}function ti(e,t,n){e&Zo.PrimaryButton&&Qo(Yo.MainButton,t,n),e&Zo.SecondaryButton&&Qo(Yo.SecondaryButton,t,n),e&Zo.AuxiliaryButton&&Qo(Yo.AuxiliaryButton,t,n),e&Zo.FourthButton&&Qo(Yo.FourthButton,t,n),e&Zo.FifthButton&&Qo(Yo.FifthButton,t,n)}let ni=!0;function oi(e){var t=e.width/2,n=e.height/2;function o(){document.pointerLockElement===e||document.mozPointerLockElement===e?(console.log("Pointer locked"),document.addEventListener("mousemove",i,!1)):(console.log("The pointer lock status is now unlocked"),document.removeEventListener("mousemove",i,!1),ni=!1)}function i(e){t+=e.movementX,n+=e.movementY,t>O&&(t-=O),n>M&&(n-=M),t<0&&(t=O+t),n<0&&(n=M-n),Ho(t,n,e.movementX,e.movementY)}e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock,e.onclick=async function(){try{await e.requestPointerLock(),ni=!0}catch(e){Ze("requestPointerLock() failed: "+JSON.stringify(_n)),Nt("requestPointerLock() is not supported in your browser. Please try updating or using a different browser.")}},document.addEventListener("pointerlockchange",o,!1),document.addEventListener("mozpointerlockchange",o,!1),e.onmousedown=function(e){d(),Qo(e.button,t,n)},e.onmouseup=function(e){d(),Xo(e.button,t,n)},e.onwheel=function(e){d(),Ko(e.wheelDelta,t,n)},e.pressMouseButtons=function(e){ti(e.buttons,t,n)},e.releaseMouseButtons=function(e){ei(e.buttons,t,n)}}var ii,ri=void 0;function ai(e){if(null==Gt)return clearTimeout(ri),void(ri=setTimeout((function(){console.log("registerTouchEvents---\x3e ue4ExeInfo == undefined"),ai(e)}),1e3));console.log("ue4ExeInfo.versionString: "+Gt.versionString),null==Gt.versionString||"4.27.1.0"==Gt.versionString||"4.27.2.0"==Gt.versionString||Gt.versionString.startsWith("5.")?function(e){let t=[9,8,7,6,5,4,3,2,1,0],n={};function o(e){let o=t.pop();void 0===o&&console.log("exhausted touch indentifiers"),n[e.identifier]=o}function i(t,o){let i=new DataView(new ArrayBuffer(2+7*o.length));i.setUint8(0,t),i.setUint8(1,o.length);let r=2;for(let t=0;t<o.length;t++){let a=o[t],s=a.clientX-e.offsetLeft,l=a.clientY-e.offsetTop;On&&console.log(`F${n[a.identifier]}=(${s}, ${l})`);let c=Hn(s,l);i.setUint16(r,c.x,!0),r+=2,i.setUint16(r,c.y,!0),r+=2,i.setUint8(r,n[a.identifier],!0),r+=1,i.setUint8(r,255*a.force,!0),r+=1,i.setUint8(r,c.inRange?1:0,!0),r+=1}P(i.buffer)}if(jo.fakeMouseWithTouches){let t;e.ontouchstart=function(n){if(void 0===t){let o=n.changedTouches[0];t={id:o.identifier,x:o.clientX-jn.left,y:o.clientY-jn.top},e.onmouseenter(n),Qo(Yo.MainButton,t.x,t.y)}n.preventDefault()},e.ontouchend=function(n){for(let o=0;o<n.changedTouches.length;o++){let i=n.changedTouches[o];if(null!=t&&i.identifier===t.id){let o=i.clientX-jn.left,r=i.clientY-jn.top;Xo(Yo.MainButton,o,r),e.onmouseleave(n),t=void 0;break}}n.preventDefault()},e.ontouchmove=function(e){for(let n=0;n<e.touches.length;n++){let o=e.touches[n];if(null!=t&&o.identifier===t.id){let e=o.clientX-jn.left,n=o.clientY-jn.top;Ho(e,n,e-t.x,n-t.y),t.x=e,t.y=n;break}}e.preventDefault()}}else e.ontouchstart=function(e){for(let t=0;t<e.changedTouches.length;t++)o(e.changedTouches[t]);On&&console.log("touch start"),i(w.TouchStart,e.changedTouches),e.preventDefault()},e.ontouchend=function(e){On&&console.log("touch end"),i(w.TouchEnd,e.changedTouches);for(let i=0;i<e.changedTouches.length;i++)o=e.changedTouches[i],t.push(n[o.identifier]),delete n[o.identifier];var o;e.preventDefault()},e.ontouchmove=function(e){On&&console.log("touch move"),i(w.TouchMove,e.touches),e.preventDefault()}}(e):function(e){var t=[9,8,7,6,5,4,3,2,1,0],n={};function o(e){let o=t.pop();void 0===o&&console.log("exhausted touch indentifiers"),n[e.identifier]=o}function i(t,o){if(tn)return;let i=new DataView(new ArrayBuffer(2+6*o.length));i.setUint8(0,t),i.setUint8(1,o.length);let r=2;for(let t=0;t<o.length;t++){let a=o[t],s=a.clientX.clamp(1,e.clientWidth-5)-e.offsetLeft,l=a.clientY.clamp(1,e.clientHeight-5)-e.offsetTop;On&&console.log(`F${n[a.identifier]}=(${s}, ${l})`);let c=Hn(s,l);i.setUint16(r,c.x,!0),r+=2,i.setUint16(r,c.y,!0),r+=2,i.setUint8(r,n[a.identifier],!0),r+=1,i.setUint8(r,255*a.force,!0),r+=1}P(i.buffer)}if(jo.fakeMouseWithTouches){var r=void 0;e.ontouchstart=function(t){if(void 0===r){let n=t.changedTouches[0];r={id:n.identifier,x:n.clientX-jn.left,y:n.clientY-jn.top},e.onmouseenter(t),Qo(Yo.MainButton,r.x,r.y)}t.preventDefault()},e.ontouchend=function(t){d();for(let n=0;n<t.changedTouches.length;n++){let o=t.changedTouches[n];if(null!=r&&o.identifier===r.id){let n=o.clientX-jn.left,i=o.clientY-jn.top;Xo(Yo.MainButton,n,i),e.onmouseleave(t),r=void 0;break}}t.preventDefault()},e.ontouchmove=function(e){for(let t=0;t<e.touches.length;t++){let n=e.touches[t];if(null!=r&&n.identifier===r.id){let e=n.clientX-jn.left,t=n.clientY-jn.top;Ho(e,t,e-r.x,t-r.y),r.x=e,r.y=t;break}}e.preventDefault()}}else e.ontouchstart=function(e){for(let t=0;t<e.changedTouches.length;t++)o(e.changedTouches[t]);On&&console.log("touch start"),i(w.TouchStart,e.changedTouches),e.preventDefault(),clearInterval(Nn),clearTimeout(Fn),ee=!1,Nn=setInterval(Z,10),Fn=setTimeout((function(){clearInterval(Nn)}),1e3)},e.ontouchend=function(e){d(),On&&console.log("touch end"),i(w.TouchEnd,e.changedTouches);for(let i=0;i<e.changedTouches.length;i++)e.changedTouches[i],o=e.changedTouches[i],t.includes(n[o.identifier])||(t.push(n[o.identifier]),t.sort((function(e,t){return t-e}))),o.identifier in n&&delete n[o.identifier];var o;e.preventDefault()},e.ontouchmove=function(e){On&&console.log("touch move"),i(w.TouchMove,e.touches),e.preventDefault()}}(e)}function si(e){console.log("restartAnimationText---\x3e : "+e)}function li(){var e=Pn.video;if(e.paused)console.log("Status: Paused");else if(e.ended)console.log("Status: Stopped");else if(e.readyState>2)return void console.log("Status: Playing");requestAnimationFrame(li)}function ci(){so&&clearInterval(so);var e=document.getElementById("streamingVideo");if(e&&(e.style.backgroundColor="black"),Pn){Mo=2,F(),Pn.video.play().then((()=>{})).catch((e=>{li(),"The request is not allowed by the user agent or the platform in the current context, possibly because the user denied permission."!=e.message&&(console.log("xxxx Error.message : "+e.message),console.log("xxxx error.name : ",e.name),console.log("xxxx error.stack : ",e.stack),Mi(2),ui("clickableState",(e=>{ci()})))}));try{Pn.handleOnAudioTrack(Wt)}catch(e){console.log("Error in webRtcPlayerObj.handleOnAudioTrack(): "+e.message)}var t=document.getElementById("videoPlayOverlay");t&&(t.style.display="none"),document.getElementById("bottm_left_slider");var n=document.getElementById("settings");n&&(1==It.shouldDisplayContorlBar||null==It.shouldDisplayContorlBar?n.style.display="flex":n.style.display="none"),1==sn&&(document.getElementById("flow-meeting")&&(document.getElementById("flow-meeting").style.display="block"),document.getElementById("voipControlPanel")&&(document.getElementById("voipControlPanel").style.display="flex"),document.getElementById("e3ds_bottom_panelObj_left_bottom")&&(document.getElementById("e3ds_bottom_panelObj_left_bottom").style.display="block"));var o={type:"stage5_playBtnPressed"};z(),m(o),b(o),Di()}P(new Uint8Array([w.RequestInitialSettings]).buffer),y(),W(),Di();var i=document.getElementById("overlay");if(i){if(0!=rn("showPsControl")){let e=document.getElementById("overlayButton");i.style.display="block",e.style.display="block",i.style.display="block",document.getElementById("overlayPSSettings").style.display="block"}if(0!=rn("showWebrtcCtrlMenu")&&null!=rn("showWebrtcCtrlMenu")){let e=document.getElementById("overlayButton");i.style.display="block",e.style.display="block",i.style.display="block",document.getElementById("overlayWebrtcCtrlMenu").style.display="block"}}1==It.doAutoMovement&&(u=setInterval((()=>{const e=["W","S","D"],t=e[Math.floor(Math.random()*e.length)],n=new KeyboardEvent("keydown",{key:t,keyCode:t.charCodeAt(0),which:t.charCodeAt(0),code:`Key${t.toUpperCase()}`});P(new Uint8Array([w.KeyDown,a(n),n.repeat]).buffer),setTimeout((()=>{const e=new KeyboardEvent("keypress",{key:t,keyCode:t.charCodeAt(0),charCode:t.charCodeAt(0),which:t.charCodeAt(0),code:`Key${t.toUpperCase()}`});let n=new DataView(new ArrayBuffer(3));n.setUint8(0,w.KeyPress),n.setUint16(1,e.charCode,!0),P(n.buffer)}),2e3),setTimeout((()=>{const e=new KeyboardEvent("keyup",{key:t,keyCode:t.charCodeAt(0),charCode:t.charCodeAt(0),which:t.charCodeAt(0),code:`Key${t.toUpperCase()}`});P(new Uint8Array([w.KeyUp,a(e)]).buffer)}),100)}),200))}function di(){const e=document.getElementById("popupForinjectStreamFromEditorInfo");e&&(e.style.display="none"),1==bn?(ci(),1==It.isMilicastStreaming&&connectStream()):(Mi(2),ui("clickableState",(e=>{ge("playBtnClickedAt",fe()),ci(),1==It.isMilicastStreaming&&connectStream()})))}function ui(e,t){console.log("setOverlayCustom---\x3e 11111111111111111: "),Vn=!1;var n=document.getElementById("clickToPlay");if(!n){var o=document.getElementById("player");(n=document.createElement("div")).id="videoPlayOverlay",o.appendChild(n)}for(;n.lastChild;)n.removeChild(n.lastChild);var i=document.getElementById("playButton");if(!i){var r=document.createElement("img");r.id="playButton",r.src=null!=on?on:"https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/Play_button2.png",r.alt="!!!!!",r&&n.appendChild(r),i=r,je=!0}i.style.display="block";var a=document.getElementById("loaderStep2");a&&Xt&&(a.style.backgroundImage=`url("${Xt}")`),n.style.display="block",function(e,t="infinite"){setTimeout((function(){so=setInterval((function(){document.getElementById(e).classList.toggle("shake")}),1e4)}),1e4),"number"==typeof t&&document.documentElement.style.setProperty("--shake-iteration",""+2*t)}("playButton",10),m({type:"stage4_playBtnShowedUp"}),t&&n&&n.addEventListener("click",(function e(o){t(o),n.removeEventListener("click",e),document.getElementById("videoPlayOverlay")&&(n.style.display="none")})),n&&n.classList.add(e)}function gi(e){console.log("showTextOverlay---\x3e "+e),Nt(e,{timeout:2e3,color:"blue"});var t=document.createElement("div");t.id="messageOverlay",t.innerHTML=e||""}let mi=null,pi=null,fi=null,yi=[],vi=null,hi=null,wi=null,Si=null,bi=null;var Ii;async function Ei(){if(document.querySelector(".recorded-video-wrap").style.display="none",await async function(){try{mi=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0,preferCurrentTab:!0,systemAudio:"include"}),pi=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}})}catch(e){console.error("Error accessing display media or user media:",e)}}(),mi&&pi){const e=new MediaStream([...mi.getAudioTracks(),...pi.getAudioTracks()]);fi=new MediaStream([...mi.getVideoTracks(),...e.getTracks()]),vi=new MediaRecorder(fi),vi.ondataavailable=Ci,vi.onstop=Ti,vi.start(1e3),Ii&&(Ii.removeEventListener("click",Ei),Ii.addEventListener("click",ki)),console.log("Recording started"),document.getElementById("screenRecordImg").classList.add("blinkImg")}else console.warn("No stream available.")}function ki(){vi.stop(),Ii&&(Ii.removeEventListener("click",ki),Ii.addEventListener("click",Ei)),document.querySelector(".cancel-download").addEventListener("click",(function(){document.querySelector(".recorded-video-wrap").style.display="none"})),document.getElementById("screenRecordImg").classList.remove("blinkImg")}function Ci(e){yi.push(e.data)}function Ti(e){const t=new Blob(yi,{type:"video/mp4"});yi=[],Si.href=URL.createObjectURL(t),Si.download="video.mp4",Si.disabled=!1,bi.src=URL.createObjectURL(t),bi.load(),bi.onloadeddata=function(){const e=document.querySelector(".recorded-video-wrap");e.style.display="block",e.scrollIntoView({behavior:"smooth",block:"start"}),bi.play()},mi.getTracks().forEach((e=>e.stop())),pi.getTracks().forEach((e=>e.stop())),console.log("Recording stopped")}let Bi;window.addEventListener("load",(()=>{(Ii=document.getElementById("screenRecord"))&&(lo()?Ii.style.display="none":Ii.style.display="block",hi=document.querySelector(".start-recording"),wi=document.querySelector(".stop-recording"),Si=document.querySelector(".download-video"),bi=document.querySelector(".recorded-video"),Ii&&Ii.addEventListener("click",Ei))}));let xi=[],Pi=[];function Ai(){!function(){const e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[];for(let t=0;t<e.length;t++)e[t]&&e[t].index in xi&&(null!=_n&&_n.device.gamepads?.length!=Pi.length&&(_n.device.gamepads=Pi),xi[e[t].index].currentState=e[t])}(),Bi=requestAnimationFrame(Ai);for(let e=0;e<xi.length;e++){if(null==xi[e])continue;const t=xi[e].currentState;for(let t=0;t<xi[e].currentState.buttons.length;t++){const n=xi[e].currentState.buttons[t],o=xi[e].prevState.buttons[t];if(n.pressed)if(t==Oi.LeftTrigger){const t=new DataView(new ArrayBuffer(11));t.setUint8(0,w.GamepadAnalog),t.setUint8(1,e),t.setUint8(2,5),t.setFloat64(3,n.value,!0),P(t.buffer)}else if(t==Oi.RightTrigger){const t=new DataView(new ArrayBuffer(11));t.setUint8(0,w.GamepadAnalog),t.setUint8(1,e),t.setUint8(2,6),t.setFloat64(3,n.value,!0),P(t.buffer)}else P(new Uint8Array([w.GamepadButtonPressed,e,t,o.pressed?1:0]).buffer);else if(!n.pressed&&o.pressed)if(t==Oi.LeftTrigger){const t=new DataView(new ArrayBuffer(11));t.setUint8(0,w.GamepadAnalog),t.setUint8(1,e),t.setUint8(2,5),t.setFloat64(3,0,!0),P(t.buffer)}else if(t==Oi.RightTrigger){const t=new DataView(new ArrayBuffer(11));t.setUint8(0,w.GamepadAnalog),t.setUint8(1,e),t.setUint8(2,6),t.setFloat64(3,0,!0),P(t.buffer)}else P(new Uint8Array([w.GamepadButtonReleased,e,t,0]).buffer)}for(let n=0;n<t.axes.length;n+=2){const o=parseFloat(t.axes[n].toFixed(4)),i=-parseFloat(t.axes[n+1].toFixed(4)),r=new DataView(new ArrayBuffer(11));r.setUint8(0,w.GamepadAnalog),r.setUint8(1,e),r.setUint8(2,n+1),r.setFloat64(3,o,!0),P(r.buffer);const a=new DataView(new ArrayBuffer(11));a.setUint8(0,w.GamepadAnalog),a.setUint8(1,e),a.setUint8(2,n+2),a.setFloat64(3,i,!0),P(a.buffer)}xi[e].prevState=t}}window.addEventListener("gamepadconnected",(function(e){const t=e.gamepad;console.log(t.id+"connected");const n={currentState:t,prevState:t,id:void 0};xi.push(n),Pi.push(t.id),xi[xi.length-1].currentState=t,xi[xi.length-1].prevState=t,Ai()})),window.addEventListener("gamepaddisconnected",(function(e){console.log(e),cancelAnimationFrame(Bi),xi=[],Pi=[]}));const Oi={RightClusterBottomButton:0,RightClusterRightButton:1,RightClusterLeftButton:2,RightClusterTopButton:3,LeftShoulder:4,RightShoulder:5,LeftTrigger:6,RightTrigger:7,SelectOrBack:8,StartOrForward:9,LeftAnalogPress:10,RightAnalogPress:11,LeftClusterTopButton:12,LeftClusterBottomButton:13,LeftClusterLeftButton:14,LeftClusterRightButton:15,CentreButton:16,LeftStickHorizontal:0,LeftStickVertical:1,RightStickHorizontal:2,RightStickVertical:3};function Mi(e){console.log("showLoader: "+e),Di(),obj=document.getElementById("loaderStep"+e),obj?obj.style.display="flex":console.log("loaderStep"+e+" does not exist")}function Di(){var e=document.getElementById("loaderStep1");e?e.style.display="none":console.log("loaderStep1 does not exist"),(e=document.getElementById("loaderStep2"))?e.style.display="none":console.log("loaderStep2 does not exist"),(e=document.getElementById("loaderStep3"))?e.style.display="none":console.log("loaderStep3 does not exist")}var Ri,Li=void 0,Ui=void 0,Ni=0,Fi=!0;function _i(){let e=document.getElementById("player"),t=e.getElementsByTagName("video");if(e&&t.length>0){let n=e.clientHeight/e.clientWidth,o=t[0].videoHeight/t[0].videoWidth;if(n>o){On&&console.log("Setup Normalize and Quantize for playerAspectRatio > videoAspectRatio");let t=n/o;Hn=(n,o)=>{let i=n/e.clientWidth,r=t*(o/e.clientHeight-.5)+.5;return i<0||i>1||r<0||r>1?{inRange:!1,x:65535,y:65535}:{inRange:!0,x:65536*i,y:65536*r}},unquantizeAndDenormalizeUnsigned=(n,o)=>{let i=(o/65536-.5)/t+.5;return{x:n/65536*e.clientWidth,y:i*e.clientHeight}},zn=(n,o)=>({x:n/(.5*e.clientWidth)*32767,y:t*o/(.5*e.clientHeight)*32767})}else{On&&console.log("Setup Normalize and Quantize for playerAspectRatio <= videoAspectRatio");let t=o/n;Hn=(n,o)=>{let i=t*(n/e.clientWidth-.5)+.5,r=o/e.clientHeight;return i<0||i>1||r<0||r>1?{inRange:!1,x:65535,y:65535}:{inRange:!0,x:65536*i,y:65536*r}},unquantizeAndDenormalizeUnsigned=(n,o)=>{let i=o/65536;return{x:((n/65536-.5)/t+.5)*e.clientWidth,y:i*e.clientHeight}},zn=(n,o)=>({x:t*n/(.5*e.clientWidth)*32767,y:o/(.5*e.clientHeight)*32767})}}}var $i=void 0;function Ji(e){if(Fi){var t=document.getElementById("player");if(!t)return $i&&clearTimeout($i),void($i=setTimeout((function(){Ji()}),100));jn=t.getBoundingClientRect(),_i(),t.classList.contains("fixed-size")||(window.innerWidth<t.videoWidth||(window.innerHeight,t.videoHeight),function(e){let t=e.getElementsByTagName("VIDEO"),n=window.innerHeight/window.innerWidth,o=e.clientHeight/e.clientWidth,i=t.videoHeight/t.videoWidth;var r;isNaN(i)?(O=window.innerWidth,M=window.innerHeight,r="top: "+(D=0)+"px; left: "+(R=0)+"px; width: "+O+"px; height: "+M+"px; "+mn):n<o?(O=Math.floor(window.innerHeight/i),M=window.innerHeight,D=0,R=Math.floor(.5*(window.innerWidth-O)),r="top: "+D+"px; left: "+R+"px; width: "+O+"px; height: "+M+"px; cursor: "+styleCursor+"; "+mn):(O=window.innerWidth,M=Math.floor(window.innerWidth*i),r="top: "+(D=Math.floor(.5*(window.innerHeight-M)))+"px; left: "+(R=0)+"px; width: "+O+"px; height: "+M+"px; cursor: "+styleCursor+"; "+mn),function(e,t){null!=un?document.getElementById("videoPlayOverlay").style=`${t};background-image: url("${un}");`:e.style=t}(e,r)}(t))}}function qi(){if(document.getElementById("voipUserName")&&dn&&dn.city){var e="player";dn&&dn.city&&(e=dn.city),document.getElementById("voipUserName").value=e+"_"+tr(3333)}}function Wi(e,t){return Math.floor(Math.random()*(t-e))+e}function Vi(e){var t=document.getElementById("streamingVideo"),n=_t[e];console.log("videoPlay() :",e,n),t.setAttribute("src",n),t.setAttribute("type","video/mp4"),t.autoplay=!0,Ut(t,!0),t.load();var o=document.getElementById("videoPlayOverlay");o&&(o.style.display="none")}Ji();var Gi=0;function ji(e){var t=document.getElementById("loadingVideoElement");if(t){var n=_t[e];console.log("videoPlay() :",e,n),t.setAttribute("src",n),t.setAttribute("type","video/mp4"),Ut(t,!0),t.load();var o=document.getElementById("videoPlayOverlay");o&&(o.style.display="none")}}function Hi(e){console.log("showPageWIthMsg: "+e),self.location="/error/"+btoa(e).toString("base64")}function zi(){null!=dn&&null!=It&&null!=It.EmulatedGeoLocationInfo&&""!=It.EmulatedGeoLocationInfo.longitude&&""!=It.EmulatedGeoLocationInfo.latitude&&(dn.latitude=It.EmulatedGeoLocationInfo.latitude,dn.longitude=It.EmulatedGeoLocationInfo.longitude,dn.city="emulated_"+dn.city,dn.country_name="emulated_"+dn.country_name)}var Qi=!1;function Xi(e){if(!Qi){Qi=!0,null==It&&null!=e.appconfig&&(It=e.appconfig),function(){var e=rn("loadingVideoList");if(null!=e&&(_t=e),""!=(s=rn("BGI"))&&(_t.length>0||(Xt=s,F())),""!=(s=rn("BGI4Queue"))&&(_t.length>0||(un=s,Ji())),""!=(s=rn("Logo"))&&null!=s&&"undefined"!=s)if(_t.length>0);else{if(null!=(Qt=s)){var t=document.getElementById("prgoressScreenLogo1img"),n=document.getElementById("playBtnScreenLogo1img");t.src=Qt,n.src=Qt,t&&(t.style.display="block"),n&&(n.style.display="block")}var o=document.getElementById("prgoressScreenLogo1");null!=o&&(o.style.display="block")}""!=(s=rn("PlayBtn"))&&(on=s);let i=rn("TitleBarIcon");if(""!=i&&null!=i||(i="/assets/images/0.png"),""!=i&&null!=i){var r=document.createElement("link"),a=document.getElementById("TitleBarIcon");r.id="TitleBarIcon",r.rel="shortcut icon",r.href=i,a&&document.head.removeChild(a),document.head.appendChild(r)}var s;if(""!=(s=rn("LoadingImg"))&&null!=s)if(_t.length>0);else{var l=s,c=document.querySelectorAll("[id='prgoressScreenLoadingimg']");if(c.length>0)for(let e=0;e<c.length;e++)c[e].src=l,c[e].style.display="block"}}(),"0"===It.enableDraggableSettingsBtn||void 0===It.enableDraggableSettingsBtn?window.enableDraggableSettingsBtn="0":"1"===It.enableDraggableSettingsBtn&&(window.enableDraggableSettingsBtn="1");try{"darkTheme"===It.StreamingUiTheme?sessionStorage.setItem("StreamingUiTheme","darkTheme"):sessionStorage.setItem("StreamingUiTheme","whiteTheme")}catch(e){console.error(e)}if(null!=It.closeTabOnLosingVisbility&&1==It.closeTabOnLosingVisbility&&document.addEventListener("visibilitychange",(function(){console.log(document.visibilityState),"hidden"===document.visibilityState&&(console.log("XZZZZZZ Page minimized"),console.log("XZZZZZZ 11  window.close() cmd getting called;"),pt())})),We=It.mustLogin,uo=null!=It.UseMicrophone&&1==It.UseMicrophone,null==It.shouldMergeXirsysTurnServer||It.shouldMergeXirsysTurnServer,null==It.shouldMainatainUeWindowMode||It.shouldMainatainUeWindowMode,1==It.shouldBroswerInitiateOffer?Oe=!0:0==It.shouldBroswerInitiateOffer?Oe=!1:null==It.shouldBroswerInitiateOffer&&(Oe=!0),null!=It.urlExpiretime){if(new Date>new Date(It.urlExpiretime))return void Hi("Url Expired");if("undefined"!=typeof e3ds_controller&&null!=e3ds_controller.configurationToOverride){var n=e3ds_controller.configurationToOverride;console.log(" found e3ds_controller.configurationToOverride:"+JSON.stringify(n));const e=Object.keys(n);for(let t=0;t<e.length;t++){const i=e[t],r=n[i];var o=It[i];It[i]=r,console.log("newValue --\x3e "+r),console.log("updateAppConfig --\x3e "+i+" , "+o+" , "+It[i])}}"function"==typeof onConfigAcquire&&onConfigAcquire(),e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onConfigAcquire&&e3ds_controller.callbacks.onConfigAcquire()}var i,r;Qn(),It.serverOwner=Fe,It.appName=Zt,It.hostMeetingId=Kt,It.GuestMeetingId=Yt,function(){if(ye){var e=ye;for(var[t,n]of e.entries()){var o=!1;for(const[e,i]of Object.entries(It))if(e==t){o=!0,n!=i&&("cmdLineArgs"!=e&&"exeLunchArgs"!=e||1==It.shouldAppendOveridingcmdLineArgs&&(console.log("cmdLineArgs/exeLunchArgs  urlParams:   "+n),console.log("cmdLineArgs/exeLunchArgs  configurationObj:   "+i),n=i+" "+n,console.log("cmdLineArgs/exeLunchArgs  new:   "+n)),1==It.shouldAppendOveridingcmdLineArgs&&(console.log("overiridng config value. Old value   "+t+" :"+n),console.log(`new value ${e}: ${i}`)),It[e]=n);break}o||"reloadOnSuccessfulStreaming"!=t||(It.reloadOnSuccessfulStreaming=n)}}if(null!=(a=rn("isAdminDebugging"))&&(Le=a),zt(Le),1==Le){console.log("url: "+At),console.log("urlVersion: "+Ot),console.log("href_emulated: "+Ue),console.log("pathname: "+Mt),console.log("urlParams: ",ye),console.log(" 1111111111111 isAdminDebugging > "+Le),console.log(Rt),console.log("accessedTopLevelDomainName: "+Lt),function(){for(var e=performance.getEntriesByType("navigation"),t=0;t<e.length;t++){var n=e[t];switch(console.log("Page loading type = "+n.type),n.type,n.type){case"navigate":console.log("Navigation started by clicking a link, entering the URL in the browser's address bar, form submission, or initializing through a script operation other than reload and back_forward as listed below.");break;case"reload":console.log(" Navigation is through the browser's reload operation or location.reload()");break;case"back_forward":console.log("Navigation is through the browser's history traversal operation");break;case"prerender":console.log(" Navigation is initiated by a prerender hint");break;default:console.log("p.type: unknown")}}}(),console.log("navigator.userAgent: "+navigator.userAgent),console.log("isIniFrame() : "+Qn());var i=document.referrer;console.log("referrer:"+i),console.log("XXXXX configurationObj : "+JSON.stringify(It))}null!=(a=rn("showbrowserMouse"))&&(ln=a),console.log(" 1111111111111 showbrowserMouse > "+ln),G.enabled=It.isAfkEnabled,G.warnTimeout=60*It.afkWarnTimeout,G.closeTimeout=60*It.afkCloseTimeout;var r=document.getElementById("screenshot-img");r&&(1!=It.enableScreenshot||co()?(0==It.enableScreenshot||co())&&(r.style.display="none"):r.style.display="block");var a,s=document.getElementById("forcePsVrModeBtn");if(s&&(1==It.forcePsVrMode?s.style.display="block":0==It.forcePsVrMode&&(s.style.display="none")),sn=rn("useVOIP"),console.log(" 1111111111111 useVOIP > "+sn),1==sn){if(co()){if("function"!=typeof document.createElement("audio").setSinkId)return console.log("this ios setSinkId is not supported"),e3ds_alert("This IOS dont support setSinkId().Disabling VOIP ",{color:"Red"}),void(sn=0);console.log("this ios  setSinkId is supported"),Ze("setSinkId is supported ")}var l=rn("voipRoomName");""!=l&&null!=l?(document.getElementById("room_number")&&(document.getElementById("room_number").value=Fe+":"+l),navigator.permissions||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&window.e3ds_alert("IOS browsers might not support Eagle VoIP system",{timeout:5e3}),!document.getElementById("popupForVoipUsername")||Yt||null!=It.passwordToStart&&""!=It.passwordToStart||(document.getElementById("popupForVoipUsername").style.display="flex",document.getElementById("voipUserName").select())):(sn=0,window.e3ds_alert("No Room Name found in Voip config. So VOIP Disabled"))}else if(Kt){const e=document.getElementById("meetingControlPanel");e&&(e.style.display="flex");const t=document.getElementById("meetingGuestListDiv"),n=document.getElementById("meetingListBtn");n&&(n.onclick=function(){t&&("none"===t.style.display?t.style.display="block":t.style.display="none")})}if(null!=(a=rn("useExtendedTyping"))&&(an=a),console.log(" 1111111111111 useExtendedTyping > "+an),ln=rn("showbrowserMouse"),Tn(),null!=(a=rn("isSpectator"))&&(tn=a),null!=rn("GuestMeetingId")&&(tn=!0),console.log(" 1111111111111 isSpectator > "+tn),null!=(a=rn("forceMeetingMode"))&&(nn=a),2==nn?tn=!0:1==nn&&(tn=!1),console.log(" 1111111111111 forceMeetingMode > "+nn),console.log(" 2222222 forceMeetingMode--\x3e isSpectator > "+tn),Cn=rn("MouseControlScheme"),console.log(" ***************1111111111111 MouseControlScheme:"+Cn),null!=Cn)switch(!0){case 0==Cn:jo.controlScheme=Go.LockedMouse;break;case 1==Cn:jo.controlScheme=Go.HoveringMouse;break;default:console.log(" ***************2222222222 nada:"+Cn)}if(console.log(" ***************1111111111111 inputOptions.controlScheme:"+jo.controlScheme),null!=(a=rn("ShouldAutoPlay"))&&(bn=a),1==It.reloadOnSuccessfulStreaming&&(bn=1),"undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),1==bn||_t.length>0?Sn=!0:0==bn&&(Sn=!1),Qn(),console.log(" 1111111111111 ShouldAutoPlay > "+bn),console.log(" 1111111111111 flag4unMuteAudio4AutoPlay > "+Sn),null!=(a=rn("fakeMouseWithTouches"))&&(In=a),console.log(" 1111111111111 fakeMouseWithTouches > "+In),null!=(a=rn("suppressBrowserKeys"))&&(En=a),console.log(" 1111111111111 suppressBrowserKeys > "+En),0==In?jo.fakeMouseWithTouches=!1:1==In&&(jo.fakeMouseWithTouches=!0),0==En?jo.suppressBrowserKeys=!1:1==En&&(jo.suppressBrowserKeys=!0),a=rn("expireOn"),console.log(" 1111111111111 expireOn > "+kn),a&&a.endsWith("minutes")){a=a.split("minutes")[0];var c=parseFloat(a);Number.isNaN(c)||(kn=60*c*1e3)}else c=parseFloat(a),Number.isNaN(c)||(kn=c);console.log(" 222222222 expireOn > "+kn),K()}(),zi(),window.addEventListener("resize",Ji,!0),console.log("5555555555555555555  load()"),Ji(),function(){document.addEventListener&&(document.addEventListener("webkitfullscreenchange",Lo,!1),document.addEventListener("mozfullscreenchange",Lo,!1),document.addEventListener("fullscreenchange",Lo,!1),document.addEventListener("MSFullscreenChange",Lo,!1)),window.addEventListener("resize",N,!0),window.addEventListener("orientationchange",t),console.log("5555555555555555555  load()"),window.addEventListener("message",k,!1),m({type:"readyToReceiveMessage"}),F(),null!==(Dn=document.getElementById("quality-control-ownership-tgl"))&&(Dn.onchange=function(e){y(),"function"==typeof window?.pixelStreaming?._webRtcController?.sendRequestQualityControlOwnership&&pixelStreaming._webRtcController.sendRequestQualityControlOwnership()});let e=document.getElementById("overlayButton");null!==e&&(e.onclick=function(e){!function(){if(1==rn("showPsControl")){let e=document.getElementById("overlayPSSettings");"none"===e.style.display||""===e.style.display?e.style.display="block":"block"===e.style.display&&(e.style.display="none")}else document.getElementById("overlayPSSettings").style.display="none";if(1==rn("showWebrtcCtrlMenu")){let e=document.getElementById("overlayWebrtcCtrlMenu");"none"===e.style.display||""===e.style.display?e.style.display="block":"block"===e.style.display&&(e.style.display="none")}else document.getElementById("overlayWebrtcCtrlMenu").style.display="none"}()});let n=document.getElementById("ConsoleCmd_submit");null!==n&&(n.onclick=function(e){!function(){let e={ConsoleCommand:document.getElementById("ConsoleCmd_text").value};I(e),"function"==typeof window?.pixelStreaming?.emitCommand&&window.pixelStreaming.emitCommand(e)}()});let o=document.getElementById("closeVoipBtn");o&&(o.onclick=function(e){e.preventDefault(),document.getElementById("popupForVoipUsername").style.display="none"});let i=document.getElementById("sendRandomdataToUnrealFast_submit");null!==i&&(i.onclick=function(e){const t=new Uint8Array(262144);for(let e=0;e<100;e++)try{Pn?.send(t),"function"==typeof window?.pixelStreaming?._webRtcController?.sendMessageController?.dataChannelSender?.sendData&&window.pixelStreaming._webRtcController.sendMessageController.dataChannelSender.sendData(t),console.log(`Sent data chunk ${e+1}`)}catch(e){console.error("Error sending data:",e);break}});let r=document.getElementById("dataToSendToUnreal_submit");null!==r&&(r.onclick=function(e){!function(){let e={dataForUnreal:document.getElementById("dataToSendToUnreal_text").value};b(e),"function"==typeof window?.pixelStreaming?.emitUIInteraction&&window.pixelStreaming.emitUIInteraction(e)}()}),document.getElementById("randomMovementBtn")&&document.getElementById("randomMovementBtn").addEventListener("click",g),document.getElementById("stopRandomMovementBtn")&&document.getElementById("stopRandomMovementBtn").addEventListener("click",(()=>{clearInterval(u)}));let s=document.getElementById("btnPasswordSubmit");null!==s&&(s.onclick=function(e){e.preventDefault();var t={type:"verifyPass",pass:document.getElementById("PasswordToVerify").value,owner:Fe,configName:en};console.log("77777 ws4queue.send(): "+JSON.stringify(t)),me.send(JSON.stringify(t))});let c=document.getElementById("btnPasswordCanecl");null!==c&&(c.onclick=function(e){e.preventDefault(),window.location="/assets/pages/kickedOut.htm"});let d=document.getElementById("btnUserInputCanecl");null!==d&&(d.onclick=function(e){e.preventDefault();var t=document.getElementById("popupForOnScreenKeyboard");t&&(t.style.display="none",document.getElementById("UserInput").value="")});let p=document.getElementById("btnUserInputSubmit");function f(e){let t,n;if(parseInt(e)){parseInt(e)>=0&&parseInt(e)<=12?(n="ultra",qualityIcon&&(qualityIcon.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityUltra.svg")):parseInt(e)>=13&&parseInt(e)<=25?(n="high",qualityIcon&&(qualityIcon.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityHight.svg")):parseInt(e)>=26&&parseInt(e)<=38?(n="medium",qualityIcon&&(qualityIcon.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityMedium.svg")):parseInt(e)>=39&&parseInt(e)<=51&&(n="low",qualityIcon&&(qualityIcon.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityLow.svg"));const t=document.querySelectorAll("#qualityList li");for(let e of t)e.classList.contains("selectedQuality")&&e.classList.remove("selectedQuality");document.getElementById(n).classList.add("selectedQuality")}else if(!parseInt(e)){switch(e){case"low":t=51,qualityIcon&&(qualityIcon.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityLow.svg");break;case"medium":t=34,qualityIcon&&(qualityIcon.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityMedium.svg");break;case"high":t=17,qualityIcon&&(qualityIcon.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityHigh.svg");break;case"ultra":t=1,qualityIcon&&(qualityIcon.src="https://d35e1ftufisrhj.cloudfront.net/v1/assets/images/qualityUltra.svg")}const n=document.getElementById("resoulbar");n&&(n.value=t)}}null!==p&&(p.onclick=function(e){e.preventDefault();var t=document.getElementById("popupForOnScreenKeyboard");t&&(t.style.display="none",document.getElementById("UserInput").value="")});const E=document.getElementById("qualityList");E&&(E.onclick=function(e){if("LI"===e.target.tagName){const t=e.target.id;switch(t){case"low":Vo(40),f("low");break;case"medium":Vo(30),f("medium");break;case"high":Vo(20),f("high");break;case"ultra":Vo(10),f("ultra")}const n=document.querySelectorAll("#qualityList li");for(let e of n)e.classList.contains("selectedQuality")&&e.classList.remove("selectedQuality");document.getElementById(t).classList.add("selectedQuality"),document.getElementById("qualitySelect").classList.add("hiddenSelectionDiv")}});const C=document.getElementById("resList");C&&(C.onclick=function(e){if("LI"===e.target.tagName){const n=e.target.id;_=!1;var t=document.getElementById("player")||document.getElementById("videoElementParent");switch(n){case"144":v(256,144);break;case"240":v(426,240);break;case"360":v(640,360);break;case"480":v(854,480);break;case"720":v(1280,720);break;case"1080":v(1920,1080);break;case"auto":_=!0,v(t.clientWidth,t.clientHeight)}const o=document.querySelectorAll("#resList li");for(let e of o)e.classList.contains("selectedQuality")&&e.classList.remove("selectedQuality");document.getElementById(n).classList.add("selectedQuality"),document.getElementById("resSelect").classList.add("hiddenSelectionDiv")}});let T=document.getElementById("info4injectCopyBtn");null!==T&&T.addEventListener("click",(function(e){let t=document.getElementById("Info4injectStreamFromEditor");t.select(),navigator.clipboard.writeText(t.value).then((()=>{e3ds_alert("Copied Successfully!",{color:"blue"})})).catch((()=>{}))}));let B=document.getElementById("prioritise-quality-tgl"),x=document.getElementById("quality-params-submit");null!==B&&(B.onchange=function(e){if(B.checked){let e={PrioritiseQuality:1,LowBitrate:document.getElementById("low-bitrate-text").value,HighBitrate:document.getElementById("high-bitrate-text").value,MinFPS:document.getElementById("min-fps-text").value};h(e),console.log(e),x.onclick=function(e){let t={PrioritiseQuality:1,LowBitrate:document.getElementById("low-bitrate-text").value,HighBitrate:document.getElementById("high-bitrate-text").value,MinFPS:document.getElementById("min-fps-text").value};h(t),console.log(t)}}else{let e={PrioritiseQuality:0};h(e),console.log(e),x.onclick=null}});let A=document.getElementById("show-fps-button");null!==A&&(A.onclick=function(e){let t={Console:"stat fps"};b(t),"function"==typeof window.pixelStreaming.emitUIInteraction&&window?.pixelStreaming?.emitUIInteraction(t)});let O=document.getElementById("btn-Toggle-voipSpeaker-list");null!==O&&(O.onclick=function(e){"none"!=document.getElementById("roster").style.display?(document.getElementById("roster").style.display="none",O.src="assets/images/voipListNO.png"):(document.getElementById("flow-meeting").style.display="block",document.getElementById("roster").style.display="block",O.src="assets/images/voipListYes.png")});let M=document.getElementById("match-viewport-res-tgl");null!==M&&(M.onchange=function(e){M.checked,M.checked&&"function"==typeof window?.pixelStreamin?.config?.setFlagEnabled&&window.pixelStreaming.config.setFlagEnabled("MatchViewportRes",!0)});let D=document.getElementById("show-stats-tgl");null!==D&&(D.onchange=function(e){document.getElementById("statsContainer").style.display=e.target.checked?"block":"none"});var R=document.getElementById("kickAllGuests");R&&(R.onclick=function(e){console.log("-> SS: kickAllGuests"),xn.send(JSON.stringify({type:"kickAllGuests"}))});var U=document.getElementById("KickSelctedGuest");U&&(U.onclick=function(e){console.log("-> SS: KickSelctedGuest");var t=document.getElementById("Guest-filter"),n=t.options[t.selectedIndex].value;t.options[t.selectedIndex].text,xn.send(JSON.stringify({type:"KickSelctedGuest",playerIDToKick:n}))});var $=document.getElementById("DisableControlFromOthers");$&&($.onclick=function(e){console.log("-> SS: DisableControlFromOthers"),xn.send(JSON.stringify({type:"DisableControlFromOthers"}))});var J=document.getElementById("GiveControlToThisGuest");J&&(J.onclick=function(e){console.log("-> SS: GiveControlToThisGuest");var t=document.getElementById("Guest-filter"),n=t.options[t.selectedIndex].value;t.options[t.selectedIndex].text,xn.send(JSON.stringify({type:"GiveControlToThisGuest",GiveControlToThisGuestID:n}))});let q=document.getElementById("BandwidthCap_params_submit");q&&(q.onclick=function(e){Do(document.getElementById("BandwidthCap_text").value)});let W=document.getElementById("FramerateCap_params_submit");W&&(W.onclick=function(e){Ro(document.getElementById("FramerateCap_text").value)});let V=document.getElementById("editor-sidebar-closeBtn");V&&V.addEventListener("click",io);let G=document.getElementById("sendEditorUpdateToApp");G&&G.addEventListener("click",ro);let j=document.getElementById("saveEditorUpdate");j&&j.addEventListener("click",ao);const H=document.getElementById("restartWebRtcButton");H&&H.addEventListener("click",(function(){"function"==typeof restartWebRtc&&(step=1,restartWebRtc()),"function"==typeof window?.pixelStreaming?.reconnect&&window.pixelStreaming.reconnect()}));let z=document.getElementById("ApplyBtn4setFramerateCap");z&&(z.onclick=function(e){Ro(document.getElementById("setFramerateCap").value)});var Q=document.getElementById("settings-button");Q&&(Q.onclick=function(e){if(console.log("-> SS: settingsButton"),1!=rn("isE3DSEngineApp"))return console.warn("Engine version below 4.26. so skipping settingsButton VideoEncoderQP -> : "+L),void Nt("Engine version below 4.26. so skipping settingsButton VideoEncoderQP -> : "+L+(Math.random()*(.12-.02)+.02).toFixed(4),{timeout:2e3,color:"blue"});!function(){let e=document.getElementById("minBitrate").value,t=document.getElementById("maxBitrate").value,n=document.getElementById("resolution").value,o=(document.getElementById("minQP").value,document.getElementById("rateCtrl").value),i=(document.getElementById("minFPS").value,document.getElementById("backbuffersize").value,document.getElementById("quality").value);var r=JSON.stringify({type:"settings",data:{quality:i,minBitrate:e,maxBitrate:t,resolution:n,rateCtrl:o}});console.log("settingsButton--\x3e "+r),xn.send(r)}()});var X=document.getElementById("ApplyMaxSettingsBtn");X&&(X.onclick=function(e){if(console.log("-> SS: ApplyMaxSettingsBtn"),1!=rn("isE3DSEngineApp"))return console.warn("Engine version below 4.26. so skipping settingsButton VideoEncoderQP -> : "+L),void Nt("Engine version below 4.26. so skipping settingsButton VideoEncoderQP -> : "+L,{timeout:2e3,color:"blue"});var t=JSON.stringify({type:"settings",data:{minBitrate:2e7,maxBitrate:5e7,resolution:"1920x1080",minQP:1,rateCtrl:"CBR",minFPS:60,backbuffersize:1}});console.log("ApplyMaxSettingsBtn -> SS: "+t),xn.send(t)});var K=document.getElementById("ApplyMidSettingsBtn");K&&(K.onclick=function(e){if(console.log("-> SS: ApplyMidSettingsBtn"),1!=rn("isE3DSEngineApp"))return console.error("Engine version below 4.26. so skipping ApplyMidSettingsBtn VideoEncoderQP -> : "+L),void Nt("Engine version below 4.26. so skipping ApplyMidSettingsBtn VideoEncoderQP -> : "+L);var t=JSON.stringify({type:"settings",data:{minBitrate:1e7,maxBitrate:25e6,resolution:"1280x720",minQP:30,rateCtrl:"VBR",minFPS:60,backbuffersize:1}});console.log("ApplyMidSettingsBtn -> SS: "+t),xn.send(t)});var Y=document.getElementById("ApplyMinSettingsBtn");Y&&(Y.onclick=function(e){if(console.log("-> SS: ApplyMinSettingsBtn"),1!=rn("isE3DSEngineApp"))return console.warn("Engine version below 4.26. so skipping settingsButton VideoEncoderQP -> : "+L),void Nt("Engine version below 4.26. so skipping settingsButton VideoEncoderQP -> : "+L,{timeout:2e3,color:"blue"});var t=JSON.stringify({type:"settings",data:{minBitrate:4e6,maxBitrate:2e7,resolution:"800x640",minQP:50,rateCtrl:"VBR",minFPS:60,backbuffersize:1}});console.log("ApplyMinSettingsBtn -> SS: "+t),xn.send(t)});let Z=document.getElementById("ApplyBtn4setBandwidthCap");Z&&(Z.onclick=function(e){Do(document.getElementById("setBandwidthCap").value)});let ee=document.getElementById("ApplyBtn4Resulation");ee&&(ee.onclick=function(e){v(document.getElementById("ResulationX").value,document.getElementById("ResulationY").value)});let te=document.getElementById("ApplyBtn4Resulation_r");if(te&&(te.onclick=function(e){!function(e,t){let n={Console:"r.setres "+document.getElementById("ResulationX_r").value+"x"+document.getElementById("ResulationY_r").value+"w"};"function"==typeof window?.pixelStreaming?.emitUIInteraction?window.pixelStreaming.emitUIInteraction(n):b(n),1==Le&&console.log(n)}()}),muteaudio=document.getElementById("muteaudio"),null!==muteaudio&&(muteaudio.onchange=function(e){Pn&&xn.send(JSON.stringify({type:"settings",mute:muteaudio.checked}))}),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){let e=document.getElementById("fullscreen-img");e&&(e.style.display="none")}let ne=document.getElementById("fullscreen-img");ne&&(ne.onclick=function(){Uo()});let oe=document.getElementById("screenshot-img");oe&&(oe.onclick=function(){Wo(),oe.blur()});let ie=document.getElementById("forcePsVrModeBtn");ie&&(ie.onclick=function(){_webXrController.xrClicked()});let re=document.getElementById("LatencyTestBtn");re&&(re.onclick=function(){"function"==typeof window?.pixelStreaming?._webRtcController?.sendLatencyTest&&window.pixelStreaming._webRtcController.sendLatencyTest(),Pn&&Pn.startLatencyTest((function(e){let t={StartTime:e};S(w.LatencyTest,t)}))}),qo("button_720p",1280,720),qo("button_1080p",1920,1080),qo("button_1440p",2560,1440),qo("button_4K",3840,2160),qo("button_8K",7680,4320);let ae=document.getElementById("match-viewport-res-tgl");null!==ae&&ae.checked;let se=document.getElementById("ApplyBtn4setHighBitrate");se&&(se.onclick=function(e){let t=document.getElementById("setHighBitrate").value;capBpsCmd="Encoder.HighBitrate "+t;let n={Console:capBpsCmd};b(n),console.log(n)});let le=document.getElementById("ApplyBtn4setMaxBitrate");le&&(le.onclick=function(e){let t=document.getElementById("setMaxBitrate").value;capBpsCmd="Encoder.MaxBitrate "+t;let n={Console:capBpsCmd};b(n),console.log(n)});let ce=document.getElementById("Volumebar");ce&&(ce.onchange=function(e){l(this.value)});let de=document.getElementById("resoulbar");de&&(de.onchange=function(e){Vo(this.value),f(this.value)});let ue=document.getElementById("ApplyBtn4setUseBackBufferSize");ue&&(ue.onclick=function(e){let t=document.getElementById("setUseBackBufferSize").value;capBpsCmd="Encoder.UseBackBufferSize "+t;let n={Console:capBpsCmd};b(n),console.log(n)});let ge=document.getElementById("ApplyBtn4setPrioritiseQuality");ge&&(ge.onclick=function(e){let t=document.getElementById("setPrioritiseQuality").value;capBpsCmd="Encoder.PrioritiseQuality "+t;let n={Console:capBpsCmd};b(n),console.log(n)});let pe=document.getElementById("ApplyBtn4setMinFPS");pe&&(pe.onclick=function(e){let t=document.getElementById("setMinFPS").value;capBpsCmd="Encoder.MinFPS "+t;let n={Console:capBpsCmd};b(n),console.log(n)});let fe=document.getElementById("ApplyBtn4setMinQP");fe&&(fe.onclick=function(e){let t=document.getElementById("setMinQP").value;capBpsCmd="Encoder.MinQP "+t;let n={Console:capBpsCmd};b(n),console.log(n)});let ye=document.getElementById("ApplyBtn4setLowBitrate");ye&&(ye.onclick=function(e){let t=document.getElementById("setLowBitrate").value;capBpsCmd="Encoder.LowBitrate "+t;let n={Console:capBpsCmd};b(n),console.log(n)});let ve=document.getElementById("ApplyBtn4TargetSize");ve&&(ve.onclick=function(e){let t=document.getElementById("TargetSizeX").value,n=document.getElementById("TargetSizeY").value;capBpsCmd="Encoder.TargetSize "+t+"x"+n;let o={Console:capBpsCmd};b(o),console.log(o)});let we=document.getElementById("ApplyBtn4setRateControl");we&&(we.onclick=function(e){var t=document.getElementById("RateControlMethod"),n=t.options[t.selectedIndex].value;t.options[t.selectedIndex].text,capBpsCmd="Encoder.RateControl "+n;let o={Console:capBpsCmd};b(o),console.log(o)});let Se=document.getElementById("encoder-params-submit");null!==Se&&(Se.onclick=function(e){for(var t=Gt.versionString.split("."),n=[],o=0;o<t.length;o++){var i=parseInt(t[o],10);isNaN(i)||n.push(i)}console.log(n),n[0];let r=document.getElementById("encoder-min-qp-text").value,a=document.getElementById("encoder-max-qp-text").value;I({ConsoleCommand:"PixelStreaming.Encoder.MinQP "+r}),I({ConsoleCommand:"PixelStreaming.Encoder.MaxQP "+a}),"function"==typeof window?.pixelStreaming?.emitCommand&&(window.pixelStreaming.emitCommand({ConsoleCommand:"PixelStreaming.Encoder.MinQP "+r}),window.pixelStreaming.emitCommand({ConsoleCommand:"PixelStreaming.Encoder.MaxQP "+a}))});let be=document.getElementById("UserInput");be&&(be.addEventListener("touchstart",(e=>{e.preventDefault(),be.focus(),setTimeout((()=>{be.setSelectionRange(be.value.length,be.value.length)}),0)})),be.oninput=function(e){setTimeout((()=>{if(be.setSelectionRange(be.value.length,be.value.length),he)return;let t=e.data,n=t[t.length-1].toUpperCase(),o=n.charCodeAt(0);const i=new KeyboardEvent("keydown",{key:n,keyCode:o,which:o,code:`Key${n}`});P(new Uint8Array([w.KeyDown,a(i),i.repeat]).buffer);const r=new KeyboardEvent("keypress",{key:n,keyCode:o,charCode:n.toLowerCase().charCodeAt(0),which:n.charCodeAt(0),code:`Key${n}`});let s=new DataView(new ArrayBuffer(3));s.setUint8(0,w.KeyPress),s.setUint16(1,r.charCode,!0),P(s.buffer);const l=new KeyboardEvent("keyup",{key:n,keyCode:o,charCode:n.toLowerCase().charCodeAt(0),which:n.charCodeAt(0),code:`Key${n}`});P(new Uint8Array([w.KeyUp,a(l)]).buffer),he=!0}),0)});let Ie=document.getElementById("webrtc-params-submit");null!==Ie&&(Ie.onclick=function(e){_=!1,v(document.getElementById("webrtc-low-qp-text").value,document.getElementById("webrtc-high-qp-text").value)}),"function"==typeof onHtmlBind?onHtmlBind():console.log("not found onHtmlBind"),e3ds_controller.callbacks&&"function"==typeof e3ds_controller.callbacks.onHtmlBind&&e3ds_controller.callbacks.onHtmlBind()}(),null!=It.passwordToStart&&"undefined"!=It.passwordToStart&&""!=It.passwordToStart?(console.log("streamingVideo: ",document.getElementById("streamingVideo")?.style?.display),console.log("videoPlayOverlay: ",document.getElementById("videoPlayOverlay")?.style?.display),document.getElementById("videoPlayOverlay").style.display="none",document.getElementById("streamingVideo")&&(document.getElementById("streamingVideo").style.display="none"),(i=document.getElementById("popupForPasswordToStart"))&&(i.style.display="flex"),r=60,passwordTimer=setInterval((function(){const e=document.getElementById("passwordCountDown");e&&(e.innerText=`(${r})`),r<=0&&(clearInterval(passwordTimer),Qn()?Hi("You did not enter the correct password. Please refresh the page."):Qn()||Hi("You did not enter the correct password. To start a new session please visit: "+location.href)),r--}),1e3)):((i=document.getElementById("popupForPasswordToStart"))&&(i.style.display="none"),null==Yt?Ki():null!=Yt&&er()),console.log("configurationObj for v5/v4/v6: "+JSON.stringify(It,null,"\t"))}}function Ki(){(function(){if(console.log("videoToPlay: "+_t),_t.length>0){var e=document.getElementById("streamingVideo");if(e){Nt("Click in the video to enable audio",{color:"blue",timeout:1e4}),e.addEventListener("ended",(e=>{console.log("Video stopped either because 1) it was over, or 2) no further data is available."),function(){if(1==rn("DoRandomSuffleInLoadingVideoAssets")){var e=Wi(0,_t.length);Vi(Gi=e)}else++Gi==_t.length?Vi(Gi=0):Vi(Gi)}()})),Vi(0);var t=document.getElementById("settings");t&&(1==It.shouldDisplayContorlBar||null==It.shouldDisplayContorlBar?t.style.display="flex":t.style.display="none")}else{const e=document.createElement("video");e.playsInline=!0,e.autoplay=!0,e.id="loadingVideoElement",e.style.zIndex=40,e.style.background="black",document.getElementById("playerUI").appendChild(e),Nt("Click in the video to enable audio",{color:"blue",timeout:1e4}),e.onclick=function(){Ut(e,!1)},e.addEventListener("ended",(e=>{console.log("Video stopped either because 1) it was over, or 2) no further data is available."),function(){if(1==rn("DoRandomSuffleInLoadingVideoAssets")){var e=Wi(0,_t.length);ji(Gi=e)}else++Gi==_t.length?ji(Gi=0):ji(Gi)}()})),ji(0)}}})(),function(){Fi=!0,m({type:"stage1_inqueued"});var e=void 0;null!=It?((e={}).type="takeIdentity",e.clientType="player",e.configName=en,e.configurationObj=It,e.serverOwner=It.owner,e.appName=It.appName,e.userAgent=navigator.userAgent,e.GuestMeetingId=Yt,e.url=window.location.href,e.href_emulated=window.location.href_emulated,e.userDeviceInfo=_n,e.clientInfo=dn,e.version_fe_lib=Pt):e={type:"takeIdentity",clientType:"player",configurationObj:It,userAgent:navigator.userAgent,serverOwner:window.location.pathname.substring(1),isIniFrame:Qn(),url:window.location.href,href_emulated:Ue,appName:rn("appName"),userDeviceInfo:_n,clientInfo:dn},console.log("77777 ws4queue.send(): "+JSON.stringify(e)),me.send(JSON.stringify(e))}()}function Yi(){"use strict";if(qt){if(!pn)if(document.getElementById("InQueue_Text")&&Zi("Requesting Available Slot",""),window.WebSocket=window.WebSocket||window.MozWebSocket,window.WebSocket){var e,t=Ue.replace("http://","ws://").replace("https://","wss://");ge("queue_WebSocketConnectionCalledAt",fe()),(me=new WebSocket(t)).onerror=function(e){console.error(`ws4queue error: ${JSON.stringify(e)}`)},me.onclose=function(t){clearInterval(e),console.warn(`ws4queue closed: ${JSON.stringify(t.code)} - ${t.reason}`),"kicked"!=t.reason?4e3!=t.code&&gn&&!$t&&(Ni+=1,console.log("ws4queueReconnec() reconnectAttempt:"+Ni),me=void 0,Qi=!1,setTimeout(Yi(),4e3)):window.location="/assets/pages/kickedOut.htm"},me.onopen=function(t){var n;ge("queue_WebSocketConnectionEstablishedAt",fe()),e=setInterval((function(){me.readyState==WebSocket.CONNECTING||me.readyState==WebSocket.CLOSING||me.readyState==WebSocket.CLOSED||me.send(JSON.stringify({type:"pingQueue"}))}),1e3),"v5"==Ot||"v6"==Ot?null!=It?Xi():null==It&&null==Yt&&(n=JSON.stringify({type:"getAppCOnfig",GuestMeetingId:Yt,appName:Zt,owner:Fe,uInfo:$e,configName:en,version:dt,configurationObj:It,urlVersion:Ot}),console.log(" ws.send(): "+n),Ft(n,me)):Xi()},me.onmessage=function(e){var t=JSON.parse(e.data);if("disconnectAndretryIn"===t.type){const e=document.getElementById("videoPlayOverlay");e&&(e.style.display="flex");var n=document.getElementById("InQueue_Text");n&&(n.innerHTML="CCU Limit Reached. Trying Again in 10 sec"),pn=!1,gn=!1,me.close(4e3,"disconnectAndretryIn"),clearInterval(Ui),Ui=setInterval((function(){window.location.reload()}),1e4)}else"ShowThisHtmlPage"===t.type?(pn=!0,me.close(4e3,"ShowThisHtmlPage"),self.location=t.htmlPage):"AppCOnfig"===t.type||"CallOnGettingAppCOnfig"===t.type?Xi(t):"TakePassVerificationResult"===t.type?1==t.isMatched?(clearInterval(passwordTimer),document.getElementById("popupForPasswordToStart").style.display="none",document.getElementById("videoPlayOverlay").style.display="flex",document.getElementById("streamingVideo")&&(document.getElementById("streamingVideo").style.display="block"),document.getElementById("popupForVoipUsername")&&!Yt&&1==sn&&(document.getElementById("popupForVoipUsername").style.display="flex",document.getElementById("voipUserName").select()),at=new Date,null!=Yt&&er(),Ki()):0==t.isMatched&&(document.getElementById("alert__box").style.top="50px",document.getElementById("alert__close").addEventListener("click",(e=>{e.preventDefault(),(document.getElementById("alert__box").style.top="50px")&&(document.getElementById("alert__box").style.top="-50%")}))):"TakeuserDeviceInfo"===t.type?("Oculus Browser"==(_n=t.userDeviceInfo).client.name&&(_n.device.type="hmd"),yn=t.matchmakerInfo,qe=null!=yn.skipReporting&&yn.skipReporting,async function(){var e=new XMLHttpRequest;e.withCredentials=!0,e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE&&200===e.status){var t=JSON.parse(e.responseText);"Signed"===t?.message?(Je=t.data,console.log("loggedInUserData: "+JSON.stringify(Je))):"Unsigned"===t?.message&&console.warn("not signed in:",e.statusText),1==We&&(window.location.href=o)}};const t=new URL(window.location.href).hostname.split(".").slice(-2).join(".");console.log(t);var n=void 0,o=void 0;t==yn.topLevelDomainName?(n="https://auth-restful."+yn.topLevelDomainName+"/api/v2/session/jwt",o="https://auth-fe."+yn.topLevelDomainName+"/signin?redirect="+window.location.href):"eaglepixelstreaming.com"==t?(n="https://auth-restful.eaglepixelstreaming.com/api/v2/session/jwt",o="https://asif-account.eaglepixelstreaming.com/signin?redirect="+window.location.href):"eagle3dstreaming.com"==t&&(n="https://auth-restful.eagle3dstreaming.com/api/v2/session/jwt",o="https://auth-fe.eagle3dstreaming.com/signin?redirect="+window.location.href),console.log("e3dsAuthUrl:"+n),console.log("e3dsLoginUrl:"+o),e.open("GET",n),e.onerror=function(){console.log("collectLoginInfo()  xmlHttp.onerror network errors .")};try{e.send()}catch(e){console.error(e)}}(),console.log(`userDeviceInfo : ${JSON.stringify(_n)}`),console.log(" 1111111111111 useExtendedTyping > "+an)):"doApprequest"===t.type?er():"uInfo"===t.type?$e=t.uInfo:"ConnectPlayerTo"===t.type?(ge("connectPlayerToReceivedAt",fe()),function(e){Ne=e.cirrusServer;const t=e.cirrusServer.elInfo;Te=e?.cirrusServer?.elInfo,Se&&m({type:"streamerName",value:Te.computerName}),Ri=t,$t=!0,lt=e.appDownloadInfo,(ct=e.streamTestResult)&&(ct.timeAppTookToStream&&(it=Math.ceil(60*ct.timeAppTookToStream)),1==ct.successfulStream||0==ct.successfulStream&&0==ct.ue4ExeInfo.PsPluginPixelStreamingDireExist&&0==ct.ue4ExeInfo.PsPluginEntryInManifestFile&&Nt("Our record indicates Your this app verison dont have pixel streaming plugin enabled.So it cant stream  ",{color:"Red"})),m({type:"stage2_deQueued"}),console.log("222222 <- SS_Queue: msg: "+JSON.stringify(e)),Fi=!1,qt=!1,me&&me.close(4e3,"preConnectssTasks"),console.log("extractValueFromUrl('videoToPlay') :"+_t),_t.length<=0&&Mi(1);var n="wss://"+Ne.domain+"/ws/"+Ne.httpsPort+"/";window.ss_url=n,window.fsgsg?window.fsgsg():le(Ne)}(t)):"redirectTo11"===t.type?(m({type:"stage2_deQueued"}),console.log("222222 <- SS_Queue: msg.data.url: "+t.url),console.log("222222 <- SS_Queue: msg: "+JSON.stringify(t)),le(t.cirrusServer)):"UpdatePlayerWatingRank"===t.type?(null==pe.firstQueueNumberReceivedAt&&ge("firstQueueNumberReceivedAt",fe()),console.log("1111111111111111111111 <- SS_Queue: UpdatePlayerWatingRank: "+t.Postion),_t.length<=0&&Zi("In Queue",t.Postion)):"ShowAnimatedInfo"===t.type?si(t.data.info):"showTextOverlay"===t.type?(console.log("showTextOverlay: "+t.data.info),Nt(t.data.info,{color:"blue"})):"printInConsoleOnly"===t.type?console.log("printInConsoleOnly: "+t.data.info):"ShowInfoInLines"===t.type?(Nt(t.data.info,{color:"blue"}),console.log("ShowInfoInLines: "+t.data.info)):"ShowE3ds_alert"===t.type&&(Nt(t.data.info,{color:"blue"}),console.log("ShowE3ds_alert: "+t.data.info))}}else alert("Your browser doesn't support WebSocket")}else console.log("onTrailCheckPassed() returninig bcz shouldTryToReconnectQueue: "+qt)}function Zi(e,t,n){var o=document.getElementById("queueNumberText"),i="";""!==n&&void 0!==n&&(i=i+'<nav > <a data-label="global-footer" href='+n+">upload</a> </nav>");var r=document.getElementById("InQueue_Text");r&&e&&(r.innerHTML=e),o&&(o.innerHTML=t),m({type:"QueueNumberUpdated",queuePosition:t})}function Z(){if(ee){if(fn)document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),fn=!1;else{let e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),screen.orientation.lock("landscape"),fn=!0}clearInterval(Nn),clearTimeout(Fn),ee=!1}}function er(){if(me&&me.readyState===Mn){if(null==dn)return console.log("trying to doApprequest but clientInfo undefined"),void ir();console.log("doing doApprequest");var e=void 0,t="appRequest";null!=Yt&&(t="RequestToJoinMeeting"),null!=It?e={type:t,clientInfo:dn,href_emulated:Ue,href:window.location.href,configName:en,urlVersion:Ot,GuestMeetingId:Yt,accessedTopLevelDomainName:Lt,url_searchParams:String(ye),configurationStr:At[2],userDeviceInfo:_n,version:dt,uInfo:$e,configurationObj:It,configuration:It,expireOn:It.expireOn,MouseControlScheme:It.MouseControlScheme,showWebrtcCtrlMenu:It.showWebrtcCtrlMenu,showPsControl:It.showPsControl,afkWarnTimeout:It.afkWarnTimeout,afkCloseTimeout:It.afkCloseTimeout,isAfkEnabled:It.isAfkEnabled,enableScreenshot:It.enableScreenshot,useExtendedTyping:It.useExtendedTyping,showbrowserMouse:It.showbrowserMouse,isAdminDebugging:It.isAdminDebugging,appName:It.appName,owner:Fe,cmdLineArgs:It.exeLunchArgs,exeLunchArgs:It.exeLunchArgs,hostMeetingId:It.hostMeetingId,GuestMeetingId:Yt,maxUserLimit:It.maxUserLimit,custom_html:It.custom_html}:(Ue.replace(location.origin+"/","").replace(location.search,""),e={type:"appRequest",appName:rn("appName"),owner:Fe,configName:en,clientInfo:dn,cmdLineArgs:rn("cmdLineArgs"),hostMeetingId:rn("hostMeetingId"),GuestMeetingId:Yt,custom_html:rn("custom_html"),onDemand:rn("onDemand"),onDemandRegion:rn("onDemandRegion"),maxUserLimit:rn("maxUserLimit"),accessedTopLevelDomainName:Lt,url_searchParams:String(ye)});var n=JSON.stringify(e);console.log("--------------- ws4queue.send Json: "+n),me.send(n)}else console.log("ws4queue not ready")}function B(e){if(null==dn||"undefined"==dn){var t=JSON.parse(e);Xe=t.ip_address,nr(t)}}function tr(e){return Math.floor(Math.random()*e)}function nr(e){null==e.latitude&&(e.latitude="38.88",console.warn("latitude undefined .so setting latitude : "+e.latitude)),null==e.longitude&&(e.longitude="-120.88",console.warn("longitude undefined .so setting longitude : "+e.longitude)),dn={ip:e.ip,city:e.city,region:e.region_name,country_name:e.country,latitude:e.latitude,longitude:e.longitude,fullInfo:e},zi(),dn.latitude,dn.longitude,JSON.stringify({type:"xirsysResponse",responseText:JSON.stringify({})}),e.city,tr(3333),qi(),me&&me.readyState===Mn&&er()}function or(){nr({ip:"ahsanHackOnUnabletoGetIpInfo",city:"ahsanHackOnUnabletoGetIpInfo",region:"ahsanHackOnUnabletoGetIpInfo",country_name:"ahsanHackOnUnabletoGetIpInfo",latitude:void 0,longitude:void 0})}function ir(e=0){if(void 0!==dn)return;const t=new XMLHttpRequest;t.onreadystatechange=function(){return 422===t.status?(console.log("collectLocationInfo() received 422 status code. Returning default clientInfo object."),void or()):429===t.status?(console.log("collectLocationInfo() received 429 status code. Retrying after 2000ms."),null!=T&&clearTimeout(T),void(T=setTimeout(ir,2e3,e))):void(""!==t.responseText&&void 0!==t.responseText&&200===t.status?(clearTimeout(T),B(t.responseText)):e<20?(console.log("CLI() retrying after 2000ms."),null!=T&&clearTimeout(T),T=setTimeout(ir,2e3,e+1)):(console.log("collectLocationInfo() maximum retries exceeded."),or()))},t.onerror=function(){console.log("collectLocationInfo()  xmlHttp.onerror ."),or()},t.open("GET","https://ipgeolocation.abstractapi.com/v1/?api_key=667cb95019b04ea5beaa7c935dc5ce37",!0),t.send(null)}ee=!1,Number.prototype.clamp=function(e,t){return Math.min(Math.max(this,e),t)},T=void 0,C=0,ir(),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector(".slider-toggler"),t=document.querySelector(".slider-content"),n=document.querySelector(".toggle-img-collapsed"),o=document.querySelector(".toggle-img-expanded");e&&(e.addEventListener("click",(function(){"0px"===t.style.width||""===t.style.width?t.style.width="auto":t.style.width="0px",n.style.display="none"===n.style.display?"block":"none",o.style.display="none"===o.style.display?"block":"none"})),e.click())}));const rr=()=>{e3ds_controller,e3ds_controller.main()};window.onload111=function(){if(window.addEventListener("touchend",Y),window.addEventListener("mouseup",Y),"undefined"!=typeof e3ds_controller)rr();else{console.error("e3ds_controller not found");let e=setInterval((()=>{"undefined"!=typeof e3ds_controller?(clearInterval(e),rr()):console.error("e3ds_controller not found")}),100)}},window.onload=async function(){if(ge("windowOnloadExecutedAt",fe()),window.addEventListener("touchend",Y),window.addEventListener("mouseup",Y),"undefined"!=typeof e3ds_controller)rr();else{console.error("e3ds_controller not found");let e=setInterval((()=>{"undefined"!=typeof e3ds_controller?(clearInterval(e),rr()):console.error("e3ds_controller not found")}),100)}}})();